{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///(webpack)/buildin/global.js","webpack:///(webpack)/buildin/harmony-module.js","webpack:///./src/browser-main.ts","webpack:///./src/game/2d/options.ts","webpack:///./src/game/2d/periscreen.ts","webpack:///./src/game/2d/splash.ts","webpack:///./src/game/camera/cameraBase.ts","webpack:///./src/game/camera/observer.ts","webpack:///./src/game/camera/periscope.ts","webpack:///./src/game/engine3d.ts","webpack:///./src/game/game.ts","webpack:///./src/game/mission.ts","webpack:///./src/game/render.ts","webpack:///./src/game/vessel/component.ts","webpack:///./src/game/vessel/explode.ts","webpack:///./src/game/vessel/foam.ts","webpack:///./src/game/vessel/smoke.ts","webpack:///./src/game/vessel/submarine.ts","webpack:///./src/game/vessel/torpedo.ts","webpack:///./src/game/vessel/vessel.ts","webpack:///./src/gl/buffer.ts","webpack:///./src/gl/communicator.ts","webpack:///./src/gl/material.ts","webpack:///./src/gl/mesh.ts","webpack:///./src/gl/model.ts","webpack:///./src/gl/offscreen.ts","webpack:///./src/gl/shader.ts","webpack:///./src/gl/texture.ts","webpack:///./src/gl/transformFeedback.ts","webpack:///./src/gl/vertexAttrs.ts","webpack:///./src/gl/viewport.ts","webpack:///./src/object/object.ts","webpack:///./src/object/ocean.ts","webpack:///./src/object/skybox.ts","webpack:///./src/object/terrain.ts","webpack:///./src/renderer/events.ts","webpack:///./src/renderer/renderer.ts","webpack:///./src/techniques/FFTWave.ts","webpack:///./src/techniques/ambientCube.ts","webpack:///./src/techniques/decodeImage.ts","webpack:///./src/techniques/deferImage.ts","webpack:///./src/techniques/gaussBlur.ts","webpack:///./src/techniques/gaussian.ts","webpack:///./src/techniques/normal.ts","webpack:///./src/techniques/perlinWave.ts","webpack:///./src/techniques/phillips.ts","webpack:///./src/techniques/postProcess.ts","webpack:///./src/techniques/rect.ts","webpack:///./src/techniques/uv.ts","webpack:///./src/util/assets.ts","webpack:///./src/util/async.ts","webpack:///./src/util/glm.js","webpack:///./src/util/ulist.ts","webpack:///./src/util/xhr.ts"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/browser-main.ts\");\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || Function(\"return this\")() || (1, eval)(\"this\");\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","module.exports = function(originalModule) {\n\tif (!originalModule.webpackPolyfill) {\n\t\tvar module = Object.create(originalModule);\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"exports\", {\n\t\t\tenumerable: true\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","import { Game } from \"./game/game\";\r\n\r\nnew Game().start();","import { PostProcess } from \"../../techniques/postProcess\";\r\nimport { Texture2D } from \"../../gl/texture\";\r\nimport { gl } from \"../../renderer/renderer\";\r\nimport { Shader } from \"../../gl/shader\";\r\n\r\nclass Options extends PostProcess {\r\n\tpublic readonly bg: Texture2D = new Texture2D({ component: gl.RGB });\r\n\r\n\tconstructor() {\r\n\t\tsuper(Shader.create(\"options\", false));\r\n\t}\r\n\r\n\tbeforeRender() {\r\n\t\tthis.bg.use(\"Image\");\r\n\t}\r\n\tafterRender() {\r\n\t\tthis.bg.unuse();\r\n\t}\r\n}\r\n\r\nexport {\r\n\tOptions\r\n}\r\n","import { glm } from \"../../util/glm\"\r\nimport { Shader } from \"../../gl/shader\";\r\nimport { Rect } from \"../../techniques/rect\";\r\nimport { gl, Renderer } from \"../../renderer/renderer\";\r\nimport { Texture2D } from \"../../gl/texture\";\r\nimport { Submarine } from \"../vessel/submarine\";\r\n\r\nclass PeriScreen {\r\n\tprivate rects: Rect[] = [];\r\n\tprivate main: Rect;\r\n\tprivate launchers: Rect[] = [];\r\n\tprivate knobs: Rect[] = [];\r\n\tprivate knob: Rect;\r\n\tprivate indicator: Rect;\r\n\tprivate indicators: Rect[] = [];\r\n\r\n\tprivate bg = new Texture2D(\"./assets/periscope.png\");\r\n\r\n\tconstructor() {\r\n\t\tlet w = Renderer.instance.canvas.width;\r\n\t\tlet h = Renderer.instance.canvas.height;\r\n\t\tthis.rects.push(\r\n\t\t\tnew Rect({\r\n\t\t\t\tleft: 0, top: 0, width: w, height: h, \r\n\t\t\t\ttex: [0, 1, 1, 1, 1, 0.25, 0, 0.25]\r\n\t\t\t}), \r\n\r\n\t\t\tnew Rect({\r\n\t\t\t\tleft: 1090 + 14, top: 582 + 42, width: 60, height: 60,\r\n\t\t\t\ttex: [0.477, 0.182, 0.528, 0.182, 0.528, 0.131, 0.477, 0.131]\r\n\t\t\t}),\r\n\t\t\tnew Rect({\r\n\t\t\t\tleft: 1090 - 109 + 14, top: 582 + 42, width: 60, height: 60,\r\n\t\t\t\ttex: [0.477, 0.182 + 0.051, 0.528, 0.182 + 0.051, 0.528, 0.131 + 0.051, 0.477, 0.131 + 0.051]\r\n\t\t\t})\r\n\t\t);\r\n\t\tthis.main = new Rect({\r\n\t\t\tleft: 0, top: 0, width: w, height: h, \r\n\t\t\ttex: [0.15, 0.95, 1.15, 0.95, 1.15, -0.05, 0.15, -0.05]\r\n\t\t});\r\n\t\tthis.knobs = [\r\n\t\t\tnew Rect({\r\n\t\t\t\tleft: 858 + 14, top: 572 + 42, width: 80, height: 80,\r\n\t\t\t\ttex: [0.168, 0.103, 0.248, 0.103, 0.248, 0.033, 0.168, 0.033]\r\n\t\t\t}),\r\n\t\t\tnew Rect({\r\n\t\t\t\tleft: 858 + 14, top: 572 + 42, width: 80, height: 80,\r\n\t\t\t\ttex: [0.168 + 0.086, 0.103, 0.248 + 0.086, 0.103, 0.248 + 0.086, 0.033, 0.168 + 0.086, 0.033]\r\n\t\t\t}),\r\n\t\t\tnew Rect({\r\n\t\t\t\tleft: 858 + 14, top: 572 + 42, width: 80, height: 80,\r\n\t\t\t\ttex: [0.168 + 0.086 * 2, 0.103, 0.248 + 0.086 * 2, 0.103, 0.248 + 0.086 * 2, 0.033, 0.168 + 0.086 * 2, 0.033]\r\n\t\t\t}),\r\n\t\t];\r\n\t\tthis.periscopeState(2);\r\n\t}\r\n\r\n\tconfigureUboat(uboat: Submarine) {\r\n\t\tthis.launchers = [];\r\n\t\tlet iu = 0, iv = 0;\r\n\t\tfor (let i in uboat.torpedoLauncher) {\r\n\t\t\tlet dx = 0.04285 * +i;\r\n\t\t\tif (uboat.torpedoLauncher[i].orient[1] > 0) {\r\n\t\t\t\tthis.launchers.push(new Rect({\r\n\t\t\t\t\tleft: 976 + 14 + 49 * iu++, top: 420 + 42, width: 47, height: 47,\r\n\t\t\t\t\ttex: [0.168 + dx, 0.145, 0.21 + dx, 0.145, 0.21 + dx, 0.104, 0.168 + dx, 0.104]\r\n\t\t\t\t}));\r\n\t\t\t} else {\r\n\t\t\t\tthis.launchers.push(new Rect({\r\n\t\t\t\t\tleft: 976 + 14 + 49 * iv++, top: 420 + 47 + 26 + 42, width: 47, height: 47,\r\n\t\t\t\t\ttex: [0.168 + dx, 0.145, 0.21 + dx, 0.145, 0.21 + dx, 0.104, 0.168 + dx, 0.104]\r\n\t\t\t\t}));\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.indicator = new Rect({\r\n\t\t\tleft: 780 + 14, top: 500 + 42, width: 22, height: 32,\r\n\t\t\ttex: [0.459, 0.031, 0.48, 0.031, 0.48, 0, 0.459, 0]\r\n\t\t});\r\n\t}\r\n\r\n\tperiscopeState(state: number) {\r\n\t\tthis.knob = this.knobs[state];\r\n\t}\r\n\r\n\tindicatorState(state: number) {\r\n\t\tthis.indicator.displacement[\"+=\"](glm.vec2(0, state * 2 * (508 - 374) / Renderer.instance.canvas.height));\r\n\t}\r\n\r\n\trender(world: Texture2D) {\r\n\t\tgl.disable(gl.DEPTH_TEST);\r\n\t\tgl.clear(gl.COLOR_BUFFER_BIT);\r\n\t\tgl.enable(gl.BLEND);\r\n\t\tgl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\r\n\t\tgl.depthMask(false);\r\n\r\n\t\t\tworld.use(\"Texture\");\r\n\t\t\tRect.bindShader();\r\n\r\n\t\t\t\tthis.main.render();\r\n\r\n\t\t\tRect.unbindShader();\r\n\t\t\tworld.unuse();\r\n\r\n\t\t\tthis.bg.use(\"Texture\");\r\n\t\t\tRect.bindShader();\r\n\r\n\t\t\t\tfor (let i = 0; i != this.rects.length; ++i) {\r\n\t\t\t\t\tthis.rects[i].render();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (let x of this.launchers) {\r\n\t\t\t\t\tx.render();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.knob.render();\r\n\t\t\t\tthis.indicator.render();\r\n\r\n\t\t\tRect.unbindShader();\r\n\t\t\tthis.bg.unuse();\r\n\r\n\t\tgl.depthMask(true);\r\n\t\tgl.disable(gl.BLEND);\r\n\t}\r\n}\r\n\r\nexport {\r\n\tPeriScreen\r\n}","import { gl, Renderer } from \"../../renderer/renderer\";\r\nimport { PostProcess } from \"../../techniques/postProcess\";\r\nimport { Shader } from \"../../gl/shader\";\r\nimport { Texture2D } from \"../../gl/texture\";\r\n\r\nclass Splash extends PostProcess {\r\n\tprivate bg: Texture2D;\r\n\r\n\tconstructor(image: string) {\r\n\t\tsuper(Shader.create(\"splash\", false));\r\n\t\tthis.bg = new Texture2D(\"./assets/splash/\" + image);\r\n\t}\r\n\r\n\tbeforeRender() {\r\n\t\tgl.viewport(0, 0, Renderer.instance.canvas.width, \r\n\t\t\tRenderer.instance.canvas.height);\r\n\t\tthis.bg.use(\"Image\");\r\n\t}\r\n\tafterRender() {\r\n\t\tthis.bg.unuse();\r\n\t}\r\n}\r\n\r\nexport {\r\n\tSplash\r\n}\r\n","import { PerspectiveViewport } from \"../../gl/viewport\";\r\nimport { Vessel } from \"../vessel/vessel\";\r\nimport { glm } from \"../../util/glm\"\r\n\r\nabstract class CameraBase extends PerspectiveViewport {\r\n\tconstructor(left?: number, top?: number, width?: number, height?: number) {\r\n\t\tsuper(left, top, width, height);\r\n\t}\r\n\r\n\tabstract bind();\r\n\tabstract unbind();\r\n\r\n\tprotected carrier: Vessel = null;\r\n\r\n\ttie(carrier: Vessel) {\r\n\t\tif (this.carrier) {\r\n\t\t\tthis.carrier.tie(null);\r\n\t\t}\r\n\t\tthis.carrier = carrier;\r\n\t\tif (carrier) {\r\n\t\t\tthis.locate(carrier.position);\r\n\t\t\tcarrier.tie(this);\r\n\t\t}\r\n\t}\r\n\r\n\tabstract locate(pos: glm.vec3);\r\n}\r\n\r\nexport {\r\n\tCameraBase\r\n}\r\n","import { CameraBase } from \"./cameraBase\";\r\nimport { Renderer, RendererEvent } from \"../../renderer/renderer\";\r\nimport { glm } from \"../../util/glm\"\r\n\r\nfunction clamp(x: number, min: number, max: number): number {\r\n\treturn Math.max(min, Math.min(max, x));\r\n}\r\n\r\nclass Observer extends CameraBase {\r\n\tprivate threshord: number = 200;\r\n\r\n\tprivate oTrans: glm.mat4;\r\n\tprivate rTrans: glm.mat4;\r\n\tprivate qTrans: glm.mat4;\r\n\tprivate tTrans: glm.mat4;\r\n\tprivate mTrans: glm.mat4;\r\n\tprivate wTrans: glm.mat4;\r\n\tprivate pTrans: glm.mat4;\r\n\r\n\tprivate pos: glm.vec3;\r\n\r\n\tprivate rModified: boolean = true;\r\n\tprivate tModified: boolean = true;\r\n\r\n\tprivate R = glm.vec3(glm.radians(0), glm.radians(-15), glm.radians(0));\r\n\r\n\tprivate dist: number = 2;\r\n\tprivate minDist: number = 2 * 1;\r\n\tprivate maxDist: number = 2 * 2;\r\n\r\n\tprivate mousewheel: RendererEvent;\r\n\tprivate mousemove: RendererEvent;\r\n\tprivate mouseup: RendererEvent;\r\n\tprivate mousedown: RendererEvent;\r\n\r\n\tprivate prevx: number = 0;\r\n\tprivate prevy: number = 0;\r\n\tprivate isDragging: boolean = false;\r\n\r\n\tconstructor(left?: number, top?: number, width?: number, height?: number) {\r\n\t\tsuper(left, top, width, height);\r\n\t\tthis.N = glm.vec3(-1, 0, 0);\r\n\t\tthis.Up = glm.vec3(0, 0, 1);\r\n\t}\r\n\r\n\tgetCameraPosition(): glm.vec3 {\r\n\t\tif (this.rModified || this.tModified || this.translateModified) {\r\n\t\t\tthis.updatePTrans();\r\n\t\t}\r\n\t\treturn this.pos;\r\n\t}\r\n\tget target(): glm.vec3 {\r\n\t\treturn glm.vec3(0, 0, 0);\r\n\t}\r\n\tset target(value: glm.vec3) {\r\n\t}\r\n\tget up(): glm.vec3 {\r\n\t\treturn glm.vec3(0, 0, 0);\r\n\t}\r\n\tset up(value: glm.vec3) {\r\n\t}\r\n\tviewModified(): boolean {\r\n\t\treturn this.rModified || this.tModified || this.translateModified ||\r\n\t\t\tthis.rotateModified;\r\n\t}\r\n\tprivate updatePTrans() {\r\n\t\tif (this.rModified || this.tModified) {\r\n\t\t\tif (this.rModified) {\r\n\t\t\t\tthis.rModified = false;\r\n\t\t\t\tlet sina = Math.sin(this.R.y - Math.PI / 2), \r\n\t\t\t\tsinz = Math.sin(this.R.z),\r\n\t\t\t\tcosa = Math.cos(this.R.y - Math.PI / 2), \r\n\t\t\t\tcosz = Math.cos(this.R.z),\r\n\t\t\t\tcosy = Math.cos(this.R.y),\r\n\t\t\t\tsiny = Math.sin(this.R.y);\r\n\t\t\t\tthis.rTrans = glm.mat4(\r\n\t\t\t\t\t-sina * cosz, -sinz , cosa * cosz, 0,\r\n\t\t\t\t\t-sina * sinz, cosz  , cosa * sinz, 0,\r\n\t\t\t\t\t-cosa       , 0     , -sina      , 0,\r\n\t\t\t\t\t0           , 0     , 0          , 1\r\n\t\t\t\t);\r\n\t\t\t\tthis.qTrans = glm.mat4(\r\n\t\t\t\t\tcosy * cosz, cosy * sinz, -siny , 0,\r\n\t\t\t\t\t-sinz      , cosz       , 0     , 0,\r\n\t\t\t\t\tsiny * cosz, siny * sinz, cosy  , 0,\r\n\t\t\t\t\t0          , 0          , 0     , 1\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tif (this.tModified) {\r\n\t\t\t\tthis.tModified = false;\r\n\t\t\t\tthis.tTrans = glm.mat4(\r\n\t\t\t\t\t1, 0, 0, 0,\r\n\t\t\t\t\t0, 1, 0, 0,\r\n\t\t\t\t\t0, 0, 1, 0,\r\n\t\t\t\t\t-this.dist, 0, 0, 1\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tthis.pTrans = this.tTrans[\"*\"](this.rTrans);\r\n\t\t}\r\n\t\tthis.pos = this.P[\"+\"](this.qTrans[\"*\"](glm.vec4(this.dist, 0, 0, 1)).xyz);\r\n\t}\r\n\tgetView(): glm.mat4 {\r\n\t\tif (this.viewModified()) {\r\n\t\t\tif (this.rotateModified) {\r\n\t\t\t\tthis.rotateModified = false;\r\n\t\t\t\tlet U = glm.normalize(glm.cross(this.N, this.Up));\r\n\t\t\t\tlet V = glm.cross(U, this.N);\r\n\t\t\t\tthis.rotateTrans = glm.mat4(\r\n\t\t\t\t\tU.x, V.x, -this.N.x, 0, \r\n\t\t\t\t\tU.y, V.y, -this.N.y, 0,\r\n\t\t\t\t\tU.z, V.z, -this.N.z, 0,\r\n\t\t\t\t\t0, 0, 0, 1\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tif (this.translateModified || this.rModified || this.tModified) {\r\n\t\t\t\tthis.updatePTrans();\r\n\t\t\t\tif (this.translateModified) {\r\n\t\t\t\t\tthis.translateModified = false;\r\n\t\t\t\t\tthis.translateTrans = glm.mat4(\r\n\t\t\t\t\t\t1, 0, 0, 0,\r\n\t\t\t\t\t\t0, 1, 0, 0,\r\n\t\t\t\t\t\t0, 0, 1, 0,\r\n\t\t\t\t\t\t-this.P.x, -this.P.y, -this.P.z, 1\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tthis.wTrans = this.pTrans[\"*\"](this.translateTrans);\r\n\t\t\t}\r\n\t\t\tthis.mTrans = this.rotateTrans[\"*\"](this.wTrans);\r\n\t\t}\r\n\t\treturn this.mTrans;\r\n\t}\r\n\trotate(angle: glm.vec3) {\r\n\t\tthis.R[\"+=\"](angle);\r\n\t\tthis.R.y = clamp(this.R.y, -Math.PI / 2, Math.PI / 2);\r\n\t\tthis.rModified = true;\r\n\t}\r\n\tset rotation(angle: glm.vec3) {\r\n\t\tthis.R = angle;\r\n\t\tthis.R.y = clamp(this.R.y, -Math.PI / 2, Math.PI / 2);\r\n\t\tthis.rModified = true;\r\n\t}\r\n\tzoom(fact: number) {\r\n\t\tthis.dist *= fact;\r\n\t\tthis.dist = clamp(this.dist, this.minDist, this.maxDist);\r\n\t\tthis.tModified = true;\r\n\t}\r\n\r\n\tbind() {\r\n\t\tthis.mousewheel = Renderer.instance.dispatch(\"mousewheel\", (e: MouseWheelEvent) => {\r\n\t\t\tif (!Renderer.pause) {\r\n\t\t\t\tlet det = clamp(e.deltaY, -this.threshord, this.threshord);\r\n\t\t\t\tdet = det / (2 * this.threshord) + 1;\r\n\t\t\t\tthis.zoom(det);\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.mousemove = Renderer.instance.dispatch(\"mousemove\", (e: MouseEvent) => {\r\n\t\t\tif (this.isDragging) {\r\n\t\t\t\tif (Renderer.pause) {\r\n\t\t\t\t\tthis.isDragging = false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet c1 = Renderer.instance.canvas.height / Math.tan(this.ffov/2);\r\n\t\t\t\t\tlet c2 = Renderer.instance.canvas.width;\r\n\t\t\t\t\tlet h = 0.5 * Math.sqrt(c1 * c1 - c2 * c2);\r\n\t\t\t\t\tlet dx1 = e.clientX - Renderer.instance.canvas.width / 2;\r\n\t\t\t\t\tlet dx2 = this.prevx - Renderer.instance.canvas.width / 2;\r\n\t\t\t\t\tlet dy1 = e.clientY - Renderer.instance.canvas.height / 2;\r\n\t\t\t\t\tlet dy2 = this.prevy - Renderer.instance.canvas.height / 2;\r\n\t\t\t\t\tlet thetax = Math.atan(dx1/h) - Math.atan(dx2/h);\r\n\t\t\t\t\tlet thetay = Math.atan(dy1/h) - Math.atan(dy2/h);\r\n\t\t\t\t\tthis.rotate(glm.vec3(0, -thetay, -thetax));\r\n\t\t\t\t\tthis.prevx = e.clientX; this.prevy = e.clientY;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.mouseup = Renderer.instance.dispatch(\"mouseup\", (e: MouseEvent) => {\r\n\t\t\tthis.isDragging = false;\r\n\t\t});\r\n\t\tthis.mousedown = Renderer.instance.dispatch(\"mousedown\", (e: MouseEvent) => {\r\n\t\t\tthis.prevx = e.clientX;\r\n\t\t\tthis.prevy = e.clientY;\r\n\t\t\tthis.isDragging = true;\r\n\t\t});\r\n\t}\r\n\tunbind() {\r\n\t\tthis.mousewheel.cancel();\r\n\t\tthis.mousemove.cancel();\r\n\t\tthis.mouseup.cancel();\r\n\t\tthis.mousedown.cancel();\r\n\t\tthis.prevx = 0;\r\n\t\tthis.prevy = 0;\r\n\t\tthis.isDragging = false;\r\n\t}\r\n\tlocate(pos: glm.vec3) {\r\n\t\tthis.position = pos;\r\n\t}\r\n}\r\n\r\nexport {\r\n\tObserver\r\n}\r\n","import { CameraBase } from \"./cameraBase\";\r\nimport { glm } from \"../../util/glm\"\r\nimport { Renderer, RendererEvent } from \"../../renderer/renderer\";\r\nimport { m2screen } from \"../vessel/vessel\";\r\nimport { Submarine } from \"../vessel/submarine\";\r\n\r\nclass Periscope extends CameraBase {\r\n\tprivate static speed: number = .5 * m2screen;\r\n\tprivate static maxH: number = 5 * m2screen;\r\n\tprivate static minH: number = 0.;\r\n\r\n\tprivate mousedown: RendererEvent;\r\n\tprivate mousemove: RendererEvent;\r\n\tprivate mouseup: RendererEvent;\r\n\r\n\tprivate prevx: number = 0;\r\n\tprivate isDragging: boolean = false;\r\n\r\n\tprivate risev: number;\r\n\tprivate diff: number = 0;\r\n\r\n\tprivate parent: Submarine;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.zNear = 2e-2;\r\n\t\tthis.fzFar = 8e2;\r\n\t\tthis.fov = glm.radians(28);\r\n\t}\r\n\r\n\tviewModified() {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tgetView(): glm.mat4 {\r\n\t\treturn super.getView()[\"*\"](this.parent.getSpace());\r\n\t}\r\n\r\n\tgetCameraPosition(): glm.vec3 {\r\n\t\treturn this.parent.getTrival()[\"*\"](glm.vec4(super.getCameraPosition(), 1)).xyz;\r\n\t}\r\n\r\n\tbind() {\r\n\t\tthis.mousemove = Renderer.instance.dispatch(\"mousemove\", (e: MouseEvent) => {\r\n\t\t\tif (this.isDragging) {\r\n\t\t\t\tif (Renderer.pause) {\r\n\t\t\t\t\tthis.isDragging = false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet c1 = Renderer.instance.canvas.height / Math.tan(this.ffov/2);\r\n\t\t\t\t\tlet c2 = Renderer.instance.canvas.width;\r\n\t\t\t\t\tlet h = 0.5 * Math.sqrt(c1 * c1 - c2 * c2);\r\n\t\t\t\t\tlet dx1 = e.clientX - Renderer.instance.canvas.width / 2;\r\n\t\t\t\t\tlet dx2 = this.prevx - Renderer.instance.canvas.width / 2;\r\n\t\t\t\t\tlet thetax = Math.atan(dx1/h) - Math.atan(dx2/h);\r\n\t\t\t\t\tthis.rotate(glm.vec3(0, 0, -thetax));\r\n\t\t\t\t\tthis.prevx = e.clientX;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.mouseup = Renderer.instance.dispatch(\"mouseup\", (e: MouseEvent) => {\r\n\t\t\tthis.isDragging = false;\r\n\t\t});\r\n\t\tthis.mousedown = Renderer.instance.dispatch(\"mousedown\", (e: MouseEvent) => {\r\n\t\t\tif ((e.clientX - 425 - 14) * (e.clientX - 425 - 14) + (e.clientY - 374 - 42) * (e.clientY - 374 - 42)\r\n\t\t\t\t\t<= 325 * 325) {\r\n\t\t\t\tthis.prevx = e.clientX;\r\n\t\t\t\tthis.isDragging = true;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tunbind() {\r\n\t\tthis.mousedown.cancel();\r\n\t\tthis.mouseup.cancel();\r\n\t\tthis.mousemove.cancel();\r\n\t\tthis.prevx = 0;\r\n\t\tthis.isDragging = false;\r\n\t}\r\n\r\n\trise() {\r\n\t\tthis.risev = 1;\r\n\t}\r\n\r\n\tdown() {\r\n\t\tthis.risev = -1;\r\n\t}\r\n\r\n\tstop() {\r\n\t\tthis.risev = 0;\r\n\t}\r\n\r\n\tupdate(): number {\r\n\t\tif (this.risev) {\r\n\t\t\tlet d = this.risev * \r\n\t\t\t\tPeriscope.speed * Renderer.dt;\r\n\t\t\tthis.diff += d;\r\n\t\t\tlet fix = this.checkRange();\r\n\t\t\tthis.diff += fix;\r\n\t\t\td += fix;\r\n\t\t\tthis.translate(glm.vec3(0, 0, d));\r\n\t\t\treturn d / (Periscope.maxH - Periscope.minH);\r\n\t\t}\r\n\t\treturn 0;\r\n\t}\r\n\r\n\tprivate checkRange(): number { \r\n\t\tif (this.diff > Periscope.maxH) {\r\n\t\t\treturn Periscope.maxH - this.diff;\r\n\t\t} else if (this.diff < Periscope.minH) {\r\n\t\t\treturn Periscope.minH - this.diff;\r\n\t\t} else {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t}\r\n\r\n\tlocate(pos: glm.vec3) {\r\n\r\n\t}\r\n\r\n\tconfigureUboat(uboat: Submarine) {\r\n\t\tthis.parent = uboat;\r\n\t\tthis.diff = 0;\r\n\t\tthis.position = glm.vec3(0, m2screen * 3.8, m2screen * 5);\r\n\t}\r\n}\r\n\r\nexport {\r\n\tPeriscope\r\n}","import { glm } from \"../util/glm\"\r\nimport { gl, Renderer, RendererEvent, gl2 } from \"../renderer/renderer\"\r\nimport { Offscreen, RenderBuffer, PixelRetriver } from \"../gl/offscreen\";\r\nimport { Texture2D } from \"../gl/texture\";\r\nimport { DeferImage } from \"../techniques/deferImage\";\r\nimport { UV } from \"../techniques/uv\";\r\nimport { PerlinWave } from \"../techniques/perlinWave\";\r\nimport { AmbientCube } from \"../techniques/ambientCube\";\r\nimport { TestScreen } from \"../techniques/offscreenTest\";\r\nimport { Skybox } from \"../object/skybox\";\r\nimport { Communicators, Communicator } from \"../gl/communicator\";\r\nimport { GameRenderer } from \"./render\";\r\nimport { Vessel } from \"./vessel/vessel\";\r\nimport { Shader } from \"../gl/shader\";\r\nimport { CameraBase } from \"./camera/cameraBase\";\r\nimport { Ocean } from \"../object/ocean\";\r\nimport { ulist_elem, ulist } from \"../util/ulist\";\r\nimport { GerstnerWave } from \"../object/gerstnerWave\";\r\nimport { FFTWave } from \"../techniques/FFTWave\";\r\nimport { Phillips } from \"../techniques/phillips\";\r\nimport { DecodeImage } from \"../techniques/decodeImage\";\r\nimport { Normal } from \"../techniques/normal\"\r\nimport { TransformFeedback } from \"../gl/transformFeedback\";\r\nimport { Smoke } from \"./vessel/smoke\";\r\nimport { Gaussian } from \"../techniques/gaussian\";\r\nimport { Foam } from \"./vessel/foam\";\r\nimport { PDBO } from \"../gl/buffer\";\r\nimport asyncutil from \"../util/async\";\r\nimport { Explode } from \"./vessel/explode\";\r\n\r\nclass Engine3d {\r\n\tprivate communicators = new Communicators();\r\n\tprivate global = new Communicator(\"Global\", false);\r\n\t\r\n\tprivate mainImage = new Texture2D({ component: gl.RGBA, type: gl.FLOAT });\r\n\tprivate bumpImage = new Texture2D(\"./assets/bump.jpg\");\r\n\tprivate normalTypeImage = new Texture2D({ component: gl.RGBA, type: gl.FLOAT });\r\n\tprivate extraImage = new Texture2D({ component: gl2.RGBA, type: gl.FLOAT });\r\n\tprivate uvImage = new Texture2D({ component: gl.RGB });\r\n\tprivate perlinImage = new Texture2D({ component: gl2.RGBA, type: gl.FLOAT, filter: gl.LINEAR, wrap: gl.REPEAT }, 256, 256);\r\n\tprivate phillipsImage = new Texture2D({ component: gl2.RG, type: gl.FLOAT, filter: gl.NEAREST, wrap: gl.CLAMP_TO_EDGE }, 256, 256);\r\n\tprivate normalJImage = new Texture2D({ component: gl2.RGBA, type: gl.FLOAT, filter: gl.LINEAR, wrap: gl.REPEAT }, 256, 256);\r\n\tprivate smokeImage = new Texture2D({ component: gl.RGBA, type: gl.UNSIGNED_BYTE });\r\n\tprivate gaussianImage = new Texture2D({ component: gl2.RGBA, type: gl.FLOAT, filter: gl.NEAREST, wrap: gl.REPEAT });\r\n\tprivate stencialBuffer = new Texture2D({ component: gl2.RED, type: gl.FLOAT, filter: gl.NEAREST, wrap: gl.CLAMP_TO_EDGE });\r\n\t// private stencialBuffer = new RenderBuffer(gl.UNSIGNED_BYTE);\r\n\tprivate foamImage = new Texture2D(\"./assets/foam01.png\");\r\n\r\n\tprivate channel: Texture2D;\r\n\r\n\tprivate offscreen = new Offscreen();\r\n\tprivate suboffscreen = new Offscreen();\r\n\tprivate transformFeedback = new TransformFeedback();\r\n\r\n\tpublic readonly ambient = new AmbientCube();\r\n\tprivate main = new GameRenderer();\r\n\r\n\tprivate uv = new UV();\r\n\tprivate perlin = new PerlinWave();\r\n\tprivate defer = new DeferImage();\r\n\tprivate decode = new DecodeImage();\r\n\r\n\tprivate phillips = new Phillips();\r\n\tprivate fftWave = new FFTWave(this.phillipsImage);\r\n\tprivate normal = new Normal();\r\n\tprivate gaussian = new Gaussian();\r\n\r\n\tprivate skybox = new Skybox();\r\n\tpublic readonly ocean = new Ocean();\r\n\r\n\tconstructor() {\r\n\t\tgl.disable(gl.DEPTH_TEST);\r\n\t\tgl.viewport(0, 0, this.phillipsImage.width, this.phillipsImage.height);\r\n\t\tthis.offscreen.bind();\r\n\t\t\tthis.offscreen.set(gl.COLOR_ATTACHMENT0, this.phillipsImage);\r\n\t\t\tthis.phillips.render();\r\n\t\tthis.offscreen.unbind();\r\n\t\tgl.enable(gl.DEPTH_TEST);\r\n\t\tgl.viewport(0, 0, Renderer.instance.canvas.width, Renderer.instance.canvas.height);\r\n\r\n\t\tthis.offscreen.bind();\r\n\t\t\tthis.offscreen.set(gl.DEPTH_ATTACHMENT, new RenderBuffer(gl.DEPTH_COMPONENT16));\r\n\t\t\tthis.offscreen.set(gl.COLOR_ATTACHMENT0, this.gaussianImage);\r\n\t\t\tthis.gaussian.render();\r\n\t\tthis.offscreen.unbind();\r\n\r\n\t\tthis.global.init({\r\n\t\t\tLightDir: {\r\n\t\t\t\ttype: \"vec3\",\r\n\t\t\t\tinit: glm.vec3(0, 0, 1)\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.communicators.add(this.global);\r\n\r\n\t\tif (!gl2) {\r\n\t\t\tthrow \"webgl 2.0 required.\";\r\n\t\t}\r\n\t}\r\n\r\n\trender(vessels: ulist<Vessel>, explodes: ulist<Explode>, target: Texture2D, sample?: (r: number) => void) {\r\n\t\t// set gl state\r\n\t\tgl.clearColor(0, 0, 0, 0);\r\n\t\tgl.clearDepth(1);\r\n\r\n\t\t// reder ambient cube - offscreen\r\n\t\tthis.ambient.render();\r\n\r\n\t\tthis.gaussianImage.use(\"Gaussian\");\r\n\t\t\tthis.fftWave.render();\r\n\t\tthis.gaussianImage.unuse();\r\n\r\n\t\t// render main image into mainImage\r\n\t\tthis.offscreen.bind();\r\n\r\n\t\tgl.viewport(0, 0, 256, 256);\r\n\r\n\t\tgl.disable(gl.DEPTH_TEST);\r\n\r\n\t\t\tthis.suboffscreen.bind();\r\n\r\n\t\t\t\tthis.suboffscreen.set(gl.COLOR_ATTACHMENT0, this.perlinImage);\r\n\t\t\t\tthis.perlin.render();\r\n\r\n\t\t\t\tthis.suboffscreen.set(gl.COLOR_ATTACHMENT0, this.normalJImage);\r\n\t\t\t\tthis.fftWave.texture.use(\"Displacement\");\r\n\t\t\t\tthis.normal.render();\r\n\t\t\t\tthis.fftWave.texture.unuse();\r\n\r\n\t\t\tthis.suboffscreen.unbind();\r\n\r\n\t\tgl.enable(gl.DEPTH_TEST);\r\n\r\n\t\tthis.communicators.use();\r\n\t\tthis.global.set(\"LightDir\", this.ambient.lightDir);\r\n\r\n\t\tthis.main.viewport.use();\r\n\r\n\t\t\tgl.clearColor(.0, .0, .0, -1e8);\r\n\t\t\r\n\t\t\tthis.offscreen.set(gl2.COLOR_ATTACHMENT0, this.mainImage);\r\n\t\t\tthis.offscreen.set(gl2.COLOR_ATTACHMENT1, this.normalTypeImage);\r\n\t\t\tthis.offscreen.set(gl2.COLOR_ATTACHMENT2, this.extraImage);\r\n\t\t\tgl2.drawBuffers([\r\n\t\t\t\tgl2.COLOR_ATTACHMENT0, \r\n\t\t\t\tgl2.COLOR_ATTACHMENT1, \r\n\t\t\t\tgl2.COLOR_ATTACHMENT2\r\n\t\t\t]);\r\n\r\n\t\t\tgl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\r\n\r\n\t\t\tVessel.bindShader();\r\n\t\t\t\tvessels.visit((e: ulist_elem<Vessel>) => {\r\n\t\t\t\t\te.get().render(this.main.viewport);\r\n\t\t\t\t});\r\n\t\t\tVessel.unbindShader();\r\n\r\n\t\t\tgl2.drawBuffers([\r\n\t\t\t\tgl2.NONE,\r\n\t\t\t\tgl2.COLOR_ATTACHMENT1, \r\n\t\t\t\tgl2.COLOR_ATTACHMENT2\r\n\t\t\t]);\r\n\r\n\t\t\tthis.fftWave.texture.use(\"Displacement\");\r\n\t\t\tthis.normalJImage.use(\"NormalJ\");\r\n\t\t\tthis.bumpImage.use(\"Bump\");\r\n\t\t\tthis.perlinImage.use(\"Perlin\");\r\n\t\t\tthis.ocean.bindShader();\r\n\t\t\t\tthis.ocean.render(this.main.viewport);\r\n\t\t\tthis.ocean.unbindShader();\r\n\t\t\tthis.perlinImage.unuse();\r\n\t\t\tthis.bumpImage.unuse();\r\n\t\t\tthis.normalJImage.unuse();\r\n\t\t\tthis.fftWave.texture.unuse();\r\n\r\n\t\t\tgl2.drawBuffers([\r\n\t\t\t\tgl2.COLOR_ATTACHMENT0,\r\n\t\t\t\tgl2.NONE,\r\n\t\t\t\tgl2.COLOR_ATTACHMENT2\r\n\t\t\t]);\r\n\r\n\t\t\tthis.ambient.texture.use(\"Ambient\");\r\n\t\t\tthis.skybox.bindShader();\r\n\t\t\t\tthis.skybox.render(this.main.viewport);\r\n\t\t\tthis.skybox.unbindShader();\r\n\t\t\tthis.ambient.texture.unuse();\r\n\r\n\t\t\tthis.offscreen.set(gl2.COLOR_ATTACHMENT0, this.smokeImage);\r\n\t\t\tthis.offscreen.set(gl2.COLOR_ATTACHMENT1, null);\r\n\t\t\tthis.offscreen.set(gl2.COLOR_ATTACHMENT2, null);\r\n\t\t\tgl.clearColor(.0, .0, .0, .0);\r\n\t\t\tgl.clear(gl.COLOR_BUFFER_BIT);\r\n\t\t\tgl.enable(gl.BLEND);\r\n\t\t\tgl.blendFunc(gl.SRC_ALPHA, gl.ONE);\r\n\t\t\tgl.depthMask(false);\r\n\t\t\tthis.transformFeedback.bind();\r\n\t\t\tthis.gaussianImage.use(\"Gaussian\");\r\n\t\t\tSmoke.bindShader();\r\n\t\t\t\tvessels.visit((e: ulist_elem<Vessel>) => {\r\n\t\t\t\t\tlet parent = e.get();\r\n\t\t\t\t\tfor (let s of parent.smokes) {\r\n\t\t\t\t\t\ts.render(this.main.viewport);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\tSmoke.unbindShader();\r\n\t\t\t\r\n\t\t\tExplode.bindShader();\r\n\t\t\t\texplodes.visit((e: ulist_elem<Explode>) => {\r\n\t\t\t\t\tlet f = e.get();\r\n\t\t\t\t\tf.render(this.main.viewport);\r\n\t\t\t\t});\r\n\t\t\tExplode.unbindShader();\r\n\t\t\tthis.gaussianImage.unuse();\r\n\t\t\t\r\n\t\t\t// gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\r\n\t\t\t// this.foamImage.use(\"Foam\");\r\n\t\t\t// Foam.bindShader();\r\n\t\t\t// \tvessels.visit((e: ulist_elem<Vessel>) => {\r\n\t\t\t// \t\te.get().foam.render(this.main.viewport);\r\n\t\t\t// \t});\r\n\t\t\t// Foam.unbindShader();\r\n\t\t\t// this.foamImage.unuse();\r\n\r\n\t\t\tthis.transformFeedback.unbind();\r\n\t\t\tgl.depthMask(true);\r\n\t\t\tgl.disable(gl.BLEND);\r\n\r\n\t\tthis.main.viewport.unuse();\r\n\r\n\t\t// end world pass\r\n\t\tgl.disable(gl.DEPTH_TEST);\r\n\t\t\t\r\n\t\t\tthis.offscreen.set(gl.COLOR_ATTACHMENT0, target);\r\n\t\t\tthis.offscreen.set(gl2.COLOR_ATTACHMENT1, this.stencialBuffer);\r\n\t\t\tgl2.drawBuffers([\r\n\t\t\t\tgl.COLOR_ATTACHMENT0,\r\n\t\t\t\tgl2.COLOR_ATTACHMENT1\r\n\t\t\t]);\r\n\r\n\t\t\t// main renderer\r\n\t\t\tthis.mainImage.use(\"Image\");\r\n\t\t\tthis.normalTypeImage.use(\"NormalType\");\r\n\t\t\tthis.extraImage.use(\"Extra\");\r\n\t\t\tthis.ambient.texture.use(\"Ambient\");\r\n\t\t\tthis.smokeImage.use(\"Smoke\");\r\n\r\n\t\t\t\tthis.main.render();\r\n\t\t\t\t// this.uv.render();\r\n\r\n\t\t\tthis.smokeImage.unuse();\r\n\t\t\tthis.ambient.texture.unuse();\r\n\t\t\tthis.extraImage.unuse();\r\n\t\t\tthis.normalTypeImage.unuse();\r\n\t\t\tthis.mainImage.unuse();\r\n\r\n\t\t\tgl2.drawBuffers([\r\n\t\t\t\tgl.COLOR_ATTACHMENT0\r\n\t\t\t]);\r\n\r\n\t\t\tif (sample) {\r\n\t\t\t\tlet r = 300, t = 16;\r\n\t\t\t\tgl2.readBuffer(gl2.COLOR_ATTACHMENT1);\r\n\t\t\t\tasyncutil.retrieve(t, (i: number, collect: (data) => void) => {\r\n\t\t\t\t\tlet ret = new PixelRetriver(new Float32Array(1));\r\n\t\t\t\t\tgl2.readPixels(\r\n\t\t\t\t\t\t600 + r*Math.cos(2*Math.PI * i/t), \r\n\t\t\t\t\t\t450 + r*Math.sin(2*Math.PI * i/t), \r\n\t\t\t\t\t\t1, 1, gl2.RED, gl.FLOAT, 0\r\n\t\t\t\t\t);\r\n\t\t\t\t\tret.getDataAsync((buffer) => collect(buffer[0]));\r\n\t\t\t\t}, (samples: any[]) => {\r\n\t\t\t\t\tlet s = 0; for (let x of samples) s += x; sample(s / t);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.offscreen.set(gl2.COLOR_ATTACHMENT1, null);\r\n\r\n\t\t\t// this.debugWindow(this.stencialBuffer, false, 0);\r\n\t\t\t// this.debugWindow(this.normalTypeImage, true, 1);\r\n\t\t\t// this.debugWindow(this.extraImage, false, 2);\r\n\t\t\r\n\t\tthis.communicators.unuse();\r\n\t\tthis.offscreen.unbind();\r\n\t}\r\n\r\n\tdebugWindow(texture: Texture2D, normalize: boolean, index: number)\r\n\t{\r\n\t\tlet w = index % 3;\r\n\t\tlet h = Math.floor(index / 3);\r\n\t\tgl.viewport(\r\n\t\t\tRenderer.instance.canvas.width/3 * w, \r\n\t\t\tRenderer.instance.canvas.height/3 * h, \r\n\t\t\tRenderer.instance.canvas.width/3, \r\n\t\t\tRenderer.instance.canvas.height/3\r\n\t\t);\r\n\t\ttexture.use(\"Image\");\r\n\t\tif (normalize) this.decode.render();\r\n\t\telse this.defer.render();\r\n\t\ttexture.unuse();\r\n\t\tgl.viewport(0, 0, Renderer.instance.canvas.width, Renderer.instance.canvas.height);\r\n\t}\r\n\r\n\tsetCamera(camera: CameraBase) {\r\n\t\tif (this.main.viewport) {\r\n\t\t\tthis.main.viewport.unbind();\r\n\t\t}\r\n\t\tthis.main.viewport = camera;\r\n\t\tcamera.bind();\r\n\t}\r\n}\r\n\r\nexport {\r\n\tEngine3d\r\n}\r\n","import { glm } from \"../util/glm\"\r\nimport { gl, Renderer, RendererEvent } from \"../renderer/renderer\"\r\nimport { Ocean } from \"../object/ocean\";\r\nimport { ulist_elem, ulist } from \"../util/ulist\";\r\nimport { Observer } from \"./camera/observer\";\r\nimport { CameraBase } from \"./camera/cameraBase\";\r\nimport { Vessel, m2screen } from \"./vessel/vessel\";\r\nimport { Submarine } from \"./vessel/submarine\";\r\nimport { Engine3d } from \"./engine3d\";\r\nimport { Splash } from \"./2d/splash\";\r\nimport { Communicators } from \"../gl/communicator\";\r\nimport { Options } from \"./2d/options\";\r\nimport { Offscreen } from \"../gl/offscreen\";\r\nimport { Texture2D } from \"../gl/texture\";\r\nimport { GaussBlur } from \"../techniques/gaussBlur\";\r\nimport { Periscope } from \"./camera/periscope\";\r\nimport { Torpedo } from \"./vessel/torpedo\";\r\nimport { DeferImage } from \"../techniques/deferImage\";\r\nimport { PeriScreen } from \"./2d/periscreen\";\r\nimport { Explode } from \"./vessel/explode\";\r\nimport { missions } from \"./mission\";\r\n\r\ntype CameraMode = \"observe\" | \"follow\" | \"free\" | \"periscope\"\r\n\r\ntype DisplayMode = \"3d\" | \"periscope\" | \"menu\" | \"map\" | \"splash\" | \"options\"\r\n\r\nfunction inRect(x: number, y: number, x0: number, y0: number, x1: number, y1: number): boolean {\r\n\treturn x >= x0 && x < x1 && y >= y0 && y < y1;\r\n}\r\n\r\nfunction hit(t: glm.vec4, v: Vessel) {\r\n\tlet x = glm.inverse(v.getTrans())[\"*\"](t).xy;\r\n\tif (x.y < v.collider[1] || \r\n\t\tx.y > v.collider[v.collider.length - 1]) {\r\n\t\treturn false;\r\n\t}\r\n\tlet l = 0, r = (v.collider.length >> 1) - 1;\r\n\twhile (r - l > 1) {\r\n\t\tlet m = (l + r) >> 1;\r\n\t\tif (x.y >= v.collider[(m << 1) | 1]) {\r\n\t\t\tl = m;\r\n\t\t} else {\r\n\t\t\tr = m;\r\n\t\t}\r\n\t}\r\n\tif (l == (v.collider.length >> 1) - 1) {\r\n\t\tl -= 1;\r\n\t}\r\n\tlet lam = (x.y - v.collider[(l << 1) + 1]) / \r\n\t\t( v.collider[(l << 1) + 3] - v.collider[(l << 1) + 1] );\r\n\tlet z = (1 - lam) * v.collider[(l << 1) + 0] + \r\n\t\tlam * v.collider[(l << 1) + 2];\r\n\treturn Math.abs(x.x) <= z;\r\n}\r\n\r\nclass Game {\r\n\tprivate renderer = new Renderer(document.body);\r\n\t\r\n\tprivate viewports = {\r\n\t\tobserve: new Observer(),\r\n\t\tfollow: new Observer(),\r\n\t\tperiscope: new Periscope()\r\n\t};\r\n\r\n\tprivate vessels = new ulist<Vessel>();\r\n\tprivate explodes = new ulist<Explode>();\r\n\tprivate uboat: Submarine;\r\n\r\n\tprivate battleKeys: RendererEvent;\r\n\tprivate battleKeysUp: RendererEvent;\r\n\tprivate battleMouses: RendererEvent;\r\n\tprivate battleMousesUp: RendererEvent;\r\n\tprivate prevDisplayMode: DisplayMode = undefined;\r\n\tprivate displayMode: DisplayMode = \"menu\";\r\n\t\r\n\tprivate renderOption: boolean = false;\r\n\tprivate inGame: boolean = false;\r\n\tprivate blurTime: number = 0;\r\n\tprivate prevr: number = 1;\r\n\r\n\tprivate engine3d = new Engine3d();\r\n\tprivate splash = new Splash(\"loading.png\");\r\n\tprivate options = new Options();\r\n\tprivate periscreen = new PeriScreen();\r\n\tprivate defer = new DeferImage();\r\n\r\n\tprivate queryObjects: string[] = [];\r\n\r\n\tprivate offscreen = new Offscreen();\r\n\tprivate gaussBlur = new GaussBlur();\r\n\tprivate worldBuffer = new Texture2D({ component: gl.RGB });\r\n\tprivate swapBuffer = new Texture2D({ component: gl.RGB });\r\n\tprivate screenBuffer = new Texture2D({ component: gl.RGB });\r\n\r\n\tconstructor() {\r\n\t\tnew Communicators().use();\r\n\r\n\t\tthis.beginBattle(missions[\".narvik\"]);\r\n\t}\r\n\r\n\tstart() {\r\n\t\tthis.renderer.dispatch(\"render\", () => {\r\n\t\t\tconst callbacks = {\r\n\t\t\t\t\"3d\": () => {\r\n\t\t\t\t\tthis.engine3d.render(this.vessels, this.explodes, this.screenBuffer);\r\n\t\t\t\t\tgl.disable(gl.DEPTH_TEST);\r\n\t\t\t\t\tthis.screenBuffer.use(\"Image\");\r\n\t\t\t\t\t\tthis.defer.render();\r\n\t\t\t\t\tthis.screenBuffer.unuse();\r\n\t\t\t\t},\r\n\t\t\t\t\"periscope\": () => {\r\n\t\t\t\t\tthis.engine3d.render(this.vessels, this.explodes, this.worldBuffer, (r: number) => {\r\n\t\t\t\t\t\tif (Math.abs(this.prevr - r) > 0.2) {\r\n\t\t\t\t\t\t\tthis.blurTime = 2.5;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.prevr = r;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.offscreen.bind();\r\n\t\t\t\t\t\tif (this.blurTime > 0) {\r\n\t\t\t\t\t\t\tlet t = this.swapBuffer; this.swapBuffer = this.worldBuffer; this.worldBuffer = t;\r\n\t\t\t\t\t\t\tthis.gaussBlur.setRadius(12 * Math.sqrt(this.blurTime));\r\n\t\t\t\t\t\t\tthis.gaussBlur.render(this.swapBuffer, this.worldBuffer);\r\n\t\t\t\t\t\t\tthis.blurTime -= Renderer.dt;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.offscreen.set(gl.COLOR_ATTACHMENT0, this.screenBuffer);\r\n\t\t\t\t\t\tthis.periscreen.render(this.worldBuffer);\r\n\t\t\t\t\tthis.offscreen.unbind();\r\n\t\t\t\t\tgl.disable(gl.DEPTH_TEST);\r\n\t\t\t\t\tthis.screenBuffer.use(\"Image\");\r\n\t\t\t\t\t\tthis.defer.render();\r\n\t\t\t\t\tthis.screenBuffer.unuse();\r\n\t\t\t\t},\r\n\t\t\t\t\"menu\": () => {\r\n\t\t\t\t\t// this.engine3d.render(this.vessels); \r\n\t\t\t\t},\r\n\t\t\t\t\"map\": () => {\r\n\t\t\t\t\t\r\n\t\t\t\t},\r\n\t\t\t\t\"splash\": () => {\r\n\t\t\t\t\tthis.splash.render();\r\n\t\t\t\t},\r\n\t\t\t\t\"options\": () => {\r\n\t\t\t\t\tif (this.renderOption) {\r\n\t\t\t\t\t\tthis.renderOption = false;\r\n\t\t\t\t\t\t// this.engine3d.render(this.vessels, this.worldBuffer);\r\n\t\t\t\t\t\tgl.disable(gl.DEPTH_TEST);\r\n\t\t\t\t\t\tthis.offscreen.bind();\r\n\t\t\t\t\t\t\tthis.gaussBlur.setRadius(10);\r\n\t\t\t\t\t\t\tthis.gaussBlur.render(this.screenBuffer, this.options.bg);\r\n\t\t\t\t\t\tthis.offscreen.unbind();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.options.render();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tcallbacks[this.displayMode] ();\r\n\t\t\tif (this.inGame && this.displayMode != \"options\") {\r\n\t\t\t\tlet d = this.viewports.periscope.update();\r\n\t\t\t\tthis.periscreen.indicatorState(d);\r\n\t\t\t\tthis.explodes.visit((e: ulist_elem<Explode>) => {\r\n\t\t\t\t\tif (!e.get().checkRange()) {\r\n\t\t\t\t\t\te.remove();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tthis.updateVessels();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.renderer.start();\r\n\t}\r\n\r\n\tupdateVessels() {\r\n\t\tthis.vessels.visit((e: ulist_elem<Vessel>) => {\r\n\t\t\tlet v = e.get();\r\n\t\t\tif (v instanceof Torpedo) {\r\n\t\t\t\tlet torpedo = v;\r\n\t\t\t\tlet tpos = torpedo.getTrans()[\"*\"](glm.vec4(0, torpedo.collider[3], 0, 1));\r\n\t\t\t\tlet ves = null;\r\n\t\t\t\tthis.vessels.visit((e: ulist_elem<Vessel>) => {\r\n\t\t\t\t\tlet v = e.get();\r\n\t\t\t\t\tif (v instanceof Vessel && !(v instanceof Torpedo) \r\n\t\t\t\t\t\t&& !(v instanceof Submarine)) {\r\n\t\t\t\t\t\tif (hit(tpos, v)) {\r\n\t\t\t\t\t\t\tves = v;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (ves) {\r\n\t\t\t\t\tthis.explodes.push(new Explode(torpedo.position.xy));\r\n\t\t\t\t\te.remove();\r\n\t\t\t\t} else if (torpedo.checkRange()) {\r\n\t\t\t\t\tv.update();\r\n\t\t\t\t} else {\r\n\t\t\t\t\te.remove();\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tv.update();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tspawnVessel(className: string, opt: { [key: string]: any } = {}) {\r\n\t\tthis.queryObjects.push(className);\r\n\t\tlet self = this;\r\n\t\tnew Vessel(className, (v: Vessel) => {\r\n\t\t\tself.vessels.push(v);\r\n\t\t\t// console.log(opt);\r\n\t\t\tif (\"position\" in opt) {\r\n\t\t\t\tv.position = glm.vec3(-opt.position[0], -opt.position[1], 0)[\"*\"](m2screen);\r\n\t\t\t}\r\n\t\t\tif (\"target\" in opt) {\r\n\t\t\t\tv.speedAngle = opt.target;\r\n\t\t\t}\r\n\t\t\tif (\"speed\" in opt) {\r\n\t\t\t\tv.initSpeed = opt.speed;\r\n\t\t\t}\r\n\t\t\tself.queryObjects.splice(self.queryObjects.indexOf(className), 1);\r\n\t\t\tself.checkLoadingFinish();\r\n\t\t});\r\n\t\t// clemson.speed = 35.5;\r\n\t}\r\n\r\n\tresetUboat(className: string, opt: { [key: string]: any } = {}) {\r\n\t\tthis.queryObjects.push(className);\r\n\t\tlet self = this;\r\n\t\tnew Submarine(className, (v: Submarine) => {\r\n\t\t\tself.uboat = v;\r\n\t\t\tself.vessels.push(self.uboat);\r\n\t\t\tif (\"depth\" in opt) {\r\n\t\t\t\tv.position = v.position[\"+\"](glm.vec3(0, 0, -opt.depth)[\"*\"](m2screen));\r\n\t\t\t}\r\n\t\t\tif (\"target\" in opt) {\r\n\t\t\t\tv.speedAngle = opt.target;\r\n\t\t\t}\r\n\t\t\tif (\"speed\" in opt) {\r\n\t\t\t\tv.initSpeed = opt.speed;\r\n\t\t\t}\r\n\t\t\tself.queryObjects.splice(self.queryObjects.indexOf(className), 1);\r\n\t\t\tself.checkLoadingFinish();\r\n\t\t\tself.viewports.periscope.configureUboat(v);\r\n\t\t\tself.periscreen.configureUboat(v);\r\n\t\t});\r\n\t}\r\n\r\n\tspawnTorpedo(className: string, launcher: number) {\r\n\t\tlet self = this;\r\n\t\tnew Torpedo(className, (v: Torpedo) => {\r\n\t\t\tlet x = self.uboat.torpedoLauncher[launcher];\r\n\t\t\tlet p = glm.vec4(x.position[0], x.position[1], x.position[2], 1);\r\n\t\t\tlet m = this.uboat.getTrans();\r\n\t\t\tv.position = m[\"*\"](p).xyz;\r\n\t\t\tv.speed = this.uboat.speed * 1.5;\r\n\t\t\tv.targetSpeed = 1;\r\n\t\t\tlet u = glm.vec4(x.orient[0], x.orient[1], x.orient[2], 0);\r\n\t\t\tv.orient = glm.normalize(m[\"*\"](u).xy);\r\n\t\t\tself.vessels.push(v);\r\n\t\t});\r\n\t}\r\n\r\n\tcheckLoadingFinish() {\r\n\t\tif (!this.queryObjects.length) {\r\n\t\t\tthis.finishLoading();\r\n\t\t}\r\n\t}\r\n\t\r\n\tsetMode(mode: string) {\r\n\t\tif (this.displayMode == \"periscope\" && mode != \"periscope\") {\r\n\t\t\tthis.viewports.periscope.stop();\r\n\t\t}\r\n\t\tswitch (mode) {\r\n\t\t\tcase \"free\": {\r\n\t\t\t\tthis.displayMode = \"3d\";\r\n\t\t\t\tthis.engine3d.setCamera(this.viewports.observe);\r\n\t\t\t\tthis.viewports.observe.tie(this.uboat);\r\n\t\t\t} break;\r\n\t\t\tcase \"gun\": {\r\n\t\t\t\tthis.displayMode = \"3d\";\r\n\t\t\t\tthis.engine3d.setCamera(this.viewports.follow);\r\n\t\t\t} break;\r\n\t\t\tcase \"map\": {\r\n\t\t\t\tthis.displayMode = \"map\";\r\n\t\t\t} break;\r\n\t\t\tcase \"turm\": {\r\n\t\t\t\tthis.displayMode = \"3d\";\r\n\t\t\t\tthis.engine3d.setCamera(this.viewports.follow);\r\n\t\t\t} break;\r\n\t\t\tcase \"periscope\": {\r\n\t\t\t\tthis.displayMode = \"periscope\"; \r\n\t\t\t\tthis.engine3d.setCamera(this.viewports.periscope);\r\n\t\t\t} break;\r\n\t\t\tdefault: {\r\n\t\t\t\tthrow \"unknown mode: \" + mode;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tbeginBattle(opt: { [key: string]: any } = {}) {\r\n\t\tthis.displayMode = \"splash\";\r\n\t\tthis.queryObjects = [];\r\n\r\n\t\tfor (let x of opt.sea) {\r\n\t\t\tthis.spawnVessel(x.className, {\r\n\t\t\t\tposition: x.position,\r\n\t\t\t\ttarget: x.target,\r\n\t\t\t\tspeed: x.speed\r\n\t\t\t});\r\n\t\t} \r\n\t\tthis.resetUboat(opt.uboat.className, {\r\n\t\t\ttarget: opt.uboat.target,\r\n\t\t\tspeed: opt.uboat.speed,\r\n\t\t\tdepth: opt.uboat.depth\r\n\t\t});\r\n\r\n\t\tRenderer.timescale = 1;\r\n\t\tthis.engine3d.ambient.setTime(opt.ambient.time);\r\n\t}\r\n\r\n\tfinishLoading() {\r\n\t\tthis.battleKeys = Renderer.instance.dispatch(\"keydown\", (e: KeyboardEvent) => {\r\n\t\t\tif (this.displayMode != \"options\" || e.key.toLowerCase() == \"escape\") {\r\n\t\t\t\tconst lookup = {\r\n\t\t\t\t\t\"f3\": this.setMode.bind(this, \"periscope\"),\r\n\t\t\t\t\t\"f4\": this.setMode.bind(this, \"turm\"),\r\n\t\t\t\t\t\"f5\": this.setMode.bind(this, \"map\"),\r\n\t\t\t\t\t\"f10\": this.setMode.bind(this, \"gun\"),\r\n\t\t\t\t\t\"f12\": this.setMode.bind(this, \"free\"),\r\n\r\n\t\t\t\t\t\"`\": () => this.uboat.targetSpeed = 0,\r\n\t\t\t\t\t\"1\": () => this.uboat.targetSpeed = 1/5,\r\n\t\t\t\t\t\"2\": () => this.uboat.targetSpeed = 1/3,\r\n\t\t\t\t\t\"3\": () => this.uboat.targetSpeed = 1/2,\r\n\t\t\t\t\t\"4\": () => this.uboat.targetSpeed = 3/4,\r\n\t\t\t\t\t\"5\": () => this.uboat.targetSpeed = 1,\r\n\t\t\t\t\t\"6\": () => this.uboat.targetSpeed = -1/6,\r\n\t\t\t\t\t\"7\": () => this.uboat.targetSpeed = -1/4,\r\n\t\t\t\t\t\"8\": () => this.uboat.targetSpeed = -1/2,\r\n\t\t\t\t\t\"9\": () => this.uboat.targetSpeed = -3/4,\r\n\r\n\t\t\t\t\t\"q\": () => { if (!e.repeat) this.uboat.diveSignal(-1); },\r\n\t\t\t\t\t\"w\": () => { if (!e.repeat) this.uboat.diveSignal(0); },\r\n\t\t\t\t\t\"e\": () => { if (!e.repeat) this.uboat.diveSignal(1); },\r\n\r\n\t\t\t\t\t\"a\": () => { if (!e.repeat) this.uboat.rudderSignal(-1); },\r\n\t\t\t\t\t\"s\": () => { if (!e.repeat) this.uboat.rudderSignal(0); },\r\n\t\t\t\t\t\"d\": () => { if (!e.repeat) this.uboat.rudderSignal(1); },\r\n\r\n\t\t\t\t\t\"z\": () => this.spawnTorpedo(\"TII_G7e\", 0),\r\n\r\n\t\t\t\t\t\"escape\": () => {\r\n\t\t\t\t\t\tif (this.displayMode != \"options\") {\r\n\t\t\t\t\t\t\tthis.prevDisplayMode = this.displayMode;\r\n\t\t\t\t\t\t\tthis.displayMode = \"options\";\r\n\t\t\t\t\t\t\tthis.renderOption = true;\r\n\t\t\t\t\t\t\tRenderer.pauseClock();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.displayMode = this.prevDisplayMode;\r\n\t\t\t\t\t\t\tRenderer.continueClock();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tif (e.key.toLowerCase() in lookup) {\r\n\t\t\t\t\tlookup[e.key.toLowerCase()] ();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.battleKeysUp = Renderer.instance.dispatch(\"keyup\", (e: KeyboardEvent) => {\r\n\t\t\tif (this.displayMode != \"options\") {\r\n\t\t\t\tconst lookup = {\r\n\r\n\t\t\t\t\t\"q\": () => this.uboat.diveSignal(-1),\r\n\t\t\t\t\t\"w\": () => this.uboat.diveSignal(0),\r\n\t\t\t\t\t\"e\": () => this.uboat.diveSignal(1),\r\n\r\n\t\t\t\t\t\"a\": () => this.uboat.rudderSignal(-1),\r\n\t\t\t\t\t\"s\": () => this.uboat.rudderSignal(0),\r\n\t\t\t\t\t\"d\": () => this.uboat.rudderSignal(1)\r\n\t\t\t\t};\r\n\t\t\t\tif (e.key.toLowerCase() in lookup) {\r\n\t\t\t\t\tlookup[e.key.toLowerCase()] ();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.battleMouses = Renderer.instance.dispatch(\"mousedown\", (e: MouseEvent) => {\r\n\t\t\tswitch (this.displayMode) {\r\n\t\t\t\tcase \"periscope\": {\r\n\t\t\t\t\t// console.log(e.clientX, e.clientY);\r\n\t\t\t\t\tif (inRect(e.clientX, e.clientY, 858 + 14, 572 + 42, 938 + 14, 612 + 42)) {\r\n\t\t\t\t\t\tthis.viewports.periscope.rise();\r\n\t\t\t\t\t\tthis.periscreen.periscopeState(1);\r\n\t\t\t\t\t} else if (inRect(e.clientX, e.clientY, 858 + 14, 612 + 42, 938 + 14, 652 + 42)) {\r\n\t\t\t\t\t\tthis.viewports.periscope.down();\r\n\t\t\t\t\t\tthis.periscreen.periscopeState(0);\r\n\t\t\t\t\t}\r\n\t\t\t\t} break;\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.battleMousesUp = Renderer.instance.dispatch(\"mouseup\", (e: MouseEvent) => {\r\n\t\t\tswitch (this.displayMode) {\r\n\t\t\t\tcase \"periscope\": {\r\n\t\t\t\t\tthis.viewports.periscope.stop();\r\n\t\t\t\t\tthis.periscreen.periscopeState(2);\r\n\t\t\t\t} break;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.inGame = true;\r\n\r\n\t\tthis.setMode(\"free\");\r\n\t}\r\n\t\r\n\tendBattle() {\r\n\t\tthis.inGame = false;\r\n\t\tthis.vessels.clear();\r\n\t\tthis.uboat = null;\r\n\t\tthis.battleKeys.cancel();\r\n\t\tthis.battleKeysUp.cancel();\r\n\t\tthis.battleMouses.cancel();\r\n\t\tthis.battleMousesUp.cancel();\r\n\t}\r\n}\r\n\r\nexport {\r\n\tGame\r\n}\r\n","const missions = {\r\n\tbismark: {\r\n\t\tsea: [{\r\n\t\t\tclassName: \"bismark\",\r\n\t\t\tposition: [1350, 180],\r\n\t\t\ttarget: 0,\r\n\t\t\tspeed: 0.1\r\n\t\t}, {\r\n\t\t\tclassName: \"hipper\",\r\n\t\t\tposition: [-270, -420],\r\n\t\t\ttarget: -90,\r\n\t\t\tspeed: 0.15\r\n\t\t}, {\r\n\t\t\tclassName: \"hipper\",\r\n\t\t\tposition: [-320, -800],\r\n\t\t\ttarget: -84,\r\n\t\t\tspeed: 0.15\r\n\t\t}, {\r\n\t\t\tclassName: \"clemson\",\r\n\t\t\tposition: [-800, -320],\r\n\t\t\ttarget: -90,\r\n\t\t\tspeed: 0.12\r\n\t\t}, {\r\n\t\t\tclassName: \"clemson\",\r\n\t\t\tposition: [-760, -800],\r\n\t\t\ttarget: -84,\r\n\t\t\tspeed: 0.12\r\n\t\t}],\r\n\t\tuboat: {\r\n\t\t\tclassName: \"7c\",\r\n\t\t\ttarget: -90,\r\n\t\t\tspeed: 0,\r\n\t\t\tdepth: 8\r\n\t\t},\r\n\t\tambient: {\r\n\t\t\ttime: 9\r\n\t\t}\r\n\t},\r\n\tnarvik: {\r\n\t\tsea: [{\r\n\t\t\tclassName: \"illustrious\",\r\n\t\t\tposition: [-1000, -1300],\r\n\t\t\ttarget: 180,\r\n\t\t\tspeed: 0.2\r\n\t\t}, {\r\n\t\t\tclassName: \"hipper\",\r\n\t\t\tposition: [-900, -900],\r\n\t\t\ttarget: 180,\r\n\t\t\tspeed: 0.2\r\n\t\t}, {\r\n\t\t\tclassName: \"clemson\",\r\n\t\t\tposition: [-100, -1150],\r\n\t\t\ttarget: 180,\r\n\t\t\tspeed: 0.2\r\n\t\t}, {\r\n\t\t\tclassName: \"clemson\",\r\n\t\t\tposition: [-1000, -1650],\r\n\t\t\ttarget: 183,\r\n\t\t\tspeed: 0.2\r\n\t\t}, {\r\n\t\t\tclassName: \"clemson\",\r\n\t\t\tposition: [-1650, -1300],\r\n\t\t\ttarget: 180,\r\n\t\t\tspeed: 0.2\r\n\t\t}],\r\n\t\tuboat: {\r\n\t\t\tclassName: \"7c\",\r\n\t\t\ttarget: 110,\r\n\t\t\tspeed: 0,\r\n\t\t\tdepth: 8\r\n\t\t},\r\n\t\tambient: {\r\n\t\t\ttime: 12.5\r\n\t\t}\r\n\t},\r\n\ttest: {\r\n\t\tsea: [{\r\n\t\t\tclassName: \"clemson\",\r\n\t\t\tposition: [0, 0],\r\n\t\t\ttarget: 90,\r\n\t\t\tspeed: 0\r\n\t\t}],\r\n\t\tuboat: {\r\n\t\t\tclassName: \"7c\",\r\n\t\t\ttarget: 91,\r\n\t\t\tspeed: 0,\r\n\t\t\tdepth: 0\r\n\t\t},\r\n\t\tambient: {\r\n\t\t\ttime: 8\r\n\t\t}\r\n\t},\r\n\t\".narvik\": {\r\n\t\tsea: [{\r\n\t\t\tclassName: \"illustrious\",\r\n\t\t\tposition: [-100, -300],\r\n\t\t\ttarget: 180,\r\n\t\t\tspeed: 0.2\r\n\t\t}, {\r\n\t\t\tclassName: \"hipper\",\r\n\t\t\tposition: [0, 100],\r\n\t\t\ttarget: 180,\r\n\t\t\tspeed: 0.2\r\n\t\t}, {\r\n\t\t\tclassName: \"clemson\",\r\n\t\t\tposition: [800, -150],\r\n\t\t\ttarget: 180,\r\n\t\t\tspeed: 0.2\r\n\t\t}],\r\n\t\tuboat: {\r\n\t\t\tclassName: \"7c\",\r\n\t\t\ttarget: 110,\r\n\t\t\tspeed: 0,\r\n\t\t\tdepth: 8\r\n\t\t},\r\n\t\tambient: {\r\n\t\t\ttime: 7\r\n\t\t}\r\n\t}\r\n};\r\n\r\nexport {\r\n\tmissions\r\n}","import { PostProcess } from \"../techniques/postProcess\";\r\nimport { Shader } from \"../gl/shader\";\r\nimport { glm } from \"../util/glm\"\r\nimport { CameraBase } from \"./camera/cameraBase\";\r\n\r\nclass GameRenderer extends PostProcess {\r\n\tconstructor() {\r\n\t\tsuper(Shader.create(\"game\", false));\r\n\t}\r\n\r\n\tbeforeRender() {\r\n\t\tthis.gP.set(this.viewport.getPers());\r\n\t\tthis.gV.set(this.viewport.getView());\r\n\t\tthis.gIVP.set(glm.inverse(this.viewport.getTrans()));\r\n\t\tthis.gCameraWorldPos.set(this.viewport.getCameraPosition());\r\n\t}\r\n\r\n\tprivate gP = Shader.uniform(\"mat4\", \"gP\");\r\n\tprivate gV = Shader.uniform(\"mat4\", \"gV\");\r\n\tprivate gIVP = Shader.uniform(\"mat4\", \"gIVP\");\r\n\tprivate gCameraWorldPos = Shader.uniform(\"vec3\", \"gCameraWorldPos\");\r\n\r\n\tpublic viewport: CameraBase = null;\r\n}\r\n\r\nexport {\r\n\tGameRenderer\r\n}\r\n","import Obj from \"../../object/object\";\r\nimport { Vessel } from \"./vessel\";\r\n\r\nabstract class Component extends Obj {\r\n\tconstructor(private parent: Vessel) {\r\n\t\tsuper();\r\n\t}\r\n\r\n\tgetTrans() {\r\n\t\treturn this.parent.getTrans();\r\n\t}\r\n}\r\n\r\nexport {\r\n\tComponent\r\n}","import { glm } from \"../../util/glm\";\r\nimport Obj from \"../../object/object\";\r\nimport { Viewport, PerspectiveViewport } from \"../../gl/viewport\";\r\nimport { Shader } from \"../../gl/shader\";\r\nimport { TAO, TransformAttrs } from \"../../gl/transformFeedback\";\r\nimport { gl, Renderer } from \"../../renderer/renderer\";\r\n\r\nclass Explode extends Obj {\r\n\tprivate static shader: Shader;\r\n\r\n\tprivate tao: TAO;\r\n\tprivate pos: glm.vec3;\r\n\tprivate speed: number = 2.0;\r\n\tprivate lifetime: number = 14;\r\n\tprivate time: number = 14 - 0.1;\r\n\t\r\n\r\n\tconstructor(position: glm.vec2) {\r\n\t\tsuper();\r\n\t\tExplode.shader || (Explode.shader = Shader.create(\"explode\", false, [\r\n\t\t\t\"WorldPos\", \r\n\t\t\t\"Lifetime\", \r\n\t\t\t\"Velocity\", \r\n\t\t\t\"Acceleration\",\r\n\t\t\t\"GroupId\", \r\n\t\t\t\"InstanceId\", \r\n\t\t\t\"StartTime\"\r\n\t\t]));\r\n\t\tlet attrs = new TransformAttrs([{\r\n\t\t\tname: \"WorldPos\",\r\n\t\t\ttype: gl.FLOAT,\r\n\t\t\tsize: 4\r\n\t\t}, {\r\n\t\t\tname: \"Lifetime\",\r\n\t\t\ttype: gl.FLOAT,\r\n\t\t\tsize: 1\r\n\t\t}, {\r\n\t\t\tname: \"Velocity\",\r\n\t\t\ttype: gl.FLOAT,\r\n\t\t\tsize: 3\r\n\t\t}, {\r\n\t\t\tname: \"Acceleration\",\r\n\t\t\ttype: gl.FLOAT,\r\n\t\t\tsize: 1\r\n\t\t}, {\r\n\t\t\tname: \"GroupId\",\r\n\t\t\ttype: gl.FLOAT,\r\n\t\t\tsize: 1\r\n\t\t}, {\r\n\t\t\tname: \"InstanceId\",\r\n\t\t\ttype: gl.FLOAT,\r\n\t\t\tsize: 1\r\n\t\t}, {\r\n\t\t\tname: \"StartTime\",\r\n\t\t\ttype: gl.FLOAT,\r\n\t\t\tsize: 1\r\n\t\t}]);\r\n\t\tthis.pos = glm.vec3(position, 0.01);\r\n\t\tlet ntracks = 16;\r\n\t\tlet nparticles = 10;\r\n\t\tfor (let i = 0; i != ntracks; ++i) {\r\n\t\t\tfor (let j = 0; j != nparticles; ++j) {\r\n\t\t\t\tattrs.push({\r\n\t\t\t\t\tWorldPos: [1e8, 1e8, 0, 1],\r\n\t\t\t\t\tLifetime: [this.lifetime],\r\n\t\t\t\t\tVelocity: [0, 0, 0],\r\n\t\t\t\t\tAcceleration: [0],\r\n\t\t\t\t\tGroupId: [i],\r\n\t\t\t\t\tInstanceId: [nparticles - j],\r\n\t\t\t\t\tStartTime: [Renderer.time]\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.tao = new TAO(attrs);\r\n\t}\r\n\t\r\n\trender(viewport: Viewport) {\r\n\t\tthis.setBasicUniforms(viewport);\r\n\t\tthis.gDt.set(Renderer.dt);\r\n\t\tthis.gOrigin.set(this.pos);\r\n\t\tthis.gLifetime.set(this.lifetime);\r\n\t\tthis.gSpeed.set(this.speed);\r\n\t\tthis.gIP.set(glm.inverse((<PerspectiveViewport>viewport).getPers()));\r\n\t\tthis.tao.bind();\r\n\t\t\tthis.tao.draw();\r\n\t\tthis.tao.unbind();\r\n\t\tthis.tao.swap();\r\n\t}\r\n\r\n\tcheckRange(): boolean {\r\n\t\tthis.time -= Renderer.dt;\r\n\t\treturn this.time > 0;\r\n\t}\r\n\r\n\tstatic bindShader() {\r\n\t\t!Explode.shader || Explode.shader.use();\r\n\t}\r\n\tstatic unbindShader() {\r\n\t\t!Explode.shader || Explode.shader.unuse();\r\n\t}\r\n\r\n\tprivate gDt = Shader.uniform(\"float\", \"gDt\");\r\n\tprivate gOrigin = Shader.uniform(\"vec3\", \"gOrigin\");\r\n\tprivate gLifetime = Shader.uniform(\"float\", \"gLifetime\");\r\n\tprivate gSpeed = Shader.uniform(\"float\", \"gSpeed\");\r\n\tprivate gIP = Shader.uniform(\"mat4\", \"gIP\");\r\n}\r\n\r\nexport {\r\n\tExplode\r\n}","import { glm } from \"../../util/glm\";\r\nimport { Component } from \"./component\";\r\nimport { Shader } from \"../../gl/shader\";\r\nimport { Vessel } from \"./vessel\";\r\nimport { TransformAttrs, TAO } from \"../../gl/transformFeedback\";\r\nimport { gl, Renderer } from \"../../renderer/renderer\";\r\nimport { Viewport } from \"../../gl/viewport\";\r\nimport { Texture2D } from \"../../gl/texture\";\r\n\r\nclass Foam extends Component {\r\n\tprivate static shader: Shader;\r\n\r\n\tprivate tao: TAO;\r\n\tprivate origin: glm.vec2;\r\n\tprivate lifetime: number;\r\n\tprivate texture: Texture2D = new Texture2D(\"./assets/foam.png\");\r\n\r\n\tconstructor(opts: any, parent: Vessel) {\r\n\t\tsuper(parent);\r\n\t\tFoam.shader = Foam.shader || Shader.create(\"foam\", false, [\r\n\t\t\t\"WorldPos\", \"Offset\", \"Lifetime\"\r\n\t\t]);\r\n\t\tlet attrs = new TransformAttrs([{\r\n\t\t\tname: \"WorldPos\",\r\n\t\t\ttype: gl.FLOAT,\r\n\t\t\tsize: 4\r\n\t\t}, {\r\n\t\t\tname: \"Offset\",\r\n\t\t\ttype: gl.FLOAT,\r\n\t\t\tsize: 2\r\n\t\t}, {\r\n\t\t\tname: \"Lifetime\",\r\n\t\t\ttype: gl.FLOAT,\r\n\t\t\tsize: 1\r\n\t\t}]);\r\n\t\tthis.origin = glm.vec2(opts.position[0], opts.position[1]);\r\n\t\tthis.lifetime = opts.lifetime;\r\n\t\tconsole.log(this.lifetime);\r\n\t\tfor (let i = 0; i != opts.count; ++i) {\r\n\t\t\tattrs.push({\r\n\t\t\t\tWorldPos: [1e8, 1e8, 0, 1],\r\n\t\t\t\tOffset: [-0.7, 0.7],\r\n\t\t\t\tLifetime: [i / opts.count * this.lifetime],\r\n\t\t\t});\r\n\t\t\tattrs.push({\r\n\t\t\t\tWorldPos: [1e8, 1e8, 0, 1],\r\n\t\t\t\tOffset: [0.7, 0.7],\r\n\t\t\t\tLifetime: [i / opts.count * this.lifetime],\r\n\t\t\t});\r\n\t\t\tattrs.push({\r\n\t\t\t\tWorldPos: [1e8, 1e8, 0, 1],\r\n\t\t\t\tOffset: [-0.7, -0.7],\r\n\t\t\t\tLifetime: [i / opts.count * this.lifetime],\r\n\t\t\t});\r\n\t\t\tattrs.push({\r\n\t\t\t\tWorldPos: [1e8, 1e8, 0, 1],\r\n\t\t\t\tOffset: [0.7, 0.7],\r\n\t\t\t\tLifetime: [i / opts.count * this.lifetime],\r\n\t\t\t});\r\n\t\t\tattrs.push({\r\n\t\t\t\tWorldPos: [1e8, 1e8, 0, 1],\r\n\t\t\t\tOffset: [-0.7, -0.7],\r\n\t\t\t\tLifetime: [i / opts.count * this.lifetime],\r\n\t\t\t});\r\n\t\t\tattrs.push({\r\n\t\t\t\tWorldPos: [1e8, 1e8, 0, 1],\r\n\t\t\t\tOffset: [0.7, -0.7],\r\n\t\t\t\tLifetime: [i / opts.count * this.lifetime],\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis.tao = new TAO(attrs);\r\n\t}\r\n\r\n\trender(viewport: Viewport) {\r\n\t\tthis.setBasicUniforms(viewport);\r\n\t\tthis.gDt.set(Renderer.dt);\r\n\t\tthis.gOrigin.set(this.origin);\r\n\t\tthis.gLifetime.set(this.lifetime);\r\n\t\tlet tex = Texture2D.genChannel();\r\n\t\tgl.activeTexture(gl.TEXTURE0 + tex);\r\n\t\tthis.gOutline.set(tex);\r\n\t\tgl.bindTexture(gl.TEXTURE_2D, this.texture.handle);\r\n\t\tthis.tao.bind();\r\n\t\t\tthis.tao.draw(gl.TRIANGLES);\r\n\t\tthis.tao.unbind();\r\n\t\tgl.bindTexture(gl.TEXTURE_2D, null);\r\n\t\tTexture2D.restoreChannel(tex);\r\n\t\tthis.tao.swap();\r\n\t}\r\n\r\n\tstatic bindShader() {\r\n\t\t!Foam.shader || Foam.shader.use();\r\n\t}\r\n\tstatic unbindShader() {\r\n\t\t!Foam.shader || Foam.shader.unuse();\r\n\t}\r\n\r\n\tprivate gDt = Shader.uniform(\"float\", \"gDt\");\r\n\tprivate gLifetime = Shader.uniform(\"float\", \"gLifetime\");\r\n\tprivate gOrigin = Shader.uniform(\"vec2\", \"gOrigin\");\r\n\tprivate gOutline = Shader.uniform(\"int\", \"gOutline\");\r\n}\r\n\r\nexport {\r\n\tFoam\r\n}","import { glm } from \"../../util/glm\";\r\nimport { Viewport } from \"../../gl/viewport\";\r\nimport { TAO, TransformAttrs } from \"../../gl/transformFeedback\";\r\nimport { Shader } from \"../../gl/shader\";\r\nimport { gl, Renderer } from \"../../renderer/renderer\";\r\nimport { Vessel } from \"./vessel\";\r\nimport { Component } from \"./component\";\r\nimport { Texture, Texture2D } from \"../../gl/texture\";\r\n\r\nclass Smoke extends Component {\r\n\tprivate static shader: Shader;\r\n\r\n\tprivate tao: TAO;\r\n\tprivate origin: glm.vec3;\r\n\tprivate velocity: glm.vec3;\r\n\tprivate up: glm.vec3;\r\n\tprivate color: glm.vec3;\r\n\tprivate scatter: number;\r\n\tprivate lifetime: number;\r\n\tprivate opacity: number;\r\n\tprivate texture: Texture2D;\r\n\r\n\tconstructor(opts: any, parent: Vessel) {\r\n\t\tsuper(parent);\r\n\t\tSmoke.shader = Smoke.shader || Shader.create(\"smoke\", false, [\r\n\t\t\t\"WorldPos\", \"Lifetime\", \"Velocity\"\r\n\t\t]);\r\n\t\t// console.log(opts);\r\n\t\tlet attrs = new TransformAttrs([{\r\n\t\t\tname: \"WorldPos\",\r\n\t\t\ttype: gl.FLOAT,\r\n\t\t\tsize: 4\r\n\t\t}, {\r\n\t\t\tname: \"Lifetime\",\r\n\t\t\ttype: gl.FLOAT,\r\n\t\t\tsize: 1\r\n\t\t}, {\r\n\t\t\tname: \"Velocity\",\r\n\t\t\ttype: gl.FLOAT,\r\n\t\t\tsize: 3\r\n\t\t}]);\r\n\t\tthis.origin = glm.vec3(opts.position[0], opts.position[1], opts.position[2]);\r\n\t\tthis.lifetime = opts.lifetime;\r\n\t\tthis.velocity = parent.getTrans()[\"*\"](\r\n\t\t\t\tglm.vec4(opts.velocity[0], opts.velocity[1], opts.velocity[2], 0)).xyz;\r\n\t\tthis.up = glm.vec3(opts.up[0], opts.up[1], opts.up[2]);\r\n\t\tthis.scatter = opts.scatter;\r\n\t\tthis.color = glm.vec3(opts.color[0], opts.color[1], opts.color[2])[\"/\"](255);\r\n\t\tthis.opacity = opts.opacity;\r\n\t\tthis.texture = new Texture2D(\"./assets/\" + opts.texture + \".png\");\r\n\t\tfor (let i = 0; i != opts.count; ++i) {\r\n\t\t\tattrs.push({\r\n\t\t\t\tWorldPos: [1e8, 1e8, 0, 1],\r\n\t\t\t\tLifetime: [i / opts.count * this.lifetime],\r\n\t\t\t\tVelocity: opts.velocity\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis.tao = new TAO(attrs);\r\n\t}\r\n\r\n\trender(viewport: Viewport) {\r\n\t\tthis.setBasicUniforms(viewport);\r\n\t\tthis.gDt.set(Renderer.dt);\r\n\t\tthis.gOrigin.set(this.origin);\r\n\t\tthis.gLifetime.set(this.lifetime);\r\n\t\tthis.gScatter.set(this.scatter);\r\n\t\tthis.gVelocity.set(this.velocity);\r\n\t\tthis.gColor.set(this.color);\r\n\t\tthis.gUp.set(this.up);\r\n\t\tthis.gOpacity.set(this.opacity);\r\n\t\tlet tex = Texture2D.genChannel();\r\n\t\t// this.texture.use(\"Smoke\");\r\n\t\tgl.activeTexture(gl.TEXTURE0 + tex);\r\n\t\tthis.gSmoke.set(tex);\r\n\t\tgl.bindTexture(gl.TEXTURE_2D, this.texture.handle);\r\n\t\tthis.tao.bind();\r\n\t\t\tthis.tao.draw();\r\n\t\tthis.tao.unbind();\r\n\t\tgl.bindTexture(gl.TEXTURE_2D, null);\r\n\t\tTexture2D.restoreChannel(tex);\r\n\t\tthis.tao.swap();\r\n\t}\r\n\t\r\n\tstatic bindShader() {\r\n\t\t!Smoke.shader || Smoke.shader.use();\r\n\t}\r\n\tstatic unbindShader() {\r\n\t\t!Smoke.shader || Smoke.shader.unuse();\r\n\t}\r\n\r\n\tprivate gDt = Shader.uniform(\"float\", \"gDt\");\r\n\tprivate gOrigin = Shader.uniform(\"vec3\", \"gOrigin\");\r\n\tprivate gVelocity = Shader.uniform(\"vec3\", \"gVelocity\");\r\n\tprivate gUp = Shader.uniform(\"vec3\", \"gUp\");\r\n\tprivate gLifetime = Shader.uniform(\"float\", \"gLifetime\");\r\n\tprivate gScatter = Shader.uniform(\"float\", \"gScatter\");\r\n\tprivate gSmoke = Shader.uniform(\"int\", \"gSmoke\");\r\n\tprivate gColor = Shader.uniform(\"vec3\", \"gColor\");\r\n\tprivate gOpacity = Shader.uniform(\"float\", \"gOpacity\");\r\n}\r\n\r\nexport {\r\n\tSmoke\r\n}","import { Vessel, m2screen } from \"./vessel\";\r\nimport { glm } from \"../../util/glm\"\r\nimport { Renderer } from \"../../renderer/renderer\";\r\n\r\ntype SpeedMode = \"stop\" | \"slowFw\" | \"oneThirdFw\" | \"normalFw\" | \"fullFw\" |\r\n\t\"extraFw\" | \"slowBw\" | \"oneThirdBw\" | \"normalBw\" | \"extraBw\"\r\n\r\ntype RudderMode = \"fullLw\" | \"fullRw\" | \"reset\"\r\n\r\ntype DiveMode = \"Uw\" | \"Dw\" | \"extraUw\" | \"extraDw\" | \"keep\" | \"Pw\"\r\n\r\nclass Submarine extends Vessel {\r\n\tprivate fdepth: number = 0;\r\n\tprivate fdiveSpeed: number = 0;\r\n\tprivate fmaxDiveSpeed: number;\r\n\tprivate fdiveAccelerate: number;\r\n\t\r\n\tprivate fdiveState: number = 0;\r\n\tprivate fdiveStop: boolean = false;\r\n\r\n\tprivate frudderState: number = 0;\r\n\tprivate frudderMiddle: boolean = false;\r\n\r\n\tprivate ftorpedoLauncher: any [];\r\n\r\n\tget torpedoLauncher(): any [] {\r\n\t\treturn this.ftorpedoLauncher;\r\n\t}\r\n\r\n\tget diveSpeed(): number {\r\n\t\treturn this.fdiveSpeed / m2screen;\r\n\t}\r\n\r\n\tset diveSpeed(meters: number) {\r\n\t\tthis.fdiveSpeed = m2screen * meters;\r\n\t\tif (Math.abs(this.fdiveSpeed) > this.fmaxDiveSpeed) {\r\n\t\t\tthis.fdiveSpeed = Math.sign(this.fdiveSpeed) * this.fmaxDiveSpeed;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected processProperty(data: { [key: string]: any}) {\r\n\t\tsuper.processProperty(data);\r\n\t\tthis.fmaxDiveSpeed = data.dive.maxSpeed * m2screen;\r\n\t\tthis.fdiveAccelerate = data.dive.accelerate;\r\n\t\tthis.ftorpedoLauncher = data.torpedo.launchers;\r\n\t}\r\n\r\n\tprotected diveStop() {\r\n\t\tif (this.fdiveSpeed != 0) {\r\n\t\t\tlet sgn = Math.sign(this.fdiveSpeed);\r\n\t\t\tthis.diveSpeed -= sgn * Renderer.dt * this.fdiveAccelerate;\r\n\t\t\tif (Math.sign(this.fdiveSpeed) != sgn) {\r\n\t\t\t\tthis.fdiveSpeed = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected diveUp() {\r\n\t\tthis.diveSpeed -= Renderer.dt * this.fdiveAccelerate;\r\n\t}\r\n\r\n\tprotected diveDown() {\r\n\t\tthis.diveSpeed += Renderer.dt * this.fdiveAccelerate;\r\n\t}\r\n\r\n\tprotected updateState() {\r\n\t\tif (this.frudderMiddle) {\r\n\t\t\tthis.rudderMiddle();\r\n\t\t} else switch (this.frudderState) {\r\n\t\t\tcase 3: case 2: this.rudderLeft(); break;\r\n\t\t\tcase 1: case 4: this.rudderRight(); break;\r\n\t\t}\r\n\t\tif (this.fdiveStop) {\r\n\t\t\tthis.diveStop();\r\n\t\t} else switch (this.fdiveState) {\r\n\t\t\tcase 3: case 2: this.diveUp(); break;\r\n\t\t\tcase 1: case 4: this.diveDown(); break;\r\n\t\t}\r\n\t\tsuper.updateState();\r\n\t}\r\n\r\n\tprotected updatePosition() {\r\n\t\tif (this.fdiveSpeed || this.fspeed) {\r\n\t\t\tlet diff = glm.vec3(this.fspeedVec[\"*\"](this.fspeed * Renderer.dt), -this.fdiveSpeed * Renderer.dt);\r\n\t\t\tthis.translate(diff);\r\n\t\t\tif (this.position.z > 0) {\r\n\t\t\t\tthis.fdiveSpeed = 0;\r\n\t\t\t\tthis.position.z = 0;\r\n\t\t\t}\r\n\t\t\tif (this.camera) {\r\n\t\t\t\tthis.camera.position = this.camera.position[\"+\"](diff);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\trudderSignal(signal: number) {\r\n\t\tif (signal) {\r\n\t\t\tswitch (this.frudderState) {\r\n\t\t\t\tcase 0: this.frudderState = signal == 1 ? 1 : 2; break;\r\n\t\t\t\tcase 1: this.frudderState = signal == 1 ? 0 : 3; break;\r\n\t\t\t\tcase 2: this.frudderState = signal == 1 ? 4 : 0; break;\r\n\t\t\t\tcase 3: case 4: this.frudderState = signal == 1 ? 2 : 1; break;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.frudderMiddle = !this.frudderMiddle;\r\n\t\t}\r\n\t}\r\n\r\n\tdiveSignal(signal: number) {\r\n\t\tif (signal) {\r\n\t\t\tswitch (this.fdiveState) {\r\n\t\t\t\tcase 0: this.fdiveState = signal == 1 ? 1 : 2; break;\r\n\t\t\t\tcase 1: this.fdiveState = signal == 1 ? 0 : 3; break;\r\n\t\t\t\tcase 2: this.fdiveState = signal == 1 ? 4 : 0; break;\r\n\t\t\t\tcase 3: case 4: this.fdiveState = signal == 1 ? 2 : 1; break;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.fdiveStop = !this.fdiveStop;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport {\r\n\tSubmarine\r\n}\r\n","import { glm } from \"../../util/glm\";\r\nimport { Vessel } from \"./vessel\";\r\nimport { Renderer } from \"../../renderer/renderer\";\r\n\r\nclass Torpedo extends Vessel {\r\n\tprivate flifeTime: number;\r\n\r\n\tset orient(velocity: glm.vec2) {\r\n\t\tthis.fspeedVec = velocity;\r\n\t\tthis.rotate(glm.vec3(0, 0, - Math.PI*.5 + Math.atan2(velocity.y, velocity.x)));\r\n\t}\r\n\r\n\tprotected processProperty(data: { [key: string]: any}) {\r\n\t\tsuper.processProperty(data);\r\n\t\tthis.flifeTime = data.lifetime;\r\n\t}\r\n\r\n\tprotected updateState() {\r\n\t\tsuper.updateState();\r\n\t\tthis.flifeTime -= Renderer.dt;\r\n\t}\r\n\r\n\tprotected jitter() {\r\n\t\t//\r\n\t}\r\n\r\n\tget lifetime(): number {\r\n\t\treturn this.flifeTime;\r\n\t}\r\n\r\n\tcheckRange(): boolean {\r\n\t\tthis.flifeTime -= Renderer.dt;\r\n\t\treturn this.flifeTime > 0;\r\n\t}\r\n}\r\n\r\nexport {\r\n\tTorpedo\r\n}","import Obj from \"../../object/object\";\r\nimport Model from \"../../gl/model\";\r\nimport { Viewport } from \"../../gl/viewport\";\r\nimport { glm } from \"../../util/glm\"\r\nimport { CameraBase } from \"../camera/cameraBase\";\r\nimport xhr from \"../../util/xhr\";\r\nimport { Shader } from \"../../gl/shader\";\r\nimport { Smoke } from \"./smoke\";\r\nimport { Renderer } from \"../../renderer/renderer\";\r\nimport { Foam } from \"./foam\";\r\nimport { VAO, VertexAttrs } from \"../../gl/vertexAttrs\";\r\n\r\nconst m2screen = .1 * .5;\r\nconst knots2mpers = 0.514444;\r\n\r\nconst EPS = .01;\r\n\r\nabstract class VesselBase extends Obj {\r\n\t// protected speed = glm.vec2(1, 0);\r\n\tprotected fmaxSpeed: number;\r\n\tprotected fspeed: number = 0;\r\n\tprotected fspeedVec = glm.vec2(0, 1);\r\n\tprotected fspeedAngle: number = glm.radians(0);\r\n\tprotected frudderOrient: number = 0;\r\n\tprotected fmaxRudderOrient: number;\r\n\tprotected frudderSpeed: number;\r\n\r\n\tprotected fdtSpeed: number = -1;\r\n\tprotected foriginalSpeed: number = 0;\r\n\tprotected ftargetSpeed: number = 0;\r\n\r\n\tprotected fjitterAngle: number;\r\n\tprotected fjitterCycle: number;\r\n\r\n\tprotected camera: CameraBase = null;\r\n\r\n\tget speedAngle(): number {\r\n\t\treturn glm.degree(this.fspeedAngle);\r\n\t}\r\n\tset speedAngle(degree: number) {\r\n\t\tthis.fspeedAngle = glm.radians(degree);\r\n\t\tthis.fspeedVec = glm.vec2(Math.cos(this.fspeedAngle), Math.sin(this.fspeedAngle));\r\n\t\tthis.rotateIdentity();\r\n\t\tthis.rotate(glm.vec3(0, 0, glm.radians(degree - 90)));\r\n\t}\r\n\r\n\tset speed(knots: number) {\r\n\t\tthis.fspeed = m2screen * knots * knots2mpers;\r\n\t}\r\n\tget speed(): number {\r\n\t\treturn this.fspeed / knots2mpers / m2screen;\r\n\t}\r\n\r\n\tset initSpeed(perc: number) {\r\n\t\tthis.foriginalSpeed = this.ftargetSpeed = this.fspeed = perc * this.fmaxSpeed;\r\n\t}\r\n\r\n\tset targetSpeed(perc: number) {\r\n\t\tthis.fdtSpeed = 0;\r\n\t\tthis.foriginalSpeed = this.fspeed;\r\n\t\tthis.ftargetSpeed = perc * this.fmaxSpeed;\r\n\t}\r\n\r\n\tset rudderOrient(orient: number) {\r\n\t\tthis.frudderOrient = orient;\r\n\t\tif (Math.abs(this.frudderOrient) > this.fmaxRudderOrient) {\r\n\t\t\tthis.frudderOrient = Math.sign(this.frudderOrient) * this.fmaxRudderOrient;\r\n\t\t}\r\n\t}\r\n\r\n\tget rudderOrient(): number {\r\n\t\treturn this.frudderOrient;\r\n\t}\r\n\r\n\trudderRight() {\r\n\t\tthis.rudderOrient += Renderer.dt * this.frudderSpeed;\r\n\t}\r\n\r\n\trudderLeft() {\r\n\t\tthis.rudderOrient -= Renderer.dt * this.frudderSpeed;\r\n\t}\r\n\r\n\trudderMiddle() {\r\n\t\tif (this.frudderOrient != 0) {\r\n\t\t\tlet sgn = Math.sign(this.frudderOrient);\r\n\t\t\tthis.rudderOrient -= sgn * Renderer.dt * this.frudderSpeed;\r\n\t\t\tif (Math.sign(this.frudderOrient) != sgn) {\r\n\t\t\t\tthis.frudderOrient = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected updateState() {\r\n\t\tif (this.fdtSpeed >= 0) {\r\n\t\t\t// console.log(this.fdtSpeed);\r\n\t\t\tthis.fdtSpeed += Renderer.dt;\r\n\t\t\tthis.fspeed = (this.ftargetSpeed - this.foriginalSpeed) * \r\n\t\t\t\tMath.tanh(this.fdtSpeed / 5. * Math.sqrt(Math.abs(this.ftargetSpeed - this.foriginalSpeed))) +\r\n\t\t\t\t\tthis.foriginalSpeed;\r\n\t\t\tif (Math.abs(this.fspeed - this.ftargetSpeed) < EPS) {\r\n\t\t\t\tthis.fspeed = this.ftargetSpeed;\r\n\t\t\t\tthis.fdtSpeed = -1;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.frudderOrient && this.fspeed) {\r\n\t\t\tlet theta = - this.fspeed / this.fmaxSpeed * .1 * this.frudderOrient * Renderer.dt;\r\n\t\t\tlet sinv = Math.sin(theta);\r\n\t\t\tlet cosv = Math.cos(theta);\r\n\t\t\tthis.fspeedVec = glm.vec2(\r\n\t\t\t\tthis.fspeedVec.x * cosv - this.fspeedVec.y * sinv,\r\n\t\t\t\tthis.fspeedVec.x * sinv + this.fspeedVec.y * cosv\r\n\t\t\t);\r\n\t\t\tthis.rotate(glm.vec3(0, 0, theta));\r\n\t\t}\r\n\t}\r\n\r\n\tprotected updatePosition() {\r\n\t\tif (this.fspeed) {\r\n\t\t\tlet diff = glm.vec3(this.fspeedVec[\"*\"](this.fspeed * Renderer.dt), 0);\r\n\t\t\tthis.translate(diff);\r\n\t\t\tif (this.camera) {\r\n\t\t\t\tthis.camera.position = this.camera.position[\"+\"](diff);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected jitter() {\r\n\t\tthis.rotateIdentity(glm.vec3(1, 0, 1));\r\n\t\tthis.rotate(glm.vec3(0, Math.sin(Renderer.time * this.fjitterCycle) * this.fjitterAngle, 0));\r\n\t}\r\n\r\n\tupdate() {\r\n\t\t// console.log(this);\r\n\t\tthis.updateState();\r\n\t\tthis.jitter();\r\n\t\tthis.updatePosition();\r\n\t}\r\n\t\r\n\ttie(camera: CameraBase) {\r\n\t\tthis.camera = camera;\r\n\t}\r\n}\r\n\r\nclass Vessel extends VesselBase {\r\n\tprivate static modelPath = \"./assets/\";\r\n\tprivate static shader: Shader;\r\n\tprivate static wrapper: Shader;\r\n\tprivate static properties: { [key: string]: any } = {};\r\n\tprivate model: Model;\r\n\r\n\t// private wao: VAO;\r\n\r\n\tpublic smokes: Smoke[] = [];\r\n\tpublic collider: number[] = [];\r\n\tpublic foam: Foam;\r\n\t\r\n\tconstructor(name: string)\r\n\tconstructor(name: string, callback: (v: Vessel) => void);\r\n\tconstructor(name: string, callback?: (v: Vessel) => void) {\r\n\t\tsuper();\r\n\r\n\t\tthis.scale(.5);\r\n\t\tlet self = this;\r\n\t\tif (name in Vessel.properties) {\r\n\t\t\tself.processProperty(Vessel.properties[name]);\r\n\t\t} else {\r\n\t\t\txhr.getAsync(Vessel.modelPath + name + \"/property.json\", \"text\", (err: any, data: any) => {\r\n\t\t\t\tdata = JSON.parse(data);\r\n\t\t\t\tVessel.properties[name] = data;\r\n\t\t\t\tself.processProperty(data);\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis.foam = new Foam({\r\n\t\t\tlifetime: 5,\r\n\t\t\tcount: 50,\r\n\t\t\tposition: [0, -3.1]\r\n\t\t}, this);\r\n\t\tVessel.shader = Vessel.shader || Shader.create(\"vessel\", false);\r\n\t\tVessel.wrapper = Vessel.wrapper || Shader.create(\"wrapper\", false);\r\n\t\tif (callback == undefined) {\r\n\t\t\tthis.model = Model.create(Vessel.modelPath + name + \"/\", name + \".json\");\r\n\t\t} else {\r\n\t\t\tModel.create(Vessel.modelPath + name + \"/\", name + \".json\", (v: Model) => {\r\n\t\t\t\tself.model = v;\r\n\t\t\t\tcallback(self);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprotected processProperty(data: { [key: string]: any}) {\r\n\t\tthis.fmaxSpeed = m2screen * knots2mpers * data.maxSpeed;\r\n\t\tif (\"jitter\" in data) {\r\n\t\t\tthis.fjitterAngle = glm.radians(data.jitter.angle);\r\n\t\t\tthis.fjitterCycle = Math.PI * 2 / data.jitter.cycle;\r\n\t\t}\r\n\t\tif (\"rudder\" in data) {\r\n\t\t\tthis.fmaxRudderOrient = data.rudder.maxOrient;\r\n\t\t\tthis.frudderSpeed = data.rudder.speed;\r\n\t\t}\r\n\t\tif (\"particleGenerator\" in data) {\r\n\t\t\tfor (let emitter of data.particleGenerator) {\r\n\t\t\t\tthis.smokes.push(new Smoke(emitter, this));\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (\"collider\" in data) {\r\n\t\t\tthis.collider = data.collider;\r\n\t\t\t// let attrs = new VertexAttrs([\"pos3\"]);\r\n\t\t\t// for (let i = 0; i < data.collider.length - 2; i += 2) {\r\n\t\t\t// \tattrs.push({ pos3: [\r\n\t\t\t// \t\tdata.collider[i], \r\n\t\t\t// \t\tdata.collider[i + 1],\r\n\t\t\t// \t\t0.25\r\n\t\t\t// \t] });\r\n\t\t\t// \tattrs.push({ pos3: [\r\n\t\t\t// \t\tdata.collider[i], \r\n\t\t\t// \t\tdata.collider[i + 1],\r\n\t\t\t// \t\t-0.25\r\n\t\t\t// \t] });\r\n\t\t\t// \tattrs.push({ pos3: [\r\n\t\t\t// \t\tdata.collider[i + 2], \r\n\t\t\t// \t\tdata.collider[i + 3],\r\n\t\t\t// \t\t0.25\r\n\t\t\t// \t] });\r\n\r\n\t\t\t// \tattrs.push({ pos3: [\r\n\t\t\t// \t\tdata.collider[i], \r\n\t\t\t// \t\tdata.collider[i + 1],\r\n\t\t\t// \t\t-0.25\r\n\t\t\t// \t] });\r\n\t\t\t// \tattrs.push({ pos3: [\r\n\t\t\t// \t\tdata.collider[i + 2], \r\n\t\t\t// \t\tdata.collider[i + 3],\r\n\t\t\t// \t\t0.25\r\n\t\t\t// \t] });\r\n\t\t\t// \tattrs.push({ pos3: [\r\n\t\t\t// \t\tdata.collider[i + 2], \r\n\t\t\t// \t\tdata.collider[i + 3],\r\n\t\t\t// \t\t-0.25\r\n\t\t\t// \t] });\r\n\r\n\t\t\t// \tattrs.push({ pos3: [\r\n\t\t\t// \t\t-data.collider[i], \r\n\t\t\t// \t\tdata.collider[i + 1],\r\n\t\t\t// \t\t0.25\r\n\t\t\t// \t] });\r\n\t\t\t// \tattrs.push({ pos3: [\r\n\t\t\t// \t\t-data.collider[i], \r\n\t\t\t// \t\tdata.collider[i + 1],\r\n\t\t\t// \t\t-0.25\r\n\t\t\t// \t] });\r\n\t\t\t// \tattrs.push({ pos3: [\r\n\t\t\t// \t\t-data.collider[i + 2], \r\n\t\t\t// \t\tdata.collider[i + 3],\r\n\t\t\t// \t\t0.25\r\n\t\t\t// \t] });\r\n\r\n\t\t\t// \tattrs.push({ pos3: [\r\n\t\t\t// \t\t-data.collider[i], \r\n\t\t\t// \t\tdata.collider[i + 1],\r\n\t\t\t// \t\t-0.25\r\n\t\t\t// \t] });\r\n\t\t\t// \tattrs.push({ pos3: [\r\n\t\t\t// \t\t-data.collider[i + 2], \r\n\t\t\t// \t\tdata.collider[i + 3],\r\n\t\t\t// \t\t0.25\r\n\t\t\t// \t] });\r\n\t\t\t// \tattrs.push({ pos3: [\r\n\t\t\t// \t\t-data.collider[i + 2], \r\n\t\t\t// \t\tdata.collider[i + 3],\r\n\t\t\t// \t\t-0.25\r\n\t\t\t// \t] });\r\n\t\t\t// }\r\n\t\t\t// this.wao = new VAO(attrs);\r\n\t\t}\r\n\t}\r\n\r\n\trender(viewport: Viewport) {\r\n\t\tthis.setBasicUniforms(viewport);\r\n\t\tthis.model.render();\r\n\t\t// Vessel.unbindShader();\r\n\t\t// !Vessel.wrapper || (() => {\r\n\t\t// \tVessel.wrapper.use();\r\n\t\t// \tthis.setBasicUniforms(viewport);\r\n\t\t// \tif (this.wao) {\r\n\t\t// \t\tthis.wao.bind();\r\n\t\t// \t\t\tthis.wao.draw();\r\n\t\t// \t\tthis.wao.unbind();\r\n\t\t// \t}\r\n\t\t// \tVessel.wrapper.unuse();\r\n\t\t// }) ();\r\n\t\t// Vessel.bindShader();\r\n\t}\r\n\t\r\n\tstatic bindShader() {\r\n\t\t!Vessel.shader || Vessel.shader.use();\r\n\t}\r\n\tstatic unbindShader() {\r\n\t\t!Vessel.shader || Vessel.shader.unuse();\r\n\t}\r\n}\r\n\r\nexport {\r\n\tknots2mpers,\r\n\tm2screen,\r\n\tVessel\r\n}\r\n","import { gl, gl2 } from \"../renderer/renderer\"\r\n\r\nclass BufferBase {\r\n\tconstructor(public readonly handle: any)\r\n\t{\r\n\t}\r\n}\r\n\r\nclass VBO extends BufferBase {\r\n\tconstructor() {\r\n\t\tsuper(gl.createBuffer());\r\n\t}\r\n\tbind() {\r\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this.handle);\r\n\t}\r\n\tunbind() {\r\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, null);\r\n\t}\r\n\tdata(data: any[]) {\r\n\t\tgl.bufferData(gl.ARRAY_BUFFER, new Float32Array(data), gl.STATIC_DRAW);\r\n\t}\r\n}\r\n\r\nclass EBO extends BufferBase {\r\n\tconstructor() {\r\n\t\tsuper(gl.createBuffer());\r\n\t}\r\n\tbind() {\r\n\t\tgl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.handle);\r\n\t}\r\n\tunbind() {\r\n\t\tgl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, null);\r\n\t}\r\n\tdata(data: any[]) {\r\n\t\tgl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint32Array(data), gl.STATIC_DRAW);\r\n\t}\r\n}\r\n\r\nclass FBO extends BufferBase {\r\n\tconstructor() {\r\n\t\tsuper(gl.createFramebuffer());\r\n\t}\r\n\tbind() {\r\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, this.handle);\r\n\t}\r\n\tunbind() {\r\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n\t}\r\n\tsetRenderBuffer(rbo: RBO, channel: number) {\r\n\t\tgl.framebufferRenderbuffer(gl.FRAMEBUFFER, channel, gl.RENDERBUFFER, rbo);\r\n\t}\r\n\tcheck() {\r\n\t\tswitch (gl.checkFramebufferStatus(gl.FRAMEBUFFER)) {\r\n\t\t\tcase gl.FRAMEBUFFER_COMPLETE: break;\r\n\t\t\tcase gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT: \r\n\t\t\t\tthrow \"framebuffer incomplete attachment.\";\r\n\t\t\tcase gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:\r\n\t\t\t\tthrow \"framebuffer incomplete missing attachment.\";\r\n\t\t\tcase gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:\r\n\t\t\t\tthrow \"framebuffer incomplete dimensions.\";\r\n\t\t\tcase gl.FRAMEBUFFER_UNSUPPORTED:\r\n\t\t\t\tthrow \"framebuffer unsupported.\";\r\n\t\t\tdefault: \r\n\t\t\t\tthrow \"unknown framebuffer error.\";\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass RBO extends BufferBase {\r\n\tconstructor() {\r\n\t\tsuper(gl.createRenderbuffer());\r\n\t}\r\n\tbind() {\r\n\t\tgl.bindRenderbuffer(gl.RENDERBUFFER, this.handle);\r\n\t}\r\n\tunbind() {\r\n\t\tgl.bindRenderbuffer(gl.RENDERBUFFER, null);\r\n\t}\r\n}\r\n\r\nclass PDBO extends BufferBase {\r\n\tconstructor() {\r\n\t\tif (!gl2) {\r\n\t\t\tthrow \"webgl 2.0 is not supported\";\r\n\t\t}\r\n\t\tsuper(gl2.createBuffer());\r\n\t}\r\n\tbind() {\r\n\t\tgl2.bindBuffer(gl2.PIXEL_PACK_BUFFER, this.handle);\r\n\t}\r\n\tunbind() {\r\n\t\tgl2.bindBuffer(gl2.PIXEL_PACK_BUFFER, null);\r\n\t}\r\n\tdata(bytelength: number) {\r\n\t\tgl.bufferData(gl2.PIXEL_PACK_BUFFER, bytelength, gl2.STATIC_READ);\r\n\t}\r\n}\r\n\r\nclass PUBO extends BufferBase {\r\n\tconstructor() {\r\n\t\tif (!gl2) {\r\n\t\t\tthrow \"webgl 2.0 is not supported\";\r\n\t\t}\r\n\t\tsuper(gl2.createBuffer());\r\n\t}\r\n\tbind() {\r\n\t\tgl2.bindBuffer(gl2.PIXEL_UNPACK_BUFFER, this.handle);\r\n\t}\r\n\tunbind() {\r\n\t\tgl2.bindBuffer(gl2.PIXEL_UNPACK_BUFFER, null);\r\n\t}\r\n}\r\n\r\nclass TBO {\r\n\tprivate handle1;\r\n\tprivate handle0;\r\n\r\n\tconstructor() {\r\n\t\tif (!gl2) {\r\n\t\t\tthrow \"webgl 2.0 required.\";\r\n\t\t}\r\n\t\tthis.handle0 = gl2.createBuffer();\r\n\t\tthis.handle1 = gl2.createBuffer();\r\n\t}\r\n\tbind() {\r\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this.handle0);\r\n\t\tgl2.bindBufferBase(gl2.TRANSFORM_FEEDBACK_BUFFER, 0, this.handle1);\r\n\t}\r\n\tunbind() {\r\n\t\tgl2.bindBufferBase(gl2.TRANSFORM_FEEDBACK_BUFFER, 0, null);\r\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, null);\r\n\t}\r\n\tdata(data: any[]) {\r\n\t\tgl.bufferData(gl.ARRAY_BUFFER, 4 * data.length, gl2.DYNAMIC_COPY);\r\n\t\tthis.unbind();\r\n\t\tthis.swap();\r\n\t\tthis.bind();\r\n\t\tgl.bufferData(gl.ARRAY_BUFFER, new Float32Array(data), gl2.DYNAMIC_COPY);\r\n\t}\r\n\tswap() {\r\n\t\tlet h = this.handle1; this.handle1 = this.handle0; this.handle0 = h;\r\n\t}\r\n\tget handle(): any {\r\n\t\treturn this.handle0;\r\n\t}\r\n}\r\n\r\nexport {\r\n\tVBO,\r\n\tEBO,\r\n\tFBO,\r\n\tRBO,\r\n\tTBO,\r\n\tPUBO,\r\n\tPDBO\r\n}\r\n","import { ulist, ulist_elem } from \"../util/ulist\";\r\nimport { Shader, Uniform, UniformType } from \"./shader\";\r\n\r\nclass Communicator {\r\n\tpublic static counters: { [key: string]: Uniform } = {};\r\n\r\n\tprotected data: { [key: string]: { data: any, uniform: Uniform, set?: any } } = {};\r\n\r\n\tconstructor(public readonly type: string, public readonly array: boolean = true) {\r\n\t\tif (array) {\r\n\t\t\tif (!(type in Communicator.counters)) {\r\n\t\t\t\tCommunicator.counters[type] = Shader.uniform(\"int\", \"g\" + type + \"_count\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tinvoke(index: number): boolean {\r\n\t\tif (this.array) {\r\n\t\t\tfor (let key in this.data) {\r\n\t\t\t\t// console.log(key, this.data[key].data);\r\n\t\t\t\tthis.data[key].uniform.subscribe(index).set(\"set\" in \r\n\t\t\t\t\tthis.data[key] ? this.data[key].set(this.data[key].data) : \r\n\t\t\t\t\tthis.data[key].data);\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t} else {\r\n\t\t\tfor (let key in this.data) {\r\n\t\t\t\t// console.log(key, this.data[key].data);\r\n\t\t\t\tthis.data[key].uniform.set(\"set\" in \r\n\t\t\t\t\tthis.data[key] ? this.data[key].set(this.data[key].data) : \r\n\t\t\t\t\tthis.data[key].data);\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tset(key: string, value: any) {\r\n\t\tif (key in this.data) {\r\n\t\t\tthis.data[key].data = value;\r\n\t\t} else {\r\n\t\t\tthrow \"communicator key does not match any: \" + key;\r\n\t\t}\r\n\t}\r\n\tget(key: string) {\r\n\t\tif (key in this.data) {\r\n\t\t\treturn this.data[key].data;\r\n\t\t} else {\r\n\t\t\tthrow \"communicator key does not match any: \" + key;\r\n\t\t}\r\n\t}\r\n\tinit(uniforms: { [name: string]: { \r\n\t\t\ttype: UniformType, \r\n\t\t\tinit: any, \r\n\t\t\tset?: (value: any) => any } \r\n\t}) {\r\n\t\tif (this.array) {\r\n\t\t\tfor (let name in uniforms) {\r\n\t\t\t\tif (\"set\" in uniforms[name]) {\r\n\t\t\t\t\tthis.data[name] = {\r\n\t\t\t\t\t\tdata: uniforms[name].init, \r\n\t\t\t\t\t\tset: uniforms[name].set,\r\n\t\t\t\t\t\tuniform: Shader.uniform(uniforms[name].type, \"g\" + this.type + \"_\" + name + \"[]\")\r\n\t\t\t\t\t};\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.data[name] = {\r\n\t\t\t\t\t\tdata: uniforms[name].init, \r\n\t\t\t\t\t\tuniform: Shader.uniform(uniforms[name].type, \"g\" + this.type + \"_\" + name + \"[]\")\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tfor (let name in uniforms) {\r\n\t\t\t\tif (\"set\" in uniforms[name]) {\r\n\t\t\t\t\tthis.data[name] = {\r\n\t\t\t\t\t\tdata: uniforms[name].init, \r\n\t\t\t\t\t\tset: uniforms[name].set,\r\n\t\t\t\t\t\tuniform: Shader.uniform(uniforms[name].type, \"g\" + name)\r\n\t\t\t\t\t};\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.data[name] = {\r\n\t\t\t\t\t\tdata: uniforms[name].init, \r\n\t\t\t\t\t\tuniform: Shader.uniform(uniforms[name].type, \"g\" + name)\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass Communicators {\r\n\tstatic communicators: { \r\n\t\tcom: Communicators, \r\n\t\tcheck: (e: Communicator) => boolean\r\n\t} [] = [];\r\n\tprivate data = new ulist<Communicator>();\r\n\r\n\tinvoke();\r\n\tinvoke(validate: (e: Communicator) => boolean);\r\n\tinvoke(validate?: any) {\r\n\t\tif (validate == undefined) {\r\n\t\t\tvalidate = () => true;\r\n\t\t}\r\n\t\tlet map: { [key: string]: number } = {};\r\n\t\tthis.data.visit((e: ulist_elem<Communicator>) => {\r\n\t\t\tlet communicator = e.get();\r\n\t\t\tif (communicator.array) {\r\n\t\t\t\tif (validate(communicator)) {\r\n\t\t\t\t\tif (!(communicator.type in map)) {\r\n\t\t\t\t\t\tmap[communicator.type] = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (communicator.invoke(map[communicator.type])) {\r\n\t\t\t\t\t\tmap[communicator.type]++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (validate(communicator)) {\r\n\t\t\t\t\tcommunicator.invoke(0);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tfor (let type in map) {\r\n\t\t\tCommunicator.counters[type].set(map[type]);\r\n\t\t}\r\n\t}\r\n\tstatic invoke() {\r\n\t\tif (Communicators.current) {\r\n\t\t\tCommunicators.current.invoke(Communicators.communicators[\r\n\t\t\t\tCommunicators.communicators.length - 1\r\n\t\t\t].check);\r\n\t\t}\r\n\t}\r\n\tadd(communicator: Communicator): ulist_elem<Communicator> {\r\n\t\treturn this.data.push(communicator);\r\n\t}\r\n\tuse();\r\n\tuse(validate: (e: Communicator) => boolean);\r\n\tuse(validate?: any) {\r\n\t\tif (validate == undefined) {\r\n\t\t\tvalidate = () => true;\r\n\t\t}\r\n\t\tCommunicators.communicators.push({\r\n\t\t\tcom: this,\r\n\t\t\tcheck: validate\r\n\t\t});\r\n\t}\r\n\tunuse() {\r\n\t\tif (Communicators.communicators.length) {\r\n\t\t\tCommunicators.communicators.pop();\r\n\t\t}\r\n\t}\r\n\tstatic get current(): Communicators {\r\n\t\tif (Communicators.communicators.length > 0) {\r\n\t\t\treturn Communicators.communicators[\r\n\t\t\t\tCommunicators.communicators.length - 1].com;\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport {\r\n\tCommunicator,\r\n\tCommunicators\r\n}\r\n","import { Texture2D, Texture } from \"./texture\";\r\nimport { Uniform, Shader } from \"./shader\";\r\nimport { gl } from \"../renderer/renderer\";\r\n\r\ntype MaterialProperty = {\r\n\tindex: number;\r\n\tkey: string;\r\n\tsemantic: number;\r\n\ttype: number;\r\n\tvalue: any;\r\n}\r\n\r\nconst textureType = {\r\n\t0x1: \"MatDiffuse\",\r\n\t0x2: \"MatSpecular\",\r\n\t0x3: \"MatAmbient\",\r\n\t0x4: \"MatEmissive\",\r\n\t0x5: \"MatHeight\",\r\n\t0x6: \"MatNormals\",\r\n\t0x7: \"MatShininess\",\r\n\t0x8: \"MatOpacity\",\r\n\t0x9: \"MatDisplacement\",\r\n\t0xa: \"MatLightmap\",\r\n\t0xb: \"MatReflection\"\r\n}\r\n\r\nexport default class Material {\r\n\tstatic materialPath: string = \"./materials/\";\r\n\r\n\tprivate static keymap: { \r\n\t\t[key: string]: { [key: string]: (self: Material, prop: MaterialProperty, path: string) => void }\r\n\t} = {\r\n\t\tmat: {\r\n\t\t\tshininess: (self: Material, prop: MaterialProperty) => {\r\n\t\t\t\tMaterial.lookup.specularPower(self, prop.value);\r\n\t\t\t},\r\n\t\t\tshinpercent: (self: Material, prop: MaterialProperty) => {\r\n\t\t\t\tMaterial.lookup.specularIntensity(self, prop.value);\r\n\t\t\t}\r\n\t\t},\r\n\t\ttex: {\r\n\t\t\tfile: (self: Material, prop: MaterialProperty, path: string) => {\r\n\t\t\t\tif (prop.semantic in textureType) {\r\n\t\t\t\t\tconsole.log(textureType[prop.semantic]);\r\n\t\t\t\t\tself.textures[textureType[prop.semantic]] = {\r\n\t\t\t\t\t\ttexture: new Texture2D(path + <string>prop.value),\r\n\t\t\t\t\t\tchannel: undefined\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tprivate static lookup: { [key: string]: (self: Material, value: any) => void } = {\r\n\t\tspecularPower: (self: Material, value: number) => {\r\n\t\t\tself.attributes.push({\r\n\t\t\t\tvalue: value,\r\n\t\t\t\tuniform: Shader.uniform(\"float\", \"gSpecularPower\")\r\n\t\t\t});\r\n\t\t},\r\n\t\tspecularIntensity: (self: Material, value: number) => {\r\n\t\t\tself.attributes.push({\r\n\t\t\t\tvalue: value,\r\n\t\t\t\tuniform: Shader.uniform(\"float\", \"gSpecularIntensity\")\r\n\t\t\t});\r\n\t\t},\r\n\t\ttexture: (self: Material, value: any) => {\r\n\t\t\t// \r\n\t\t}\r\n\t};\r\n\r\n\tprivate textures: { [key: string]: { texture: Texture2D, channel: number } } = {};\r\n\tprivate attributes: { value: any, uniform: Uniform } [] = [];\r\n\r\n\tconstructor(values?: { [key: string ]: any }) {\r\n\t\tif (values != undefined) {\r\n\t\t\tthis.addProperties(values);\r\n\t\t}\r\n\t}\r\n\tuse() {\r\n\t\tfor (let name in this.textures) {\r\n\t\t\tthis.textures[name].channel = Texture.genChannel();\r\n\t\t\tgl.activeTexture(gl.TEXTURE0 + this.textures[name].channel);\r\n\t\t\tgl.bindTexture(gl.TEXTURE_2D, this.textures[name].texture.handle);\r\n\t\t\tShader.uniform(\"int\", \"g\" + name).set(this.textures[name].channel);\r\n\t\t\t// console.log(\"g\" + name, this.textures[name].channel);\r\n\t\t\t// this.textures[name].use(name);\r\n\t\t}\r\n\t\tfor (let attr of this.attributes) {\r\n\t\t\tattr.uniform.set(attr.value);\r\n\t\t}\r\n\t}\r\n\tunuse() {\r\n\t\tfor (let name in this.textures) {\r\n\t\t\t// gl.activeTexture(gl.TEXTURE0 + this.textures[name].channel);\r\n\t\t\tgl.bindTexture(gl.TEXTURE_2D, null);\r\n\t\t\tTexture.restoreChannel(this.textures[name].channel);\r\n\t\t\t// this.textures[name].unuse();\r\n\t\t}\r\n\t}\r\n\taddProperties(values: { [key: string ]: any }) {\r\n\t\tfor (let key in values) {\r\n\t\t\tif (key in Material.lookup) {\r\n\t\t\t\tMaterial.lookup[key](this, values[key]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tstatic createFromModel(data: any, path: string = Material.materialPath) {\r\n\t\tlet self = new Material();\r\n\t\tfor (let prop of data.properties) {\r\n\t\t\tlet [ key, attr ] = prop.key.substring(1).split('.');\r\n\t\t\tif (key in Material.keymap) {\r\n\t\t\t\tif (attr in Material.keymap[key]) {\r\n\t\t\t\t\tMaterial.keymap[key][attr](self, <MaterialProperty>prop, path);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t}\r\n}\r\n","import { VertexAttrs, VAO } from \"./vertexAttrs\";\r\n\r\nexport default class Mesh {\r\n\tprivate readonly vao: VAO;\r\n\r\n\tconstructor(vertices: any, indices: number[] = undefined) {\r\n\t\tif (indices != undefined) {\r\n\t\t\tthis.vao = new VAO(vertices, indices);\r\n\t\t} else {\r\n\t\t\tthis.vao = new VAO(vertices);\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tthis.vao.bind();\r\n\t\t\tthis.vao.draw();\r\n\t\tthis.vao.unbind();\r\n\t}\r\n}\r\n","import assets from \"../util/assets\";\r\nimport Material from \"./material\";\r\nimport Mesh from \"./mesh\";\r\nimport { VertexAttrs } from \"./vertexAttrs\";\r\n\r\nconst vertexAttrMap = {\r\n\tvertices: \"pos3\",\r\n\tcolors: \"color4\",\r\n\tnormals: \"norm3\",\r\n\ttangents: \"tg3\",\r\n\tbitangents: \"bitg3\",\r\n\ttexturecoords: \"tex2\"\r\n}\r\n\r\nexport default class Model {\r\n\tprivate static models: { [key: string]: Model } = {};\r\n\r\n\tprivate mesh: { [key: number]: { material: Material, mesh: Mesh[] } } = {};\r\n\r\n\tconstructor(path: string, name: string);\r\n\tconstructor(path: string, name: string, callback: (v: Model) => void);\r\n\tconstructor(path: string, name: string, callback?: (v: Model) => void) {\r\n\t\tname = path + name;\r\n\t\tif (callback == undefined) {\r\n\t\t\tlet scene = assets.import(name);\r\n\t\t\tfor (let m of scene.meshes) {\r\n\t\t\t\tif (!(m.materialindex in this.mesh)) {\r\n\t\t\t\t\tthis.mesh[m.materialindex] = {\r\n\t\t\t\t\t\tmaterial: Material.createFromModel(scene.materials[m.materialindex], path),\r\n\t\t\t\t\t\tmesh: []\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\tthis.mesh[m.materialindex].mesh.push(Model.createMesh(m));\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tlet self = this;\r\n\t\t\tassets.importAsync(name, (scene: any) => {\r\n\t\t\t\tfor (let m of scene.meshes) {\r\n\t\t\t\t\tif (!(m.materialindex in self.mesh)) {\r\n\t\t\t\t\t\tself.mesh[m.materialindex] = {\r\n\t\t\t\t\t\t\tmaterial: Material.createFromModel(scene.materials[m.materialindex], path),\r\n\t\t\t\t\t\t\tmesh: []\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.mesh[m.materialindex].mesh.push(Model.createMesh(m));\r\n\t\t\t\t}\r\n\t\t\t\tcallback(this);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tfor (let i in this.mesh) {\r\n\t\t\tthis.mesh[i].material.use();\r\n\t\t\tfor (let m of this.mesh[i].mesh) {\r\n\t\t\t\tm.render();\r\n\t\t\t}\r\n\t\t\tthis.mesh[i].material.unuse();\r\n\t\t}\r\n\t}\r\n\r\n\tstatic create(path: string, name: string);\r\n\tstatic create(path: string, name: string, callback: (v: Model) => void);\r\n\tstatic create(path: string, name: string, callback?: (v: Model) => void) {\r\n\t\tif (callback == undefined) {\r\n\t\t\tif (!(name in Model.models)) {\r\n\t\t\t\tModel.models[name] = new Model(path, name);\r\n\t\t\t}\r\n\t\t\treturn Model.models[name];\r\n\t\t} else {\r\n\t\t\tif (!(name in Model.models)) {\r\n\t\t\t\tnew Model(path, name, (v: Model) => {\r\n\t\t\t\t\tModel.models[name] = v;\r\n\t\t\t\t\tcallback(v);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tcallback(Model.models[name]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tstatic createMesh(mesh: any): Mesh {\r\n\t\tlet attrs: any[] = [];\r\n\t\tfor (let attr in mesh) {\r\n\t\t\tif (attr in vertexAttrMap) {\r\n\t\t\t\tattrs.push(vertexAttrMap[attr]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet vs = new VertexAttrs(attrs);\r\n\t\tfor (let attr in mesh) {\r\n\t\t\tif (attr in vertexAttrMap) {\r\n\t\t\t\tvs.set(vertexAttrMap[attr], attr == \"texturecoords\" ? \r\n\t\t\t\tmesh[attr][0] : mesh[attr]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet indices: number[] = [];\r\n\t\tfor (let x of mesh.faces) {\r\n\t\t\tindices = indices.concat(x);\r\n\t\t}\r\n\t\treturn new Mesh(vs, indices);\r\n\t}\r\n}\r\n","import { RBO, FBO, PDBO } from \"../gl/buffer\";\r\nimport { gl, Renderer, ext, gl2 } from \"../renderer/renderer\";\r\nimport { Texture2D, TextureCube, Texture } from \"../gl/texture\";\r\nimport { Viewport } from \"../gl/viewport\";\r\nimport { glm } from \"../util/glm\"\r\n\r\n// class SingleChannelFBRB {\r\n// \tprivate rbo = new RBO();\r\n// \tprivate dbo = new RBO();\r\n// \tprivate fbo = new FBO();\r\n\r\n// \tconstructor() {\r\n// \t\tthis.fbo.bind();\r\n// \t\t\tthis.rbo.bind();\r\n// \t\t\t\tif (gl2) {\r\n// \t\t\t\t\tgl.renderbufferStorage(gl.RENDERBUFFER, gl2.R32F, \r\n// \t\t\t\t\t\tRenderer.instance.canvas.width, Renderer.instance.canvas.height);\r\n// \t\t\t\t} else {\r\n// \t\t\t\t\tgl.renderbufferStorage(gl.RENDERBUFFER, gl2.RGB, \r\n// \t\t\t\t\t\tRenderer.instance.canvas.width, Renderer.instance.canvas.height);\r\n// \t\t\t\t}\r\n// \t\t\t\tthis.fbo.setRenderBuffer(this.rbo, gl.COLOR_ATTACHMENT0);\r\n// \t\t\tthis.rbo.unbind();\r\n// \t\t\tthis.dbo.bind();\r\n// \t\t\t\tgl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT,\r\n// \t\t\t\t\tRenderer.instance.canvas.width, Renderer.instance.canvas.height);\r\n// \t\t\t\tthis.fbo.setRenderBuffer(this.dbo, gl.DEPTH_ATTACHMENT);\r\n// \t\t\tthis.dbo.unbind();\r\n// \t\tthis.fbo.unbind();\r\n// \t}\r\n\r\n// \tbind() {\r\n// \t\tthis.fbo.bind();\r\n// \t}\r\n// \tunbind() {\r\n// \t\tthis.rbo.bind();\r\n// \t}\r\n// }\r\n\r\nclass RenderBuffer {\r\n\tpublic readonly type = \"renderbuffer\";\r\n\tpublic readonly rbo = new RBO();\r\n\r\n\tconstructor(component: number)\r\n\tconstructor(component: number, width: number, height: number)\r\n\tconstructor(component: number, width?: number, height?: number) {\r\n\t\tif (width == undefined) {\r\n\t\t\twidth = Renderer.instance.canvas.width;\r\n\t\t\theight = Renderer.instance.canvas.height;\r\n\t\t}\r\n\t\tthis.rbo.bind();\r\n\t\t\tgl.renderbufferStorage(gl.RENDERBUFFER, component, width, height);\r\n\t\tthis.rbo.unbind();\r\n\t}\r\n}\r\n\r\nclass PixelRetriver {\r\n\tpublic readonly type = \"pixelRetriever\";\r\n\r\n\tpublic readonly pbo = new PDBO();\r\n\r\n\tconstructor(public readonly pixels: any) {\r\n\t\tif (!Renderer.require(\"WEBGL_get_buffer_sub_data_async\")) {\r\n\t\t\tthrow \"extension WEBGL_get_buffer_sub_data_async not supported\";\r\n\t\t}\r\n\t\tthis.pbo.bind();\r\n\t\tthis.pbo.data(pixels.byteLength);\r\n\t}\r\n\tgetData() {\r\n\t\tgl2.getBufferSubData(gl2.PIXEL_PACK_BUFFER, 0, this.pixels, 0, 0);\t\t\r\n\t}\r\n\tgetDataAsync(callback: (buffer?) => void) {\r\n\t\t// console.log(ext.getBufferSubDataAsync);\r\n\t\text[\"WEBGL_get_buffer_sub_data_async\"].getBufferSubDataAsync(gl2.PIXEL_PACK_BUFFER, 0, this.pixels, 0, 0).\r\n\t\tthen((buffer) => {\r\n\t\t\tgl.deleteBuffer(this.pbo.handle);\r\n\t\t\tcallback(buffer);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nclass Offscreen {\r\n\tprivate static offscreens = [];\r\n\r\n\tprivate fbo = new FBO();\r\n\r\n\tset(channel: number, texture: TextureCube, face: number);\r\n\tset(channel: number, texture: Texture2D)\r\n\tset(channel: number, renderbuffer: RenderBuffer);\r\n\tset(channel: number, second: any, face?: number) {\r\n\t\tif (second == null) {\r\n\t\t\tgl.framebufferTexture2D(gl.FRAMEBUFFER, channel, gl.TEXTURE_2D, null, 0);\r\n\t\t} else if (second.type == \"renderbuffer\") {\r\n\t\t\tlet renderbuffer: RenderBuffer = second;\r\n\t\t\tgl.framebufferRenderbuffer(gl.FRAMEBUFFER, channel, gl.RENDERBUFFER, renderbuffer.rbo.handle);\r\n\t\t} else {\r\n\t\t\tlet texture: Texture = second;\r\n\t\t\tswitch (texture.type) {\r\n\t\t\t\tcase gl.TEXTURE_2D: {\r\n\t\t\t\t\tgl.framebufferTexture2D(gl.FRAMEBUFFER, channel, gl.TEXTURE_2D, texture.handle, 0);\r\n\t\t\t\t} break;\r\n\t\t\t\tcase gl.TEXTURE_CUBE_MAP: {\r\n\t\t\t\t\tgl.framebufferTexture2D(gl.FRAMEBUFFER, channel, \r\n\t\t\t\t\t\tgl.TEXTURE_CUBE_MAP_POSITIVE_X + face, texture.handle, 0);\r\n\t\t\t\t} break;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tbind() {\r\n\t\tthis.fbo.bind();\r\n\t\tOffscreen.offscreens.push(this.fbo);\r\n\t}\r\n\tunbind() {\r\n\t\tif (Offscreen.offscreens.length) {\r\n\t\t\tOffscreen.offscreens.pop();\r\n\t\t\tthis.fbo.unbind();\r\n\t\t\tif (Offscreen.offscreens.length) {\r\n\t\t\t\tOffscreen.offscreens[Offscreen.offscreens.length - 1].bind();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tcheck() {\r\n\t\tthis.fbo.check();\r\n\t}\r\n}\r\n\r\nexport {\r\n\tRenderBuffer,\r\n\tPixelRetriver,\r\n\tOffscreen\r\n}\r\n","import xhr from \"../util/xhr\"\r\nimport { glm } from \"../util/glm\"\r\nimport { gl, gl2 } from \"../renderer/renderer\"\r\nimport { Communicators } from \"./communicator\";\r\n\r\ntype UniformType = \"int\" | \"float\" | \"ivec2\" | \"vec2\" | \"ivec3\" | \"vec3\" | \"ivec4\" | \"vec4\" |\r\n\t\"mat2\" | \"mat3\" | \"mat4\";\r\n\r\nclass Uniform {\r\n\tprivate setter: (loc: WebGLUniformLocation, value: any) => void;\r\n\r\n\tconstructor(private name: string, private valueType: UniformType, private isArray: boolean) {\r\n\t\t// console.log(new UniformMap());\r\n\t\tswitch (valueType) {\r\n\t\t\tcase \"int\": this.setter = (location: WebGLUniformLocation, value: any) => \r\n\t\t\t\tgl.uniform1iv(location, new Int32Array([value])); break;\r\n\t\t\tcase \"float\": this.setter = (location: WebGLUniformLocation, value: any) => \r\n\t\t\t\tgl.uniform1fv(location, new Float32Array([value])); break;\r\n\t\t\tcase \"ivec2\": this.setter = (location: WebGLUniformLocation, value: any) => \r\n\t\t\t\tgl.uniform2iv(location, value.array); break;\r\n\t\t\tcase \"vec2\": this.setter = (location: WebGLUniformLocation, value: any) => \r\n\t\t\t\tgl.uniform2fv(location, value.array); break;\r\n\t\t\tcase \"ivec3\": this.setter = (location: WebGLUniformLocation, value: any) => \r\n\t\t\t\tgl.uniform3iv(location, value.array); break;\r\n\t\t\tcase \"vec3\": this.setter = (location: WebGLUniformLocation, value: any) => \r\n\t\t\t\tgl.uniform3fv(location, value.array); break;\r\n\t\t\tcase \"ivec4\": this.setter = (location: WebGLUniformLocation, value: any) => \r\n\t\t\t\tgl.uniform4iv(location, value.array); break;\r\n\t\t\tcase \"vec4\": this.setter = (location: WebGLUniformLocation, value: any) => \r\n\t\t\t\tgl.uniform4fv(location, value.array); break;\r\n\t\t\tcase \"mat2\": this.setter = (location: WebGLUniformLocation, value: any) => \r\n\t\t\t\tgl.uniformMatrix2fv(location, false, value.array); break;\r\n\t\t\tcase \"mat3\": this.setter = (location: WebGLUniformLocation, value: any) => \r\n\t\t\t\tgl.uniformMatrix4fv(location, false, value.array); break;\r\n\t\t\tcase \"mat4\": this.setter = (location: WebGLUniformLocation, value: any) => \r\n\t\t\t\tgl.uniformMatrix4fv(location, false, value.array); break;\r\n\t\t\tdefault: throw \"undefined uniform type\";\r\n\t\t}\r\n\t}\r\n\tset(value: any) {\r\n\t\ttry {\r\n\t\t\tif (!this.isArray) {\r\n\t\t\t\tthis.setter(gl.getUniformLocation(Shader.current(), this.name), value);\r\n\t\t\t} else {\r\n\t\t\t\tthrow 1;\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tif (e == 1) {\r\n\t\t\t\tthrow \"cannot assign value to a uniform array.\";\r\n\t\t\t} else {\r\n\t\t\t\t// console.warn(\"uniform variable does not exist: \" + this.name);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tsubscribe(offset: number): Uniform {\r\n\t\tif (!this.isArray) {\r\n\t\t\tthrow \"cannot subscribe a non-array uniform\";\r\n\t\t} else {\r\n\t\t\treturn new Uniform(this.name + \"[\" + offset + \"]\", this.valueType, false);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass Shader {\r\n\tprivate static readonly shaderPath = \"./shaders/\";\r\n\tprivate static stack: Shader[] = [];\r\n\tprivate static shaders: { [key: string]: Shader } = {};\r\n\tprivate static requirements: { [label: string]: { [type: string]: WebGLShader } } = {};\r\n\r\n\tprivate static partials: string[] = [];\r\n\t\r\n\tprivate vert: WebGLShader;\r\n\tprivate frag: WebGLShader;\r\n\tpublic readonly handle: WebGLProgram;\r\n\tprivate partial: { [label: string]: WebGLProgram } = {};\r\n\r\n\tconstructor(vsfilename: string, fsfilename: string, private readonly specify: boolean, varyings?: string[]) {\r\n\t\tvsfilename = Shader.shaderPath + (gl2 ? \"gl2/\" : \"gl/\") + vsfilename;\r\n\t\tfsfilename = Shader.shaderPath + (gl2 ? \"gl2/\" : \"gl/\") + fsfilename;\r\n\t\tthis.vert = Shader.compileShader(xhr.getSync(vsfilename), gl.VERTEX_SHADER);\r\n\t\tthis.frag = Shader.compileShader(xhr.getSync(fsfilename), gl.FRAGMENT_SHADER);\r\n\t\tthis.handle = Shader.createProgram(this.vert, this.frag, varyings);\r\n\t\tif (specify) {\r\n\t\t\tfor (let label in Shader.requirements) {\r\n\t\t\t\tthis.partial[label] = Shader.createProgram(\r\n\t\t\t\t\t\t\"vert\" in Shader.requirements[label] ? Shader.requirements[label].vert : this.vert,\r\n\t\t\t\t\t\t\"frag\" in Shader.requirements[label] ? Shader.requirements[label].frag : this.frag);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tuse() {\r\n\t\tShader.stack.push(this);\r\n\t\tif (this.specify && Shader.partials.length) {\r\n\t\t\tgl.useProgram(this.partial[Shader.partials[Shader.partials.length - 1]]);\r\n\t\t} else {\r\n\t\t\tgl.useProgram(this.handle);\r\n\t\t}\r\n\t\tCommunicators.invoke();\r\n\t}\r\n\tunuse() {\r\n\t\tif (Shader.stack.length) {\r\n\t\t\tShader.stack.pop();\r\n\t\t}\r\n\t\tif (Shader.stack.length) {\r\n\t\t\tlet self = Shader.stack[Shader.stack.length - 1];\r\n\t\t\tif (self.specify && Shader.partials.length) {\r\n\t\t\t\tgl.useProgram(self.partial[Shader.partials[Shader.partials.length - 1]]);\r\n\t\t\t} else {\r\n\t\t\t\tgl.useProgram(self.handle);\r\n\t\t\t}\r\n\t\t\tCommunicators.invoke();\r\n\t\t} else {\r\n\t\t\tgl.useProgram(null);\r\n\t\t}\r\n\t}\r\n\tstatic uniform(valueType: UniformType, name: string): Uniform {\r\n\t\tlet p = name.indexOf(\"[]\");\r\n\t\tif (p != -1) {\r\n\t\t\treturn new Uniform(name.substring(0, name.indexOf(\"[]\")), valueType, true);\r\n\t\t} else {\r\n\t\t\treturn new Uniform(name, valueType, false);\r\n\t\t}\r\n\t}\r\n\tstatic require(list: { [label: string]: { [type: string]: string }}) {\r\n\t\tfor (let label in list) {\r\n\t\t\tif (!(label in Shader.requirements)) {\r\n\t\t\t\tlet data: { [type: string]: WebGLShader } = {};\r\n\t\t\t\tif (\"frag\" in list[label]) {\r\n\t\t\t\t\tlet fsfilename = Shader.shaderPath + (gl2 ? \"gl2/\" : \"gl/\") + list[label].frag + \".frag\";\r\n\t\t\t\t\tdata.frag = Shader.compileShader(xhr.getSync(fsfilename), gl.FRAGMENT_SHADER);\r\n\t\t\t\t}\r\n\t\t\t\tif (\"vert\" in list[label]) {\r\n\t\t\t\t\tlet vsfilename = Shader.shaderPath + (gl2 ? \"gl2/\" : \"gl/\") + list[label].vert + \".vert\";\r\n\t\t\t\t\tdata.vert = Shader.compileShader(xhr.getSync(vsfilename), gl.VERTEX_SHADER);\r\n\t\t\t\t}\r\n\t\t\t\t// console.log(data);\r\n\t\t\t\tShader.requirements[label] = data;\r\n\t\t\t\tfor (let id in Shader.shaders) {\r\n\t\t\t\t\tif (Shader.shaders[id].specify) {\r\n\t\t\t\t\t\tShader.shaders[id].partial[label] = Shader.createProgram(\r\n\t\t\t\t\t\t\t\t\"vert\" in data ? data.vert : Shader.shaders[id].vert,\r\n\t\t\t\t\t\t\t\t\"frag\" in data ? data.frag : Shader.shaders[id].frag);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate static compileShader(source: string, type: number): WebGLShader {\r\n\t\tlet shader = gl.createShader(type);\r\n\t\tgl.shaderSource(shader, source);\r\n\t\tgl.compileShader(shader);\r\n\t\tif (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\r\n\t\t\tthrow gl.getShaderInfoLog(shader);\r\n\t\t}\r\n\t\treturn shader;\r\n\t}\r\n\tpublic static create(name: string, specify: boolean, varyings?: string[]): Shader {\r\n\t\tif (!(name in Shader.shaders)) {\r\n\t\t\tShader.shaders[name] = new Shader(name + \".vert\", name + \".frag\", specify, varyings);\r\n\t\t}\r\n\t\treturn Shader.shaders[name];\r\n\t}\r\n\tstatic current(): WebGLProgram {\r\n\t\tif (!Shader.stack.length) {\r\n\t\t\treturn null;\r\n\t\t} else {\r\n\t\t\tif (Shader.stack[Shader.stack.length - 1].specify && Shader.partials.length) {\r\n\t\t\t\treturn Shader.stack[Shader.stack.length - 1].partial[Shader.partials[Shader.partials.length - 1]];\r\n\t\t\t} else {\r\n\t\t\t\treturn Shader.stack[Shader.stack.length - 1].handle;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tstatic specify(label: string) {\r\n\t\tthis.partials.push(label);\r\n\t}\r\n\tstatic unspecify() {\r\n\t\tif (this.partials.length) {\r\n\t\t\tthis.partials.pop();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate static createProgram(vert: WebGLShader, frag: WebGLShader, varyings?: string[]): WebGLProgram {\r\n\t\tlet program = gl.createProgram();\r\n\t\tgl.bindAttribLocation(program, 0, \"Position\");\r\n\t\tgl.bindAttribLocation(program, 1, \"Color\");\r\n\t\tgl.bindAttribLocation(program, 2, \"Normal\");\r\n\t\tgl.bindAttribLocation(program, 3, \"Tangent\");\r\n\t\tgl.bindAttribLocation(program, 4, \"Bitangent\");\r\n\t\tgl.bindAttribLocation(program, 5, \"TexCoord\");\r\n\t\tgl.bindAttribLocation(program, 6, \"BoneIndex\");\r\n\t\tgl.bindAttribLocation(program, 7, \"BoneWeight\");\r\n\t\tgl.attachShader(program, vert);\r\n\t\tgl.attachShader(program, frag);\r\n\r\n\t\tif (varyings) {\r\n\t\t\tif (!gl2) throw \"webgl 2.0 required.\";\r\n\t\t\tfor (let i = 0; i != varyings.length; ++i) {\r\n\t\t\t\tvaryings[i] += \"_next\";\r\n\t\t\t}\r\n\t\t\tgl2.transformFeedbackVaryings(program, varyings, gl2.INTERLEAVED_ATTRIBS);\r\n\t\t}\r\n\t\tgl.linkProgram(program);\r\n\t\tif (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\r\n\t\t\tthrow gl.getProgramInfoLog(program);\r\n\t\t}\r\n\t\treturn program;\r\n\t}\r\n}\r\n\r\nexport {\r\n\tUniform,\r\n\tUniformType,\r\n\tShader\r\n}","import { gl, Renderer, gl2 } from \"../renderer/renderer\";\r\nimport { FBO } from \"./buffer\";\r\nimport { Communicator, Communicators } from \"./communicator\";\r\nimport { ulist_elem } from \"../util/ulist\";\r\n\r\nclass TextureCommunicator extends Communicator {\r\n\tconstructor(name: string, channel: number) {\r\n\t\tsuper(\"Texture\", false);\r\n\t\tlet map: any = {}; \r\n\t\tmap[name] = {\r\n\t\t\ttype: \"int\",\r\n\t\t\tinit: channel\r\n\t\t}\r\n\t\tthis.init(map);\r\n\t}\r\n}\r\n\r\nlet channelLookup: boolean[] = [\r\n\tfalse, false, false, false, false, false, false, false\r\n];\r\n\r\nfunction getChannel(): number {\r\n\tfor (let i = 0; i != channelLookup.length; ++i) {\r\n\t\tif (!channelLookup[i]) {\r\n\t\t\tchannelLookup[i] = true;\r\n\t\t\treturn i;\r\n\t\t}\r\n\t}\r\n\tthrow \"texture channels run out\";\r\n}\r\n\r\nfunction restoreChannel(channel: number) {\r\n\tchannelLookup[channel] = false;\r\n}\r\n\r\nclass TextureSpec {\r\n\tcomponent?: number;\r\n\ttype?: number;\r\n\tfilter?: number;\r\n\twrap?: number;\r\n};\r\n\r\nclass TextureSpecFile {\r\n\tcomponent?: number;\r\n\ttype?: number;\r\n\tfilter?: number;\r\n\twrap?: number;\r\n\tmipmap?: boolean;\r\n};\r\n\r\nabstract class Texture {\r\n\tpublic readonly handle: number;\r\n\r\n\tprivate static channels: { [name: string]: ulist_elem<Communicator> } = {};\r\n\r\n\tprivate name: string;\r\n\tprivate channel: number;\r\n\r\n\tconstructor(public readonly type: number) {\r\n\t\tthis.handle = <number>gl.createTexture();\r\n\t}\r\n\tuse(name: string) {\r\n\t\tif (Texture.channels[name] == undefined) {\r\n\t\t\tthis.name = name;\r\n\t\t\tthis.channel = getChannel();\r\n\t\t\tTexture.channels[name] = Communicators.current.add(new TextureCommunicator(name, this.channel));\r\n\t\t\tgl.activeTexture(gl.TEXTURE0 + this.channel);\r\n\t\t\tgl.bindTexture(this.type, this.handle);\r\n\t\t} else {\r\n\t\t\tthrow \"channel \" + name + \" has already bound a texture\";\r\n\t\t}\r\n\t}\r\n\tunuse() {\r\n\t\tif (Texture.channels[this.name] != undefined) {\r\n\t\t\t// gl.activeTexture(gl.TEXTURE0 + this.channel);\r\n\t\t\tgl.bindTexture(this.type, null);\r\n\t\t\tTexture.channels[this.name].remove();\r\n\t\t\trestoreChannel(this.channel);\r\n\t\t\tTexture.channels[this.name] = undefined;\r\n\t\t}\r\n\t}\r\n\tstatic genChannel(): number {\r\n\t\treturn getChannel();\r\n\t}\r\n\tstatic restoreChannel(channel: number) {\r\n\t\trestoreChannel(channel);\r\n\t}\r\n\tprotected bind() {\r\n\t\tgl.bindTexture(this.type, this.handle);\r\n\t}\r\n\tprotected unbind() {\r\n\t\tgl.bindTexture(this.type, null);\r\n\t}\r\n}\r\n\r\nclass Texture2D extends Texture {\r\n\tprivate w: number;\r\n\tprivate h: number;\r\n\r\n\tconstructor();\r\n\tconstructor(opts: TextureSpec);\r\n\tconstructor(opts: TextureSpec, width: number, height: number);\r\n\tconstructor(filename: string);\r\n\tconstructor(filename: string);\r\n\tconstructor(filename: string, opts: TextureSpecFile);\r\n\tconstructor(first?: any, second?: any, third?: any) {\r\n\t\tsuper(gl.TEXTURE_2D);\r\n\t\tif (typeof first == \"string\") {\r\n\t\t\tlet filename: string = first;\r\n\t\t\tlet opts: { [key: string]: any } = second == undefined ? {} : second;\r\n\t\t\tlet usemipmap: boolean = opts.mipmap == undefined ? true : opts.mipmap;\r\n\t\t\tlet component: number = opts.component || gl.RGBA;\r\n\t\t\tlet internalComponent = component;\r\n\t\t\tlet type: number = opts.type || gl.UNSIGNED_BYTE;\r\n\t\t\tif (type == gl.FLOAT) {\r\n\t\t\t\tif (gl2) {\r\n\t\t\t\t\tif (!Renderer.require([\"EXT_color_buffer_float\", \r\n\t\t\t\t\t\t\"OES_texture_float_linear\"])) {\r\n\t\t\t\t\t\tthrow \"floating point textures not supported.\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tswitch (component) {\r\n\t\t\t\t\t\tcase gl2.RED: internalComponent = gl2.R32F; break;\r\n\t\t\t\t\t\tcase gl2.RG: internalComponent = gl2.RG32F; break;\r\n\t\t\t\t\t\tcase gl.RGB: internalComponent = gl2.RGB32F; break;\r\n\t\t\t\t\t\tcase gl.RGBA: internalComponent = gl2.RGBA32F; break;\r\n\t\t\t\t\t\tdefault: throw \"unknown internal format.\";\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (!Renderer.require([\"OES_texture_float\", \r\n\t\t\t\t\t\t\"OES_texture_float_linear\"])) {\r\n\t\t\t\t\t\tthrow \"floating point textures not supported.\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet filter = opts.filter || gl.LINEAR;\r\n\t\t\tlet wrap = opts.wrap || gl.REPEAT;\r\n\t\t\tthis.bind();\r\n\t\t\t\tgl.texImage2D(this.type, 0, internalComponent, 1, 1, 0, component, type, null);\r\n\t\t\tthis.unbind();\r\n\t\t\tlet img = new Image();\r\n\t\t\timg.onload = () => {\r\n\t\t\t\tthis.bind();\r\n\t\t\t\t\tgl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);\r\n\t\t\t\t\tgl.texImage2D(this.type, 0, internalComponent, component, type, img);\r\n\t\t\t\t\tgl.texParameterf(this.type, gl.TEXTURE_WRAP_S, wrap);\r\n\t\t\t\t\tgl.texParameterf(this.type, gl.TEXTURE_WRAP_T, wrap);\r\n\t\t\t\t\tgl.texParameterf(this.type, gl.TEXTURE_MAG_FILTER, filter);\r\n\t\t\t\t\tif (usemipmap) {\r\n\t\t\t\t\t\tgl.texParameteri(this.type, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_LINEAR);\r\n\t\t\t\t\t\tgl.generateMipmap(this.type);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tgl.texParameteri(this.type, gl.TEXTURE_MIN_FILTER, filter);\r\n\t\t\t\t\t}\r\n\t\t\t\tthis.unbind();\r\n\t\t\t\tthis.w = img.width; this.h = img.height;\r\n\t\t\t}\r\n\t\t\timg.src = filename;\r\n\t\t} else {\r\n\t\t\tlet opts: { [key: string]: any } = first == undefined ? {} : first;\r\n\t\t\tlet component: number = opts.component || gl.RGBA;\r\n\t\t\tlet internalComponent = component;\r\n\t\t\tlet type: number = opts.type || gl.UNSIGNED_BYTE;\r\n\t\t\tif (type == gl.FLOAT) {\r\n\t\t\t\tif (gl2) {\r\n\t\t\t\t\tif (!Renderer.require([\"EXT_color_buffer_float\", \r\n\t\t\t\t\t\t\"OES_texture_float_linear\"])) {\r\n\t\t\t\t\t\tthrow \"floating point textures not supported.\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tswitch (component) {\r\n\t\t\t\t\t\tcase gl2.RED: internalComponent = gl2.R32F; break;\r\n\t\t\t\t\t\tcase gl2.RG: internalComponent = gl2.RG32F; break;\r\n\t\t\t\t\t\tcase gl.RGB: internalComponent = gl2.RGB32F; break;\r\n\t\t\t\t\t\tcase gl.RGBA: internalComponent = gl2.RGBA32F; break;\r\n\t\t\t\t\t\tcase gl.DEPTH_COMPONENT: internalComponent = gl2.DEPTH_COMPONENT32F; break;\r\n\t\t\t\t\t\tdefault: throw \"unknown internal format.\";\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (!Renderer.require([\"OES_texture_float\", \r\n\t\t\t\t\t\t\"OES_texture_float_linear\"])) {\r\n\t\t\t\t\t\tthrow \"floating point textures not supported.\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (type == gl.UNSIGNED_SHORT) {\r\n\t\t\t\tif (gl2) {\r\n\t\t\t\t\tif (component == gl.DEPTH_COMPONENT) {\r\n\t\t\t\t\t\tinternalComponent = gl2.DEPTH_COMPONENT16;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthrow \"unknown internal format.\";\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (!Renderer.require([\"WEBGL_depth_texture\"])) {\r\n\t\t\t\t\t\tthrow \"depth texture not supported.\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet filter = opts.filter || gl.LINEAR;\r\n\t\t\tlet wrap = opts.wrap || gl.CLAMP_TO_EDGE;\r\n\t\t\tthis.w = second;\r\n\t\t\tthis.h = third;\r\n\t\t\tif (second == undefined) {\r\n\t\t\t\tthis.w = Renderer.instance.canvas.width;\r\n\t\t\t\tthis.h = Renderer.instance.canvas.height;\r\n\t\t\t}\r\n\t\t\tthis.bind();\r\n\t\t\t\tgl.texImage2D(this.type, 0, internalComponent, this.w, this.h, 0, component, type, null);\r\n\t\t\t\tgl.texParameterf(this.type, gl.TEXTURE_MIN_FILTER, filter);\r\n\t\t\t\tgl.texParameterf(this.type, gl.TEXTURE_MAG_FILTER, filter);\r\n\t\t\t\tgl.texParameterf(this.type, gl.TEXTURE_WRAP_S, wrap);\r\n\t\t\t\tgl.texParameterf(this.type, gl.TEXTURE_WRAP_T, wrap);\r\n\t\t\tthis.unbind();\r\n\t\t}\r\n\t}\r\n\r\n\tget width() {\r\n\t\treturn this.w;\r\n\t}\r\n\tget height() {\r\n\t\treturn this.h;\r\n\t}\r\n}\r\n\r\nclass TextureCube extends Texture {\r\n\tconstructor(opts: TextureSpec);\r\n\tconstructor(opts: TextureSpec, width: number, height: number);\r\n\tconstructor(opts: TextureSpec, width?: number, height?: number) {\r\n\t\tsuper(gl.TEXTURE_CUBE_MAP);\r\n\t\tif (width == undefined) {\r\n\t\t\twidth = height = Renderer.instance.canvas.height;\r\n\t\t}\r\n\t\tthis.bind();\r\n\t\t\tlet component: number = opts.component || gl.RGBA;\r\n\t\t\tlet type: number = opts.type || gl.UNSIGNED_BYTE;\r\n\t\t\tlet internalComponent = component;\r\n\t\t\tif (type == gl.FLOAT) {\r\n\t\t\t\tif (gl2) {\r\n\t\t\t\t\tif (!Renderer.require([\"EXT_color_buffer_float\", \r\n\t\t\t\t\t\t\"OES_texture_float_linear\"])) {\r\n\t\t\t\t\t\tthrow \"floating point textures not supported.\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tswitch (component) {\r\n\t\t\t\t\t\tcase gl2.RED: internalComponent = gl2.R32F; break;\r\n\t\t\t\t\t\tcase gl2.RG: internalComponent = gl2.RG32F; break;\r\n\t\t\t\t\t\tcase gl.RGB: internalComponent = gl2.RGB32F; break;\r\n\t\t\t\t\t\tcase gl.RGBA: internalComponent = gl2.RGBA32F; break;\r\n\t\t\t\t\t\tdefault: throw \"unknown internal format.\";\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (!Renderer.require([\"OES_texture_float\", \r\n\t\t\t\t\t\t\"OES_texture_float_linear\"])) {\r\n\t\t\t\t\t\tthrow \"floating point textures not supported.\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tgl.texParameterf(this.type, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n\t\t\tgl.texParameterf(this.type, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n\t\t\tgl.texParameterf(this.type, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n\t\t\tgl.texParameterf(this.type, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n\t\t\tif (gl2) {\r\n\t\t\t\tgl.texParameterf(this.type, gl2.TEXTURE_WRAP_R, gl.CLAMP_TO_EDGE);\r\n\t\t\t}\r\n\r\n\t\t\tfor (let i = 0; i != 6; ++i) {\r\n\t\t\t\tgl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, internalComponent, \r\n\t\t\t\t\t\twidth, height, 0, component, type, null);\r\n\t\t\t}\r\n\t\tthis.unbind();\r\n\t}\r\n}\r\n\r\nexport {\r\n\tTexture,\r\n\tTexture2D,\r\n\tTextureCube\r\n}\r\n","import { gl, gl2 } from \"../renderer/renderer\";\r\nimport { TBO } from \"./buffer\";\r\n\r\ntype AttrRecord = {\r\n\tindex: number;\r\n\ttype: number;\r\n\tsize: number;\r\n\toffset: number;\r\n}\r\n\r\nclass TAO {\r\n\tprivate attrs: AttrRecord[];\r\n\tprivate attrSize: number;\r\n\tprivate numVertices: number;\r\n\tprivate tbo = new TBO();\r\n\r\n\tconstructor(attr: TransformAttrs) {\r\n\t\tthis.attrs = attr.attrs;\r\n\t\tthis.attrSize = attr.attrSize;\r\n\t\tthis.numVertices = attr.vertices.length / attr.component;\r\n\t\tthis.tbo.bind();\r\n\t\t\tthis.tbo.data(attr.vertices);\r\n\t\tthis.tbo.unbind();\r\n\t}\r\n\tbind() {\r\n\t\tthis.tbo.bind();\r\n\t\tfor (let x of this.attrs) {\r\n\t\t\tgl.enableVertexAttribArray(x.index);\r\n\t\t\t// console.log(x.index, x.size, x.type, false, this.attrSize, x.offset);\r\n\t\t\tgl.vertexAttribPointer(x.index, x.size, x.type, false, this.attrSize, x.offset);\r\n\t\t}\r\n\t}\r\n\tunbind() {\r\n\t\tfor (let x of this.attrs) {\r\n\t\t\tgl.disableVertexAttribArray(x.index);\r\n\t\t}\r\n\t\tthis.tbo.unbind();\r\n\t}\r\n\tdraw();\r\n\tdraw(mode: number);\r\n\tdraw(mode: number, first: number, count: number); \r\n\tdraw(mode?: number, first: number = undefined, count: number = undefined) {\r\n\t\tif (mode == undefined) {\r\n\t\t\tmode = gl.POINTS;\r\n\t\t}\r\n\t\tgl2.beginTransformFeedback(mode);\r\n\t\tif (first != undefined) {\r\n\t\t\tgl.drawArrays(mode, first, count);\r\n\t\t} else {\r\n\t\t\tgl.drawArrays(mode, 0, this.numVertices);\r\n\t\t}\r\n\t\tgl2.endTransformFeedback();\r\n\t}\r\n\tswap() {\r\n\t\tthis.tbo.swap();\r\n\t}\r\n}\r\n\r\nclass TransformAttrType {\r\n\tname: string;\r\n\ttype: number;\r\n\tsize: number;\r\n}\r\n\r\nclass TransformAttrs {\r\n\tpublic readonly attrs: AttrRecord[] = [];\r\n\tpublic readonly attrSize: number = 0;\r\n\tpublic vertices: number[] = [];\r\n\tpublic readonly component: number = 0;\r\n\tprivate readonly attrLookup: { [key: string]: AttrRecord } = {};\r\n\r\n\tconstructor(private attrNames: TransformAttrType[]) {\r\n\t\tlet offset = 0;\r\n\t\tfor (let i in attrNames) {\r\n\t\t\tlet attr = {\r\n\t\t\t\tindex: <number>null,\r\n\t\t\t\ttype: <number>null,\r\n\t\t\t\tsize: <number>null,\r\n\t\t\t\toffset: <number>null\r\n\t\t\t};\r\n\t\t\tattr.index = +i;\r\n\t\t\tattr.type = attrNames[i].type;\r\n\t\t\tattr.size = attrNames[i].size;\r\n\t\t\tattr.offset = offset;\r\n\t\t\toffset += attr.size * TransformAttrs.getSize(attr.type);\r\n\t\t\tthis.attrs.push(attr);\r\n\t\t\tthis.attrLookup[attrNames[i].name] = attr;\r\n\t\t\tthis.component += attr.size;\r\n\t\t}\r\n\t\tthis.attrSize = offset;\r\n\t}\r\n\tpush(vertex: { [key: string]: number [] }) {\r\n\t\tfor (let x of this.attrNames) {\r\n\t\t\tif (x.name in vertex) {\r\n\t\t\t\tthis.vertices = this.vertices.concat(vertex[x.name]);\r\n\t\t\t} else {\r\n\t\t\t\tthrow \"lack of vertex attribute: \" + x;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tset(type: string, vs: number[]) {\r\n\t\tlet i = 0;\r\n\t\tfor (let x of this.attrNames) {\r\n\t\t\tif (x.name == type) break;\r\n\t\t\ti += this.attrLookup[x.name].size;\r\n\t\t}\r\n\t\tlet dt = this.attrLookup[type].size;\r\n\t\tfor (let j = 0; j < vs.length; j += dt) {\r\n\t\t\tfor (let k = 0; k != dt; ++k) {\r\n\t\t\t\tthis.vertices[i + k] = vs[j + k];\r\n\t\t\t}\r\n\t\t\ti += this.component;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic getSize(type: number): number {\r\n\t\tswitch (type) {\r\n\t\t\tcase gl.FLOAT: return 4;\r\n\t\t\tcase gl.BYTE: case gl.UNSIGNED_BYTE: return 1;\r\n\t\t\tcase gl.SHORT: case gl.UNSIGNED_SHORT: return 2;\r\n\t\t\tcase gl.INT: case gl.UNSIGNED_INT: return 4;\r\n\t\t\tdefault: throw \"unknown type\";\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass TransformFeedback {\r\n\tpublic readonly handle: WebGLTransformFeedback;\r\n\tprivate vbo = new TBO();\r\n\r\n\tconstructor() {\r\n\t\tif (!gl2) {\r\n\t\t\tthrow \"webgl 2.0 required.\";\r\n\t\t}\r\n\t\tthis.handle = gl2.createTransformFeedback();\r\n\t}\r\n\r\n\tbind() {\r\n\t\tgl2.bindTransformFeedback(gl2.TRANSFORM_FEEDBACK, this.handle);\r\n\t}\r\n\tunbind() {\r\n\t\tgl2.bindTransformFeedback(gl2.TRANSFORM_FEEDBACK, null);\r\n\t}\r\n}\r\n\r\nexport {\r\n\tTransformAttrs,\r\n\tTAO,\r\n\tTransformFeedback\r\n}","import { glm } from \"../util/glm\"\r\nimport { gl } from \"../renderer/renderer\";\r\nimport { VBO, EBO } from \"./buffer\";\r\n\r\nconst attrLocation = {\r\n\tpos: 0, color: 1, norm: 2, tg: 3, bitg: 4, tex: 5, ibone: 6, wbone: 7\r\n};\r\n\r\ntype Extra = \"pos2\" | \"pos3\" | \"pos4\"\r\ntype ColorType = \"color3\" | \"color4\"\r\ntype NormalType = \"norm3\" | \"norm4\"\r\ntype TangentType = \"tg3\" | \"tg4\"\r\ntype BitangentType = \"bitg3\" | \"bitg4\"\r\ntype TexcoordType = \"tex2\" | \"tex3\" | \"tex4\"\r\ntype BoneIndexType = \"ibone3\" | \"ibone4\"\r\ntype BoneWeightType = \"wbone3\" | \"wbone4\"\r\n\r\ntype VertexAttrType = Extra | ColorType | NormalType |\r\n\tTangentType | BitangentType | TexcoordType | BoneIndexType | BoneWeightType;\r\n\r\nclass TypeMap {\r\n\tpos2: glm.vec2;\r\n\tpos3: glm.vec3;\r\n\tpos4: glm.vec4;\r\n\tcolor3: glm.vec3;\r\n\tcolor4: glm.vec4;\r\n\tnorm3: glm.vec3;\r\n\tnorm4: glm.vec4;\r\n\ttg3: glm.vec3;\r\n\ttg4: glm.vec4;\r\n\tbitg3: glm.vec3;\r\n\tbitg4: glm.vec4;\r\n\ttex2: glm.vec2;\r\n\ttex3: glm.vec3;\r\n\ttex4: glm.vec4;\r\n\tibone3: glm.vec3;\r\n\tibone4: glm.vec4;\r\n\twbone3: glm.vec3;\r\n\twbone4: glm.vec4;\r\n}\r\n\r\ntype VertexAttr<T extends VertexAttrType> = {\r\n\t[P in T]: TypeMap[P];\r\n}\r\n\r\ntype AttrRecord = {\r\n\tindex: number;\r\n\ttype: number;\r\n\tsize: number;\r\n\toffset: number;\r\n}\r\n\r\nclass VAO {\r\n\tprivate attrs: AttrRecord[];\r\n\tprivate attrSize: number;\r\n\tprivate numVertices: number;\r\n\tprivate numIndices: number;\r\n\tprivate vbo = new VBO();\r\n\tprivate ebo: EBO;\r\n\r\n\tconstructor(attr: VertexAttrs, indices: number[] = undefined) {\r\n\t\tthis.attrs = attr.attrs;\r\n\t\tthis.attrSize = attr.attrSize;\r\n\t\tthis.numVertices = attr.vertices.length / attr.component;\r\n\t\tthis.vbo.bind();\r\n\t\t\tthis.vbo.data(attr.vertices);\r\n\t\tthis.vbo.unbind();\r\n\t\tif (indices != undefined) {\r\n\t\t\tthis.ebo = new EBO();\r\n\t\t\tthis.ebo.bind();\r\n\t\t\t\tthis.ebo.data(indices);\r\n\t\t\tthis.ebo.unbind();\r\n\t\t\tthis.numIndices = indices.length;\r\n\t\t}\r\n\t}\r\n\tbind() {\r\n\t\tthis.vbo.bind();\r\n\t\tif (this.ebo) {\r\n\t\t\tthis.ebo.bind();\r\n\t\t}\r\n\t\tfor (let x of this.attrs) {\r\n\t\t\tgl.enableVertexAttribArray(x.index);\r\n\t\t\t// console.log(x.index, x.size, x.type, false, this.attrSize, x.offset);\r\n\t\t\tgl.vertexAttribPointer(x.index, x.size, x.type, false, this.attrSize, x.offset);\r\n\t\t}\r\n\t}\r\n\tunbind() {\r\n\t\tfor (let x of this.attrs) {\r\n\t\t\tgl.disableVertexAttribArray(x.index);\r\n\t\t}\r\n\t\tif (this.ebo) {\r\n\t\t\tthis.ebo.unbind();\r\n\t\t}\r\n\t\tthis.vbo.unbind();\r\n\t}\r\n\tdraw();\r\n\tdraw(mode: number, first: number, count: number); \r\n\tdraw(mode: number = undefined, first: number = undefined, count: number = undefined) {\r\n\t\tif (this.ebo) {\r\n\t\t\tgl.drawElements(gl.TRIANGLES, this.numIndices, gl.UNSIGNED_INT, 0);\r\n\t\t} else {\r\n\t\t\tif (mode != undefined) {\r\n\t\t\t\tgl.drawArrays(mode, first, count);\r\n\t\t\t} else {\r\n\t\t\t\tgl.drawArrays(gl.TRIANGLES, 0, this.numVertices);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass VertexAttrs {\r\n\tpublic readonly attrs: AttrRecord[] = [];\r\n\tpublic readonly attrSize: number = 0;\r\n\tpublic vertices: number[] = [];\r\n\tpublic readonly component: number = 0;\r\n\tprivate readonly attrLookup: { [key: string]: AttrRecord } = {};\r\n\r\n\tconstructor(private attrNames: VertexAttrType[]) {\r\n\t\tlet offset = 0;\r\n\t\tfor (let x of attrNames) {\r\n\t\t\tlet attr = {\r\n\t\t\t\tindex: <number>null,\r\n\t\t\t\ttype: <number>null,\r\n\t\t\t\tsize: <number>null,\r\n\t\t\t\toffset: <number>null\r\n\t\t\t};\r\n\t\t\tattr.index = attrLocation[x.substr(0, x.length - 1)];\r\n\t\t\tif (x[0] == \"i\") {\r\n\t\t\t\tattr.type = gl.INT;\r\n\t\t\t} else {\r\n\t\t\t\tattr.type = gl.FLOAT;\r\n\t\t\t}\r\n\t\t\tattr.size = +x.substr(-1);\r\n\t\t\tattr.offset = offset;\r\n\t\t\toffset += attr.size * VertexAttrs.getSize(attr.type);\r\n\t\t\tthis.attrs.push(attr);\r\n\t\t\tthis.attrLookup[x] = attr;\r\n\t\t\tthis.component += attr.size;\r\n\t\t}\r\n\t\tthis.attrSize = offset;\r\n\t}\r\n\tpush<T extends VertexAttrType>(vertex: VertexAttr<T>) {\r\n\t\tfor (let x of this.attrNames) {\r\n\t\t\tif (x in vertex) {\r\n\t\t\t\tthis.vertices = this.vertices.concat(vertex[x]);\r\n\t\t\t} else {\r\n\t\t\t\tthrow \"lack of vertex attribute: \" + x;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tset(type: VertexAttrType, vs: number[]) {\r\n\t\tlet i = 0;\r\n\t\tfor (let x of this.attrNames) {\r\n\t\t\tif (x == type) break;\r\n\t\t\ti += this.attrLookup[x].size;\r\n\t\t}\r\n\t\tlet dt = this.attrLookup[type].size;\r\n\t\tfor (let j = 0; j < vs.length; j += dt) {\r\n\t\t\tfor (let k = 0; k != dt; ++k) {\r\n\t\t\t\tthis.vertices[i + k] = vs[j + k];\r\n\t\t\t}\r\n\t\t\ti += this.component;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic getSize(type: number): number {\r\n\t\tswitch (type) {\r\n\t\t\tcase gl.FLOAT: return 4;\r\n\t\t\tcase gl.BYTE: case gl.UNSIGNED_BYTE: return 1;\r\n\t\t\tcase gl.SHORT: case gl.UNSIGNED_SHORT: return 2;\r\n\t\t\tcase gl.INT: case gl.UNSIGNED_INT: return 4;\r\n\t\t\tdefault: throw \"unknown type\";\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport {\r\n\tVertexAttr,\r\n\tVertexAttrs,\r\n\tVAO\r\n}\r\n","import { glm } from \"../util/glm\"\r\nimport { gl, Renderer } from \"../renderer/renderer\"\r\n\r\nclass Viewport {\r\n\tprivate static viewports: Viewport[] = [];\r\n\r\n\tprotected N = glm.vec3(0, 1, 0);\r\n\tprotected P = glm.vec3(0, 0, 0);\r\n\tprotected Up = glm.vec3(0, 0, 1);\r\n\t\r\n\tprotected rotateModified = true;\r\n\tprotected translateModified = true;\r\n\r\n\tprotected rotateTrans: glm.mat4;\r\n\tprotected translateTrans: glm.mat4;\r\n\r\n\tprotected trans: glm.mat4;\r\n\r\n\tconstructor();\r\n\tconstructor(left: number, top: number, width: number, height: number);\r\n\tconstructor(public readonly left?: number, public readonly top?: number,\r\n\t\tpublic readonly width?: number, public readonly height?: number)\r\n\t{\r\n\t\tif (left != undefined) {\r\n\t\t\t// gl.viewport(left, top, width, height);\r\n\t\t} else {\r\n\t\t\tthis.left = 0; this.top = 0;\r\n\t\t\tthis.width = Renderer.instance.canvas.width;\r\n\t\t\tthis.height = Renderer.instance.canvas.height;\r\n\t\t}\r\n\t}\r\n\r\n\tset target(target: glm.vec3) {\r\n\t\tthis.N = glm.normalize(target);\r\n\t\tthis.rotateModified = true;\r\n\t}\r\n\tget target(): glm.vec3 {\r\n\t\treturn this.N;\r\n\t}\r\n\tset up(up: glm.vec3) {\r\n\t\tthis.Up = glm.normalize(up);\r\n\t\tthis.rotateModified = true;\r\n\t}\r\n\tget up(): glm.vec3 {\r\n\t\treturn this.Up;\r\n\t}\r\n\trotate(angle: glm.vec3) {\r\n\t\tthis.N = glm.rotate(angle.z, this.Up)[\"*\"](glm.vec4(this.N, 0)).xyz;\r\n\t\tlet U = glm.cross(this.N, this.Up);\r\n\t\tthis.N = glm.rotate(angle.y, U)[\"*\"](glm.vec4(this.N, 0)).xyz;\r\n\t\tthis.Up = glm.rotate(angle.x, this.N)[\"*\"](glm.vec4(this.Up, 0)).xyz;\r\n\t\tthis.rotateModified = true;\r\n\t}\r\n\ttranslate(diff: glm.vec3) {\r\n\t\tlet U = glm.normalize(glm.cross(this.N, this.Up));\r\n\t\tlet V = glm.cross(U, this.N);\r\n\t\tthis.P[\"+=\"](this.N[\"*\"](diff.x)[\"+\"](U[\"*\"](-diff.y))[\"+\"](V[\"*\"](diff.z)));\r\n\t\tthis.translateModified = true;\r\n\t}\r\n\tset position(position: glm.vec3) {\r\n\t\tthis.P = position;\r\n\t\tthis.translateModified = true;\r\n\t}\r\n\tget position(): glm.vec3 {\r\n\t\treturn this.P;\r\n\t}\r\n\tgetCameraPosition(): glm.vec3 {\r\n\t\treturn this.P;\r\n\t}\r\n\tgetView(): glm.mat4 {\r\n\t\tif (this.translateModified || this.rotateModified) {\r\n\t\t\tif (this.translateModified) {\r\n\t\t\t\tthis.translateModified = false;\r\n\t\t\t\tthis.translateTrans = glm.mat4(\r\n\t\t\t\t\t1, 0, 0, 0,\r\n\t\t\t\t\t0, 1, 0, 0,\r\n\t\t\t\t\t0, 0, 1, 0,\r\n\t\t\t\t\t-this.P.x, -this.P.y, -this.P.z, 1\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tif (this.rotateModified) {\r\n\t\t\t\tthis.rotateModified = false;\r\n\t\t\t\tlet U = glm.normalize(glm.cross(this.N, this.Up));\r\n\t\t\t\tlet V = glm.cross(U, this.N);\r\n\t\t\t\tthis.rotateTrans = glm.mat4(\r\n\t\t\t\t\tU.x, V.x, -this.N.x, 0, \r\n\t\t\t\t\tU.y, V.y, -this.N.y, 0,\r\n\t\t\t\t\tU.z, V.z, -this.N.z, 0,\r\n\t\t\t\t\t0, 0, 0, 1\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tthis.trans = this.rotateTrans[\"*\"](this.translateTrans);\r\n\t\t}\r\n\t\treturn this.trans;\r\n\t}\r\n\tgetTrans(): glm.mat4 {\r\n\t\treturn this.getView();\r\n\t}\r\n\tuse() {\r\n\t\tViewport.viewports.push(this);\r\n\t\tgl.viewport(this.left, this.top, this.width, this.height);\r\n\t}\r\n\tunuse() {\r\n\t\tif (Viewport.viewports.length) {\r\n\t\t\tViewport.viewports.pop();\r\n\t\t\tif (Viewport.viewports.length) {\r\n\t\t\t\tlet self = Viewport.viewports[Viewport.viewports.length - 1];\r\n\t\t\t\tgl.viewport(self.left, self.top, self.width, self.height);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tprotected viewModified(): boolean {\r\n\t\treturn this.translateModified || this.rotateModified;\r\n\t}\r\n\tprotected modified(): boolean {\r\n\t\treturn this.viewModified();\r\n\t}\r\n}\r\n\r\nclass PerspectiveViewport extends Viewport {\r\n\tprotected perspectiveTrans: glm.mat4;\r\n\tprotected viewportTrans: glm.mat4;\r\n\t\r\n\tprotected perspectiveModified = true;\r\n\t\r\n\tprotected fwhratio: number;\r\n\tprotected ffov = glm.radians(45);\r\n\tprotected fzNear = 2e-2;\r\n\tprotected fzFar = 8e2;\r\n\r\n\tconstructor();\r\n\tconstructor(left: number, top: number, width: number, height: number);\r\n\tconstructor(left?: number, top?: number, width?: number, height?: number) {\r\n\t\tsuper(left, top, width, height);\r\n\t\tthis.fwhratio = this.width / this.height;\r\n\t}\r\n\r\n\tgetPers(): glm.mat4 {\r\n\t\tif (this.persModified()) {\r\n\t\t\tthis.perspectiveModified = false;\r\n\t\t\tthis.perspectiveTrans = glm.perspective(this.ffov, \r\n\t\t\t\t\tthis.fwhratio, this.fzNear, this.fzFar);\r\n\t\t}\r\n\t\treturn this.perspectiveTrans;\r\n\t}\r\n\tgetTrans(): glm.mat4 {\r\n\t\tif (this.modified()) {\r\n\t\t\tthis.viewportTrans = this.getPers()[\"*\"](this.getView());\r\n\t\t}\r\n\t\treturn this.viewportTrans;\r\n\t}\r\n\tset whratio(value: number) {\r\n\t\tthis.fwhratio = value;\r\n\t\tthis.perspectiveModified = true;\r\n\t}\r\n\tget whratio(): number {\r\n\t\treturn this.fwhratio;\r\n\t}\r\n\tset fov(angle: number) {\r\n\t\tthis.ffov = angle;\r\n\t\tthis.perspectiveModified = true;\r\n\t}\r\n\tget fov(): number {\r\n\t\treturn this.ffov;\r\n\t}\r\n\tset zNear(z: number) {\r\n\t\tthis.fzNear = z;\r\n\t\tthis.perspectiveModified = true;\r\n\t}\r\n\tget zNear(): number {\r\n\t\treturn this.fzNear;\r\n\t}\r\n\tset zFar(z: number) {\r\n\t\tthis.fzFar = z;\r\n\t\tthis.perspectiveModified = true;\r\n\t}\r\n\tget zFar(): number {\r\n\t\treturn this.fzFar;\r\n\t}\r\n\tprotected persModified(): boolean {\r\n\t\treturn this.perspectiveModified;\r\n\t}\r\n\tprotected modified(): boolean {\r\n\t\treturn this.viewModified() || this.persModified();\r\n\t}\r\n}\r\n\r\nexport {\r\n\tViewport,\r\n\tPerspectiveViewport\r\n}\r\n","import { glm } from \"../util/glm\"\r\nimport { Viewport } from \"../gl/viewport\";\r\nimport { Shader, Uniform } from \"../gl/shader\";\r\nimport { gl, Renderer } from \"../renderer/renderer\";\r\n\r\nclass ObjBase {\r\n\tprivate P = glm.vec3(0, 0, 0);\r\n\tprivate S = glm.vec3(1, 1, 1);\r\n\tprivate R = glm.vec3(0, 0, 0);\r\n\t\r\n\tprivate translateModified = true;\r\n\tprivate scaleModified = true;\r\n\tprivate rotateModified = true;\r\n\t\r\n\tprivate translateTrans: glm.mat4;\r\n\tprivate scaleTrans: glm.mat4;\r\n\tprivate rotateTrans: glm.mat4;\r\n\r\n\tprivate trans: glm.mat4;\r\n\tprivate itrans: glm.mat4;\r\n\tprivate ntrans: glm.mat4;\r\n\r\n\tscaleIdentity() {\r\n\t\tthis.S = glm.vec3(1, 1, 1); \r\n\t\tthis.scaleModified = true;\t\t\r\n\t}\r\n\tscale(factor: number);\r\n\tscale(factor: glm.vec3);\r\n\tscale(factor: any) {\r\n\t\tthis.S[\"*=\"](factor);\r\n\t\tthis.scaleModified = true;\r\n\t}\r\n\tset scaleFactor(factor: glm.vec3) {\r\n\t\tif (typeof factor == \"number\") {\r\n\t\t\tthis.S = glm.vec3(factor, factor, factor);\r\n\t\t} else {\r\n\t\t\tthis.S = factor;\r\n\t\t}\r\n\t\tthis.scaleModified = true;\r\n\t}\r\n\ttranslateIdentity() {\r\n\t\tthis.P = glm.vec3(0, 0, 0);\r\n\t\tthis.translateModified = true;\r\n\t}\r\n\ttranslate(diff: glm.vec3) {\r\n\t\tthis.P[\"+=\"](diff);\r\n\t\tthis.translateModified = true;\r\n\t}\r\n\tget position(): glm.vec3 {\r\n\t\treturn this.P;\r\n\t}\r\n\tset position(pos: glm.vec3) {\r\n\t\tthis.P = pos;\r\n\t\tthis.translateModified = true;\r\n\t}\r\n\trotateIdentity();\r\n\trotateIdentity(mask: glm.vec3);\r\n\trotateIdentity(mask?: glm.vec3) {\r\n\t\tif (mask) {\r\n\t\t\tthis.R = this.R[\"*\"](mask);\r\n\t\t} else {\r\n\t\t\tthis.R = glm.vec3(0, 0, 0);\r\n\t\t}\r\n\t\tthis.rotateModified = true;\r\n\t}\r\n\trotate(angle: glm.vec3) {\r\n\t\tthis.R[\"+=\"](angle);\r\n\t\tthis.rotateModified = true;\r\n\t}\r\n\tprivate updateTrans() {\r\n\t\tif (this.translateModified || this.scaleModified || this.rotateModified) {\r\n\t\t\tif (this.translateModified) {\r\n\t\t\t\tthis.translateModified = false;\r\n\t\t\t\tthis.translateTrans = glm.mat4(\r\n\t\t\t\t\t1, 0, 0, 0,\r\n\t\t\t\t\t0, 1, 0, 0,\r\n\t\t\t\t\t0, 0, 1, 0,\r\n\t\t\t\t\tthis.P.x, this.P.y, this.P.z, 1\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tif (this.rotateModified) {\r\n\t\t\t\tthis.rotateModified = false;\r\n\t\t\t\tlet sinx = Math.sin(this.R.x), \r\n\t\t\t\t\tsiny = Math.sin(this.R.y), \r\n\t\t\t\t\tsinz = Math.sin(this.R.z),\r\n\t\t\t\t\tcosx = Math.cos(this.R.x), \r\n\t\t\t\t\tcosy = Math.cos(this.R.y), \r\n\t\t\t\t\tcosz = Math.cos(this.R.z),\r\n\t\t\t\t\tsycz = siny * cosz, sysz = siny * sinz;\r\n\t\t\t\tthis.rotateTrans = glm.mat4(\r\n\t\t\t\t\tcosz * cosy         , sinz * cosy         , siny     , 0,\r\n\t\t\t\t\t-cosx*sinz-sinx*sycz, cosx*cosz-sinx*sysz , sinx*cosy, 0,\r\n\t\t\t\t\tsinx*sinz-cosx*sycz , -sinx*cosz-cosx*sysz, cosx*cosy, 0,\r\n\t\t\t\t\t0                   , 0                   , 0        , 1\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tif (this.scaleModified) {\r\n\t\t\t\tthis.scaleModified = false;\r\n\t\t\t\tthis.scaleTrans = glm.mat4(\r\n\t\t\t\t\tthis.S.x, 0, 0, 0,\r\n\t\t\t\t\t0, this.S.y, 0, 0,\r\n\t\t\t\t\t0, 0, this.S.z, 0,\r\n\t\t\t\t\t0, 0, 0, 1\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tthis.ntrans = this.translateTrans[\"*\"](this.rotateTrans);\r\n\t\t\tthis.trans = this.ntrans[\"*\"](this.scaleTrans);\r\n\t\t\tthis.itrans = glm.inverse(this.ntrans);\r\n\t\t}\r\n\t}\r\n\tgetTrans(): glm.mat4 {\r\n\t\tthis.updateTrans();\r\n\t\treturn this.trans;\r\n\t} \r\n\tgetSpace(): glm.mat4 {\r\n\t\tthis.updateTrans();\r\n\t\treturn this.itrans;\r\n\t} \r\n\tgetTrival(): glm.mat4 {\r\n\t\tthis.updateTrans();\r\n\t\treturn this.ntrans;\r\n\t}\r\n}\r\n\r\nexport default abstract class Obj extends ObjBase {\r\n\tstatic gWVP: Uniform = Shader.uniform(\"mat4\", \"gWVP\");\r\n\tstatic gWorld: Uniform = Shader.uniform(\"mat4\", \"gWorld\");\r\n\tstatic gV: Uniform = Shader.uniform(\"mat4\", \"gV\");\r\n\tstatic gWV: Uniform = Shader.uniform(\"mat4\", \"gWV\");\r\n\tstatic gVP: Uniform = Shader.uniform(\"mat4\", \"gVP\");\r\n\tstatic gCameraWorldPos: Uniform = Shader.uniform(\"vec3\", \"gCameraWorldPos\");\r\n\tstatic gTime: Uniform = Shader.uniform(\"float\", \"gTime\");\r\n\r\n\tprotected defaultShader: Shader = null;\r\n\r\n\tsetBasicUniforms(viewport: Viewport) {\r\n\t\tObj.gWVP.set(viewport.getTrans()[\"*\"](this.getTrans()));\r\n\t\tObj.gWorld.set(this.getTrans());\r\n\t\tObj.gWV.set(viewport.getView()[\"*\"](this.getTrans()));\r\n\t\tObj.gV.set(viewport.getView());\r\n\t\tObj.gVP.set(viewport.getTrans());\r\n\t\tObj.gCameraWorldPos.set(viewport.getCameraPosition());\r\n\t\tObj.gTime.set(Renderer.time);\r\n\t}\r\n\tabstract render(viewport: Viewport);\r\n\tbindShader() {\r\n\t\tif (this.defaultShader) {\r\n\t\t\tthis.defaultShader.use();\r\n\t\t}\r\n\t}\r\n\tunbindShader() {\r\n\t\tif (this.defaultShader) {\r\n\t\t\tthis.defaultShader.unuse();\r\n\t\t}\r\n\t}\r\n}\r\n","import { Terrain } from \"./terrain\";\r\nimport { Viewport } from \"../gl/viewport\";\r\nimport { Shader } from \"../gl/shader\";\r\nimport { GerstnerWave } from \"./gerstnerWave\";\r\nimport { Communicators, Communicator } from \"../gl/communicator\";\r\nimport { ulist_elem } from \"../util/ulist\";\r\nimport Material from \"../gl/material\";\r\nimport { VAO, VertexAttrs } from \"../gl/vertexAttrs\";\r\n\r\n\r\nclass Ocean extends Terrain {\r\n\tconstructor() {\r\n\t\tsuper(8, 64, 0.005);\r\n\t\tthis.defaultShader = Shader.create(\"ocean\", true);\r\n\t\t\r\n\t\tlet M = 64, w = 0.005 * (1 << 8), W = w * M / 2;\r\n\t\tlet vertices = new VertexAttrs([\"pos2\"]);\r\n\t\tlet indices = [];\r\n\t\tlet pos2 = [];\r\n\t\tlet ipos = 0;\r\n\t\tlet dx = [1, 1, -1, -1], dy = [1, 0, 1, 0];\r\n\r\n\t\tlet y = -W;\r\n\t\twhile (M >>= 2) {\r\n\t\t\tfor (let j = 0; j < 4; ++j) {\r\n\t\t\t\tfor (let x = -W; x < W; x += 4 * w) {\r\n\t\t\t\t\tpos2[ipos + 0] = x + 0 * w; pos2[ipos + 1] = y - 0 * w;\r\n\t\t\t\t\tpos2[ipos + 2] = x + 1 * w; pos2[ipos + 3] = y - 0 * w;\r\n\t\t\t\t\tpos2[ipos + 4] = x + 2 * w; pos2[ipos + 5] = y - 0 * w;\r\n\t\t\t\t\tpos2[ipos + 6] = x + 3 * w; pos2[ipos + 7] = y - 0 * w;\r\n\t\t\t\t\tpos2[ipos + 8] = x + 4 * w; pos2[ipos + 9] = y - 0 * w;\r\n\t\t\t\t\tpos2[ipos + 10] = x + 0 * w; pos2[ipos + 11] = y - 1 * w;\r\n\t\t\t\t\tpos2[ipos + 12] = x + 4 * w; pos2[ipos + 13] = y - 1 * w;\r\n\r\n\t\t\t\t\tif (dy[j]) {\r\n\t\t\t\t\t\tfor (let k = 0; k < 14; k += 2) {\r\n\t\t\t\t\t\t\tpos2[ipos + k + 1] *= dx[j]; \r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tfor (let k = 0; k < 14; k += 2) {\r\n\t\t\t\t\t\t\tlet t = pos2[ipos + k + 1] * dx[j];\r\n\t\t\t\t\t\t\tpos2[ipos + k + 1] = pos2[ipos + k + 0];\r\n\t\t\t\t\t\t\tpos2[ipos + k + 0] = t;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet p = ipos >> 1;\r\n\t\t\t\t\tindices.push(\r\n\t\t\t\t\t\tp + 0, p + 1, p + 5,\r\n\t\t\t\t\t\tp + 1, p + 2, p + 5,\r\n\t\t\t\t\t\tp + 2, p + 6, p + 5,\r\n\t\t\t\t\t\tp + 2, p + 3, p + 6,\r\n\t\t\t\t\t\tp + 3, p + 4, p + 6\r\n\t\t\t\t\t);\r\n\t\t\t\t\tipos += 14;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tlet x = -W;\r\n\t\t\tlet fx = [1, 1, -1, -1], fy = [1, -1, 1, -1];\r\n\t\t\tfor (let i = 0; i < 4; ++i) {\r\n\t\t\t\tpos2[ipos + 0] = x - 0 * w; pos2[ipos + 1] = y - 0 * w;\r\n\t\t\t\tpos2[ipos + 2] = x - 0 * w; pos2[ipos + 3] = y - 1 * w;\r\n\t\t\t\tpos2[ipos + 4] = y - 0 * w; pos2[ipos + 5] = x - 0 * w;\r\n\t\t\t\tpos2[ipos + 6] = y - 1 * w; pos2[ipos + 7] = x - 0 * w;\r\n\r\n\t\t\t\tfor (let k = 0; k < 8; k += 2) {\r\n\t\t\t\t\tpos2[ipos + k + 0] *= fx[i]; \r\n\t\t\t\t\tpos2[ipos + k + 1] *= fy[i]; \r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet p = ipos >> 1;\r\n\t\t\t\tindices.push(\r\n\t\t\t\t\tp + 0, p + 1, p + 2,\r\n\t\t\t\t\tp + 1, p + 2, p + 3\r\n\t\t\t\t);\r\n\t\t\t\tipos += 8;\r\n\t\t\t}\r\n\r\n\t\t\ty -= w;\r\n\t\t\tw *= 4;\r\n\t\t}\r\n\r\n\t\tlet x = -W, inf = 5e4;\r\n\t\tpos2[ipos + 0] = -inf; pos2[ipos + 1] = -inf;\r\n\t\tpos2[ipos + 2] = inf; pos2[ipos + 3] = -inf;\r\n\t\tpos2[ipos + 4] = inf; pos2[ipos + 5] = inf;\r\n\t\tpos2[ipos + 6] = -inf; pos2[ipos + 7] = inf;\r\n\r\n\t\tpos2[ipos + 8] = x; pos2[ipos + 9] = y;\r\n\t\tpos2[ipos + 10] = -x; pos2[ipos + 11] = y;\r\n\t\tpos2[ipos + 12] = -x; pos2[ipos + 13] = -y;\r\n\t\tpos2[ipos + 14] = x; pos2[ipos + 15] = -y;\r\n\r\n\t\tpos2[ipos + 16] = y; pos2[ipos + 17] = x;\r\n\t\tpos2[ipos + 18] = -y; pos2[ipos + 19] = x;\r\n\t\tpos2[ipos + 20] = -y; pos2[ipos + 21] = -x;\r\n\t\tpos2[ipos + 22] = y; pos2[ipos + 23] = -x;\r\n\r\n\t\tlet p = ipos >> 1;\r\n\t\tindices.push(\r\n\t\t\tp + 0, p + 4, p + 8,\r\n\t\t\tp + 0, p + 4, p + 5,\r\n\t\t\tp + 1, p + 5, p + 0,\r\n\t\t\tp + 1, p + 5, p + 9,\r\n\t\t\tp + 1, p + 9, p + 10,\r\n\t\t\tp + 1, p + 10, p + 2,\r\n\t\t\tp + 2, p + 6, p + 10,\r\n\t\t\tp + 2, p + 6, p + 7,\r\n\t\t\tp + 2, p + 3, p + 7,\r\n\t\t\tp + 3, p + 0, p + 8,\r\n\t\t\tp + 3, p + 7, p + 11,\r\n\t\t\tp + 3, p + 8, p + 11\r\n\t\t);\r\n\t\t\r\n\t\tvertices.set(\"pos2\", pos2);\r\n\t\tthis.vao = new VAO(vertices, indices);\r\n\t}\r\n\r\n\trender(viewport: Viewport) {\r\n\t\tthis.setBasicUniforms(viewport);\r\n\t\tthis.gN.set(256);\r\n\t\tthis.mesh.bind();\r\n\t\t\tthis.mesh.draw();\r\n\t\tthis.mesh.unbind();\r\n\t\tthis.vao.bind();\r\n\t\t\tthis.vao.draw();\r\n\t\tthis.vao.unbind();\r\n\t}\r\n\r\n\tprivate gN = Shader.uniform(\"float\", \"gN\");\r\n\tprivate vao: VAO;\r\n}\r\n\r\nexport {\r\n\tOcean\r\n}\r\n","import Obj from \"./object\";\r\nimport { Viewport } from \"../gl/viewport\";\r\nimport { Shader } from \"../gl/shader\";\r\nimport { VAO, VertexAttrs } from \"../gl/vertexAttrs\";\r\n\r\nclass Skybox extends Obj {\r\n\tprivate vao: VAO;\r\n\r\n\tpublic readonly isSkybox = true;\r\n\t\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.defaultShader = Shader.create(\"skybox\", false);\r\n\t\tlet vertices = new VertexAttrs([\"pos3\"]);\r\n\t\tlet t = 4.2e2;\r\n\t\tvertices.set(\"pos3\",[\r\n\t\t\t-t, -t, -t, -t, -t, t, -t, t, -t, -t, t, t,\r\n\t\t\tt, -t, -t, t, -t, t, t, t, -t, t, t, t\r\n\t\t]);\r\n\t\tthis.vao = new VAO(vertices, [\r\n\t\t\t0, 1, 2, 1, 3, 2, 1, 7, 3, 1, 5, 7, 1, 0, 4,\r\n\t\t\t1, 4, 5, 3, 7, 6, 3, 6, 2, 0, 2, 6, 0, 6, 4,\r\n\t\t\t5, 4, 6, 5, 6, 7\r\n\t\t]);\r\n\t}\r\n\r\n\trender(viewport: Viewport) {\r\n\t\tthis.setBasicUniforms(viewport);\r\n\t\tthis.vao.bind();\r\n\t\t\tthis.vao.draw();\r\n\t\tthis.vao.unbind();\r\n\t}\r\n}\r\n\r\nexport {\r\n\tSkybox\r\n}\r\n","import Obj from \"./object\";\r\nimport { Viewport } from \"../gl/viewport\";\r\nimport { Shader } from \"../gl/shader\";\r\nimport { VAO, VertexAttrs } from \"../gl/vertexAttrs\";\r\nimport { gl } from \"../renderer/renderer\";\r\n\r\n\r\nabstract class Terrain extends Obj {\r\n\tprotected mesh: VAO;\r\n\r\n\tconstructor(C: number, M: number, w0: number) {\r\n\t\tsuper();\r\n\t\tlet vertices = new VertexAttrs([\"pos2\"]);\r\n\t\tlet indices = [];\r\n\t\tlet w = w0;\r\n\t\tlet offset = 0;\r\n\t\tlet line = M * 2 + 1;\r\n\t\tlet e = M;\r\n\t\tlet b = M;\r\n\t\tlet pos2 = []; pos2.length = C * (2 * M + 1) * (2 * M + 1) * 2;\r\n\t\tlet ipos = 0;\r\n\t\tfor (let k = 0; k != C; ++k) {\r\n\t\t\tfor (let i = -M; i <= M; ++i) {\r\n\t\t\t\tfor (let j = -M; j <= M; ++j) {\r\n\t\t\t\t\tpos2[ipos++] = j * w; pos2[ipos++] = i * w;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (let i = 1; i != line - 2; ++i) {\r\n\t\t\t\tfor (let j = 1; j != line - 2; ++j) {\r\n\t\t\t\t\tif (i < e || i >= b || j < e || j >= b) {\r\n\t\t\t\t\t\tlet lt = offset + i * line + j;\r\n\t\t\t\t\t\tindices.push(lt, lt + 1, lt + line + 1, \r\n\t\t\t\t\t\t\t\tlt, lt + line + 1, lt + line);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (let j = 2; j < line - 2; j += 2) {\r\n\t\t\t\tlet lt = offset + 0 * line + j;\r\n\t\t\t\tindices.push(lt, lt + line, lt + line - 1,\r\n\t\t\t\t\t\tlt, lt + line + 1, lt + line,\r\n\t\t\t\t\t\t\tlt, lt + 2, lt + 1 + line);\r\n\t\t\t}\r\n\t\t\tfor (let j = 2; j < line - 2; j += 2) {\r\n\t\t\t\tlet lt = offset + (line - 1) * line + j;\r\n\t\t\t\tindices.push(lt, lt - line - 1, lt - line,\r\n\t\t\t\t\t\tlt, lt - line, lt - line + 1,\r\n\t\t\t\t\t\t\tlt, lt + 1 - line, lt + 2);\r\n\t\t\t}\r\n\t\t\tfor (let i = 2; i < line - 2; i += 2) {\r\n\t\t\t\tlet lt = offset + i * line + 0;\r\n\t\t\t\tindices.push(lt, lt + 1 - line, lt + 1,\r\n\t\t\t\t\t\tlt, lt + 1, lt + 1 + line,\r\n\t\t\t\t\t\t\tlt, lt + 1 + line, lt + 2 * line);\r\n\t\t\t}\r\n\t\t\tfor (let i = 2; i < line - 2; i += 2) {\r\n\t\t\t\tlet lt = offset + i * line + (line - 1);\r\n\t\t\t\tindices.push(lt, lt - 1, lt - 1 - line,\r\n\t\t\t\t\t\tlt, lt - 1 + line, lt - 1,\r\n\t\t\t\t\t\t\tlt, lt + 2 * line, lt - 1 + line);\r\n\t\t\t}\r\n\r\n\t\t\tlet lt = offset;\r\n\t\t\tindices.push(lt, lt + 2, lt + 1 + line, \r\n\t\t\t\tlt, lt + 1 + line, lt + 2 * line);\r\n\t\t\tlt = offset + (line - 1);\r\n\t\t\tindices.push(lt, lt - 1 + line, lt + 2 * line);\r\n\t\t\tlt = offset + line * (line - 1);\r\n\t\t\tindices.push(lt, lt + 1 - line, lt + 2);\r\n\t\t\t\r\n\t\t\tw *= 2;\r\n\t\t\toffset += (M * 2 + 1) * (M * 2 + 1);\r\n\t\t\te = M / 2;\r\n\t\t\tb = 3 * M / 2;\r\n\t\t}\r\n\t\t\r\n\t\tvertices.set(\"pos2\", pos2);\r\n\t\t\r\n\t\tthis.mesh = new VAO(vertices, indices);\r\n\t}\r\n\t\r\n\tabstract render(viewport: Viewport);\r\n}\r\n\r\nexport {\r\n\tTerrain\r\n}\r\n","import { ulist_elem, ulist } from \"../util/ulist\"\r\n\r\nclass Event {\r\n\tconstructor(private event: any, private elem: ulist_elem<any>)\r\n\t{\r\n\t}\r\n\tcancel() {\r\n\t\tdocument.removeEventListener(this.event, this.elem.get());\r\n\t\tthis.elem.remove();\r\n\t}\r\n}\r\n\r\nclass EventList {\r\n\tprivate events = new ulist<any>();\r\n\r\n\taddEvent(event: any, callback: any): Event {\r\n\t\tdocument.addEventListener(event, callback);\r\n\t\treturn new Event(event, this.events.push(callback));\r\n\t}\r\n}\r\n\r\nexport {\r\n\tEvent,\r\n\tEventList\r\n}\r\n","import { ulist_elem, ulist } from \"../util/ulist\"\r\nimport { Event, EventList } from \"./events\"\r\n\r\nlet gl: WebGLRenderingContext\r\nlet gl2: WebGL2RenderingContext\r\nlet ext: { [key: string]: any } = {}\r\n\r\ntype RendererEventType = \"render\" | keyof DocumentEventMap\r\n\r\ninterface RendererEvent {\r\n\tcancel: () => void;\r\n}\r\n\r\nclass RenderEvent {\r\n\tconstructor(private elem: ulist_elem<any>)\r\n\t{\r\n\t}\r\n\tcancel() {\r\n\t\tthis.elem.remove();\r\n\t}\r\n}\r\n\r\nclass Renderer {\r\n\tprotected static context: Renderer = null;\r\n\tprotected static fprevTime: number = 0;\r\n\r\n\tprotected fps: number = 0;\r\n\tprotected events = new EventList();\r\n\tprotected renderers = new ulist<() => void>();\r\n\tpublic readonly canvas: HTMLCanvasElement;\r\n\tprotected canvasWrapper: HTMLDivElement;\r\n\tprotected animationRequest: number;\r\n\tprotected ftime: number = 0;\r\n\tprotected fltime: number = 0;\r\n\tprotected fprevTick: number = undefined;\r\n\r\n\tpublic fpause: boolean = false;\r\n\r\n\tpublic static timescale: number = 1;\r\n\r\n\tprivate static exts = {}\r\n\r\n\tconstructor(container: HTMLElement, fallback: boolean = false) {\r\n\t\tif (Renderer.context != null) {\r\n\t\t\tthrow \"Multiple WebGL contexts not supported.\";\r\n\t\t} else {\r\n\t\t\tthis.canvasWrapper = document.createElement(\"div\");\r\n\t\t\tthis.canvas = document.createElement(\"canvas\");\r\n\t\t\tthis.canvasWrapper.style.width = \"100%\";\r\n\t\t\tthis.canvasWrapper.style.height = \"100%\";\r\n\t\t\tthis.canvas.width = container.clientWidth;\r\n\t\t\tthis.canvas.height = container.clientHeight;\r\n\t\t\tthis.canvasWrapper.appendChild(this.canvas);\r\n\t\t\tthis.canvasWrapper.style[\"text-align\"] = \"center\";\r\n\t\t\tthis.canvasWrapper.style[\"overflow\"] = \"hidden\";\r\n\t\t\tcontainer.appendChild(this.canvasWrapper);\r\n\t\t\ttry {\r\n\t\t\t\tfallback = fallback || (navigator.userAgent.indexOf(\"Mac OS X\") > 0);\r\n\t\t\t\tif (!fallback) {\r\n\t\t\t\t\tgl2 = <WebGL2RenderingContext>this.canvas.getContext(\"webgl2\");// || canvas.getContext(\"experimental-webgl\");\r\n\t\t\t\t}\r\n\t\t\t\tif (!gl2) {\r\n\t\t\t\t\tgl = <WebGLRenderingContext>this.canvas.getContext(\"webgl\") \r\n\t\t\t\t\t\t|| this.canvas.getContext(\"experimental-webgl\");\r\n\t\t\t\t\tif (!gl) {\r\n\t\t\t\t\t\tthrow \"\";\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.warn(\"webgl 2.0 is not supported on your browser, fallback to webgl 1.0.\");\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tgl = gl2;\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(\"webgl is not supported on your browser. \" + e);\r\n\t\t\t\tthrow \"webgl is not supported on your browser. \" + e;\r\n\t\t\t}\r\n\t\t}\r\n\t\tRenderer.context = this;\r\n\t}\r\n\r\n\tstatic get instance(): Renderer {\r\n\t\tif (Renderer.context) {\r\n\t\t\treturn Renderer.context;\r\n\t\t} else {\r\n\t\t\tthrow \"no current renderer.\";\r\n\t\t}\r\n\t}\r\n\tdispatch(eventType: RendererEventType, callback: any): RendererEvent {\r\n\t\tif (eventType == \"render\") {\r\n\t\t\treturn new RenderEvent(this.renderers.push(callback));\r\n\t\t} else {\r\n\t\t\treturn this.events.addEvent(eventType, callback);\r\n\t\t}\r\n\t}\r\n\tstart() {\r\n\t\tthis.animationRequest = window.requestAnimationFrame(this.render.bind(this));\r\n\t}\r\n\t\r\n\tstatic get time(): number {\r\n\t\treturn Renderer.instance.ftime;\r\n\t}\r\n\tstatic get prevTime(): number {\r\n\t\treturn Renderer.instance.fltime;\r\n\t}\r\n\tstatic get dt(): number {\r\n\t\treturn Renderer.instance.ftime - Renderer.instance.fltime;\r\n\t}\r\n\r\n\tstatic resetClock() {\r\n\t\tRenderer.instance.ftime = 0;\r\n\t\tRenderer.instance.fltime = 0;\r\n\t}\r\n\tstatic pauseClock() {\r\n\t\tRenderer.instance.fpause = true;\r\n\t}\r\n\tstatic continueClock() {\r\n\t\tRenderer.instance.fpause = false;\r\n\t}\r\n\tstatic get pause(): boolean {\r\n\t\treturn Renderer.instance.fpause;\r\n\t}\r\n\r\n\tprivate render(time: number) {\r\n\t\ttime /= 1000;\r\n\t\tif (this.fprevTick != undefined) {\r\n\t\t\t// console.log(Renderer.timescale);\r\n\t\t\tif (!this.fpause) {\r\n\t\t\t\tthis.fltime = this.ftime;\r\n\t\t\t\tthis.ftime += Renderer.timescale * (time - this.fprevTick);\r\n\t\t\t}\r\n\t\t\tthis.renderers.visit((e: ulist_elem<() => void>) => {\r\n\t\t\t\ttry {\r\n\t\t\t\t\te.get()();\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (Math.floor(time) > Renderer.fprevTime) {\r\n\t\t\t\tconsole.log(\"fps:\", this.fps + 1);\r\n\t\t\t\tRenderer.fprevTime = Math.floor(time);\r\n\t\t\t\tthis.fps = 0;\r\n\t\t\t}\r\n\t\t\tthis.fps += 1;\r\n\t\t}\r\n\t\tthis.fprevTick = time;\r\n\t\tthis.animationRequest = window.requestAnimationFrame(this.render.bind(this));\r\n\t}\r\n\r\n\tstatic require(exts: string[]): boolean;\r\n\tstatic require(exts: string): boolean;\r\n\tstatic require(exts: any): boolean {\r\n\t\tif (typeof exts == \"string\") {\r\n\t\t\tif (!(exts in Renderer.exts)) {\r\n\t\t\t\tif (Renderer.exts[exts] = gl.getExtension(exts)) {\r\n\t\t\t\t\text[exts] = Renderer.exts[exts];\r\n\t\t\t\t\t// for (let x in Renderer.exts[exts]) {\r\n\t\t\t\t\t// \text[x] = Renderer.exts[exts][x];\r\n\t\t\t\t\t// }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn !!Renderer.exts[exts];\r\n\t\t} else {\r\n\t\t\tfor (let e of exts) {\r\n\t\t\t\tif (!(e in Renderer.exts)) {\r\n\t\t\t\t\tif (Renderer.exts[e] = gl.getExtension(e)) {\r\n\t\t\t\t\t\text[e] = Renderer.exts[e];\r\n\t\t\t\t\t\t// for (let x in Renderer.exts[e]) {\r\n\t\t\t\t\t\t// \text[x] = Renderer.exts[e][x];\r\n\t\t\t\t\t\t// }\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!Renderer.exts[e]) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\trequire(exts: string[]): boolean;\r\n\trequire(exts: string): boolean;\r\n\trequire(exts: any): boolean {\r\n\t\treturn Renderer.require(exts);\r\n\t}\r\n}\r\n\r\nexport {\r\n\tgl,\r\n\tgl2,\r\n\text,\r\n\tRendererEvent,\r\n\tRenderer\r\n}\r\n","import { PostProcess } from \"./postProcess\";\r\nimport { Shader } from \"../gl/shader\";\r\nimport { Texture2D } from \"../gl/texture\";\r\nimport { gl2, gl, Renderer } from \"../renderer/renderer\";\r\nimport { Offscreen } from \"../gl/offscreen\";\r\n\r\nclass FFTWave extends PostProcess {\r\n\tprivate N: number;\r\n\r\n\tconstructor(private spectrum: Texture2D) {\r\n\t\tsuper(Shader.create(\"fftsrc\", false));\r\n\t\tif (spectrum.width != spectrum.height) {\r\n\t\t\tthrow \"FFT spectrum must be square.\";\r\n\t\t}\r\n\t\tthis.N = spectrum.width;\r\n\t\tif (Math.pow(2, Math.log2(this.N)) != this.N) {\r\n\t\t\tthrow \"FFT size must be 2^k\";\r\n\t\t}\r\n\t\tif (!gl2) {\r\n\t\t\tthrow \"webgl 2.0 required.\";\r\n\t\t}\r\n\t\tthis.displacement = new Texture2D({\r\n\t\t\tcomponent: gl.RGBA, type: gl.FLOAT, wrap: gl.REPEAT, filter: gl.LINEAR\r\n\t\t}, this.N, this.N);\r\n\t\tfor (let i = 0; i != 3; ++i) {\r\n\t\t\tthis.textureA[i] = new Texture2D({ \r\n\t\t\t\tcomponent: gl2.RG, type: gl.FLOAT, wrap: gl.REPEAT, filter: gl.NEAREST\r\n\t\t\t}, this.N, this.N);\r\n\t\t}\r\n\t\tfor (let i = 0; i != 3; ++i) {\r\n\t\t\tthis.textureB[i] = new Texture2D({ \r\n\t\t\t\tcomponent: gl2.RG, type: gl.FLOAT, wrap: gl.REPEAT, filter: gl.NEAREST\r\n\t\t\t}, this.N, this.N);\r\n\t\t}\r\n\t}\r\n\tprivate bindTextures() {\r\n\t\tfor (let i = 0; i != 3; ++i) {\r\n\t\t\tthis.offscreen.set(gl.COLOR_ATTACHMENT0 + i, this.textureB[i]);\r\n\t\t\tgl.activeTexture(gl.TEXTURE0 + this.channel[i]);\r\n\t\t\tgl.bindTexture(gl.TEXTURE_2D, this.textureA[i].handle);\r\n\t\t\tthis.gPrev[i].set(this.channel[i]);\r\n\t\t}\r\n\t}\r\n\trender() {\r\n\t\tgl.disable(gl.DEPTH_TEST);\r\n\t\tgl.viewport(0, 0, this.N, this.N);\r\n\t\tthis.offscreen.bind();\r\n\t\t\tthis.channel = [ \r\n\t\t\t\tTexture2D.genChannel(), \r\n\t\t\t\tTexture2D.genChannel(), \r\n\t\t\t\tTexture2D.genChannel()\r\n\t\t\t];\r\n\t\t\tthis.vao.bind();\r\n\t\t\t\t// open MRT\r\n\t\t\t\tgl2.drawBuffers([\r\n\t\t\t\t\tgl.COLOR_ATTACHMENT0, \r\n\t\t\t\t\tgl2.COLOR_ATTACHMENT1,\r\n\t\t\t\t\tgl2.COLOR_ATTACHMENT2\r\n\t\t\t\t]);\r\n\t\t\t\t// generate channels: H(t), Dx(t), Dy(t)\r\n\t\t\t\tthis.fsrc.use();\r\n\t\t\t\t\tfor (let i = 0; i != 3; ++i) {\r\n\t\t\t\t\t\tthis.offscreen.set(gl.COLOR_ATTACHMENT0 + i, this.textureA[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgl.activeTexture(gl.TEXTURE0 + this.channel[0]);\r\n\t\t\t\t\tgl.bindTexture(gl.TEXTURE_2D, this.spectrum.handle);\r\n\t\t\t\t\tthis.gSpectrum.set(this.channel[0]);\r\n\t\t\t\t\tthis.gTime.set(Renderer.time);\r\n\t\t\t\t\tthis.vao.draw();\r\n\t\t\t\tthis.fsrc.unuse();\r\n\t\t\t\t// vertical bit-reversal copy\r\n\t\t\t\tthis.vrs.use();\r\n\t\t\t\t\tthis.gN.set(this.N);\r\n\t\t\t\t\tthis.bindTextures();\r\n\t\t\t\t\tthis.vao.draw();\r\n\t\t\t\t\tthis.swapTextures();\r\n\t\t\t\tthis.vrs.unuse();\r\n\t\t\t\t// vertical FFT\r\n\t\t\t\tthis.vs.use();\r\n\t\t\t\t\tthis.gN.set(this.N);\r\n\t\t\t\t\tfor (let i = 1; i < this.N; i *= 2) {\r\n\t\t\t\t\t\tthis.gStep.set(i);\r\n\t\t\t\t\t\tthis.bindTextures();\r\n\t\t\t\t\t\tthis.vao.draw();\r\n\t\t\t\t\t\tthis.swapTextures();\r\n\t\t\t\t\t}\r\n\t\t\t\tthis.vs.unuse();\r\n\t\t\t\t// horizontal bit-reversal copy\r\n\t\t\t\tthis.hrs.use();\r\n\t\t\t\t\tthis.gN.set(this.N);\r\n\t\t\t\t\tthis.bindTextures();\r\n\t\t\t\t\tthis.vao.draw();\r\n\t\t\t\t\tthis.swapTextures();\r\n\t\t\t\tthis.hrs.unuse();\r\n\t\t\t\t// horizontal FFT\r\n\t\t\t\tthis.hs.use();\r\n\t\t\t\t\tthis.gN.set(this.N);\r\n\t\t\t\t\tfor (let i = 1; i < this.N; i *= 2) {\r\n\t\t\t\t\t\tthis.gStep.set(i);\r\n\t\t\t\t\t\tthis.bindTextures();\r\n\t\t\t\t\t\tthis.vao.draw();\r\n\t\t\t\t\t\tthis.swapTextures();\r\n\t\t\t\t\t}\r\n\t\t\t\tthis.hs.unuse();\r\n\t\t\t\t// combine H, Dx, Dy into displacement map\r\n\t\t\t\tthis.fend.use();\r\n\t\t\t\t\tthis.gN.set(this.N);\r\n\t\t\t\t\tthis.bindTextures();\r\n\t\t\t\t\tthis.offscreen.set(gl.COLOR_ATTACHMENT0, this.displacement);\r\n\t\t\t\t\tthis.vao.draw();\r\n\t\t\t\tthis.fend.unuse();\r\n\t\t\t\t// close MRT\r\n\t\t\t\tgl2.drawBuffers([\r\n\t\t\t\t\tgl.COLOR_ATTACHMENT0\r\n\t\t\t\t]);\r\n\t\t\tthis.vao.unbind();\r\n\t\t\tfor (let i = 0; i != 3; ++i) {\r\n\t\t\t\tTexture2D.restoreChannel(this.channel[i]);\r\n\t\t\t}\r\n\t\tthis.offscreen.unbind();\r\n\t\tgl.viewport(0, 0, Renderer.instance.canvas.width, Renderer.instance.canvas.height);\r\n\t\tgl.enable(gl.DEPTH_TEST);\r\n\t}\r\n\r\n\tget texture(): Texture2D {\r\n\t\treturn this.displacement;\r\n\t}\r\n\r\n\tget textures(): Texture2D[] {\r\n\t\treturn this.textureA;\r\n\t}\r\n\r\n\tprivate swapTextures() {\r\n\t\tlet t = this.textureA; this.textureA = this.textureB; this.textureB = t;\r\n\t}\r\n\r\n\tprivate textureA: Texture2D[] = [];\r\n\tprivate textureB: Texture2D[] = [];\r\n\r\n\tprivate displacement: Texture2D;\r\n\r\n\tprivate channel: number[];\r\n\r\n\tprivate offscreen = new Offscreen();\r\n\r\n\tprivate gN = Shader.uniform(\"float\", \"gN\");\r\n\tprivate gStep = Shader.uniform(\"float\", \"gStep\");\r\n\tprivate gPrev = [ \r\n\t\tShader.uniform(\"int\", \"gPrevH\"), \r\n\t\tShader.uniform(\"int\", \"gPrevDx\"),\r\n\t\tShader.uniform(\"int\", \"gPrevDy\")\r\n\t];\r\n\tprivate gSpectrum = Shader.uniform(\"int\", \"gSpectrum\");\r\n\tprivate gTime = Shader.uniform(\"float\", \"gTime\");\r\n\r\n\tprivate fsrc = Shader.create(\"fftsrc\", false);\r\n\tprivate vs = Shader.create(\"fftv\", false);\r\n\tprivate hs = Shader.create(\"ffth\", false);\r\n\tprivate vrs = Shader.create(\"fftvr\", false);\r\n\tprivate hrs = Shader.create(\"ffthr\", false);\r\n\tprivate fend = Shader.create(\"fftend\", false);\r\n}\r\n\r\nexport {\r\n\tFFTWave\r\n}","import { Viewport, PerspectiveViewport } from \"../gl/viewport\";\r\nimport { Communicator } from \"../gl/communicator\";\r\nimport { Offscreen, RenderBuffer } from \"../gl/offscreen\";\r\nimport { Shader, Uniform } from \"../gl/shader\";\r\nimport { gl, Renderer } from \"../renderer/renderer\";\r\nimport { TextureCube } from \"../gl/texture\";\r\nimport { glm } from \"../util/glm\"\r\nimport { VAO, VertexAttrs } from \"../gl/vertexAttrs\";\r\n\r\nclass AmbientCube {\r\n\tpublic readonly texture = new TextureCube({ component: gl.RGBA }, \r\n\t\tRenderer.instance.canvas.height / 2, Renderer.instance.canvas.height / 2);\r\n\tprivate viewport = new Viewport(0, 0, \r\n\t\tRenderer.instance.canvas.height / 2, Renderer.instance.canvas.height / 2);\r\n\tprivate flightDir: glm.vec3;\r\n\r\n\tconstructor() {\r\n\t\tlet vertices = new VertexAttrs([\"pos2\"]);\r\n\t\tvertices.set(\"pos2\", [\r\n\t\t\t-1, 1, 1, 1, 1, -1, -1, -1\r\n\t\t]);\r\n\t\tthis.vao = new VAO(vertices, [\r\n\t\t\t0, 1, 2, 0, 2, 3\r\n\t\t]);\r\n\t}\r\n\r\n\tsetTime(hour: number) {\r\n\t\tthis.dayTimeSec = 3600 * (hour - 12);\r\n\t}\r\n\r\n\trender() {\r\n\t\tlet refFactor = this.dayScale * Renderer.timescale / (24 * 60 * 0.08);\r\n\t\tif (refFactor > 6) {\r\n\t\t\trefFactor = 6;\r\n\t\t} else if (refFactor < 1 / 60) {\r\n\t\t\trefFactor = 1 / 60;\r\n\t\t}\r\n\t\tlet prevRenderFace = Math.floor(this.currRenderFace);\r\n\t\tthis.currRenderFace += refFactor;\r\n\r\n\t\tthis.dayTimeSec += this.dayScale * Renderer.dt; \r\n\r\n\t\tif (Math.floor(this.currRenderFace) > prevRenderFace) {\r\n\r\n\t\t\tthis.offscreen.bind();\r\n\t\t\t\tgl.disable(gl.DEPTH_TEST);\r\n\t\t\t\t\tthis.viewport.use();\r\n\t\t\t\t\t\tthis.shader.use();\r\n\t\t\t\t\t\t\tlet alpha = this.dayTimeSec * 2 * Math.PI / 24 / 3600;\r\n\r\n\t\t\t\t\t\t\tthis.gTime.set(Renderer.time);\r\n\t\t\t\t\t\t\tthis.gSunPos.set(glm.vec3(Math.sin(alpha), 0, Math.cos(alpha)));\r\n\t\t\t\t\t\t\tthis.flightDir = glm.vec3(-Math.sin(alpha), 0, -Math.cos(alpha));\r\n\r\n\t\t\t\t\t\t\t// for (let i = 0; i != 6; ++i) {\r\n\t\t\t\t\t\t\tfor (let i = prevRenderFace; i != Math.floor(this.currRenderFace); ++i) {\r\n\t\t\t\t\t\t\t\tthis.offscreen.set(gl.COLOR_ATTACHMENT0, this.texture, i % 6);\r\n\t\t\t\t\t\t\t\t// gl.clear(gl.COLOR_BUFFER_BIT);\r\n\t\t\t\t\t\t\t\tthis.gSpace.set(AmbientCube.spaceTrans[i % 6]);\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tthis.vao.bind();\r\n\t\t\t\t\t\t\t\tthis.vao.draw();\r\n\t\t\t\t\t\t\t\tthis.vao.unbind();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tthis.shader.unuse();\r\n\t\t\t\t\tthis.viewport.unuse();\r\n\t\t\t\tgl.enable(gl.DEPTH_TEST);\r\n\t\t\tthis.offscreen.unbind();\r\n\t\t}\r\n\r\n\t\tthis.currRenderFace %= 6;\r\n\t}\r\n\r\n\tget lightDir(): glm.vec3 {\r\n\t\treturn this.flightDir;\r\n\t}\r\n\r\n\tprivate offscreen = new Offscreen();\r\n\tprivate vao: VAO;\r\n\t\r\n\tprivate time: number = 0;\r\n\tprivate dayTimeSec: number = 0;\r\n\tprivate currRenderFace: number = 0;\r\n\t\r\n\tprivate gSpace: Uniform = Shader.uniform(\"mat4\", \"gSpace\");\r\n\tprivate gSunPos: Uniform = Shader.uniform(\"vec3\", \"gSunPos\");\r\n\tprivate gTime: Uniform = Shader.uniform(\"float\", \"gTime\");\r\n\t\r\n\tprivate shader = Shader.create(\"ambientCube\", false);\r\n\t\r\n\tprivate static spaceTrans = [\r\n\t\tglm.mat4( 0, 0, -1, 0, 0, -1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1 ),\r\n\t\tglm.mat4( 0, 0, 1, 0, 0, -1, 0, 0, 0, 0, 0, 0, -1, 0, 0, 1 ),\r\n\t\tglm.mat4( 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1 ),\r\n\t\tglm.mat4( 1, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, -1, 0, 1 ),\r\n\t\tglm.mat4( 1, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1 ),\r\n\t\tglm.mat4( -1, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, -1, 1 )\r\n\t];\r\n\r\n\tprivate dayScale: number = 24;\r\n}\r\n\r\nexport {\r\n\tAmbientCube\r\n}\r\n","import { PostProcess } from \"./postProcess\";\r\nimport { Shader } from \"../gl/shader\";\r\n\r\n\r\nclass DecodeImage extends PostProcess {\r\n\tconstructor() {\r\n\t\tsuper(Shader.create(\"decodeImage\", false));\r\n\t}\r\n}\r\n\r\nexport {\r\n\tDecodeImage\r\n}\r\n","import { PostProcess } from \"./postProcess\";\r\nimport { Shader } from \"../gl/shader\";\r\n\r\n\r\nclass DeferImage extends PostProcess {\r\n\tconstructor() {\r\n\t\tsuper(Shader.create(\"deferImage\", false));\r\n\t}\r\n}\r\n\r\nexport {\r\n\tDeferImage\r\n}\r\n","import { Shader } from \"../gl/shader\";\r\nimport { glm } from \"../util/glm\"\r\nimport { Renderer, gl } from \"../renderer/renderer\";\r\nimport { VAO, VertexAttrs } from \"../gl/vertexAttrs\";\r\nimport { Offscreen } from \"../gl/offscreen\";\r\nimport { Texture2D } from \"../gl/texture\";\r\n\r\nclass GaussBlur {\r\n\tprivate static vert: Shader;\r\n\tprivate static hori: Shader;\r\n\r\n\tprivate radius: number;\r\n\tprotected vao: VAO;\r\n\tprivate swapImage: Texture2D = new Texture2D();\r\n\r\n\tprivate offscreen = new Offscreen;\r\n\r\n\tconstructor() {\r\n\t\tGaussBlur.vert || (GaussBlur.vert = Shader.create(\"gaussBlurVert\", false));\r\n\t\tGaussBlur.hori || (GaussBlur.hori = Shader.create(\"gaussBlurHori\", false));\r\n\t\tlet vertices = new VertexAttrs([\"pos2\"]);\r\n\t\tvertices.set(\"pos2\", [\r\n\t\t\t-1, 1, 1, 1, 1, -1, -1, -1\r\n\t\t]);\r\n\t\tthis.vao = new VAO(vertices, [\r\n\t\t\t0, 1, 2, 0, 2, 3\r\n\t\t]);\r\n\t}\r\n\r\n\tsetRadius(radius: number) {\r\n\t\tthis.radius = radius;\r\n\t}\r\n\r\n\trender(texture: Texture2D, dest: Texture2D) {\r\n\t\tthis.offscreen.bind();\r\n\t\tthis.vao.bind();\r\n\t\t\tthis.offscreen.set(gl.COLOR_ATTACHMENT0, this.swapImage);\r\n\t\t\ttexture.use(\"Image\");\r\n\t\t\t\tGaussBlur.vert.use();\r\n\t\t\t\tthis.gRange.set(this.radius);\r\n\t\t\t\tthis.iResolution.set(glm.vec2(Renderer.instance.canvas.width,\r\n\t\t\t\t\tRenderer.instance.canvas.height));\r\n\t\t\t\tthis.vao.draw();\r\n\t\t\t\tGaussBlur.vert.unuse();\r\n\t\t\ttexture.unuse();\r\n\t\t\tthis.offscreen.set(gl.COLOR_ATTACHMENT0, dest);\r\n\t\t\tthis.swapImage.use(\"Image\");\r\n\t\t\t\tGaussBlur.hori.use();\r\n\t\t\t\tthis.gRange.set(this.radius);\r\n\t\t\t\tthis.iResolution.set(glm.vec2(Renderer.instance.canvas.width,\r\n\t\t\t\t\tRenderer.instance.canvas.height));\r\n\t\t\t\tthis.vao.draw();\r\n\t\t\t\tGaussBlur.hori.unuse();\r\n\t\t\tthis.swapImage.unuse();\r\n\t\tthis.vao.unbind();\r\n\t\tthis.offscreen.unbind();\r\n\t}\r\n\r\n\tprivate gRange = Shader.uniform(\"int\", \"gRange\");\r\n\tprivate iResolution = Shader.uniform(\"vec2\", \"iResolution\");\r\n}\r\n\r\nexport {\r\n\tGaussBlur\r\n}\r\n","import { PostProcess } from \"./postProcess\";\r\nimport { Shader } from \"../gl/shader\";\r\n\r\nclass Gaussian extends PostProcess {\r\n\tconstructor() {\r\n\t\tsuper(Shader.create(\"gaussian\", false));\r\n\t}\r\n}\r\n\r\nexport {\r\n\tGaussian\r\n}","import { PostProcess } from \"./postProcess\";\r\nimport { Shader } from \"../gl/shader\";\r\n\r\nclass Normal extends PostProcess {\r\n\tconstructor(public readonly N: number = 256) {\r\n\t\tsuper(Shader.create(\"normal\", false));\r\n\t}\r\n\r\n\tbeforeRender() {\r\n\t\tthis.gN.set(this.N);\r\n\t}\r\n\r\n\tprivate gN = Shader.uniform(\"float\", \"gN\");\r\n}\r\n\r\nexport {\r\n\tNormal\r\n}","import { PostProcess } from \"./postProcess\";\r\nimport { Shader } from \"../gl/shader\";\r\nimport { Renderer } from \"../renderer/renderer\";\r\n\r\nclass PerlinWave extends PostProcess {\r\n\tconstructor() {\r\n\t\tsuper(Shader.create(\"perlinWave\", false));\r\n\t}\r\n\r\n\tbeforeRender() {\r\n\t\tthis.gTime.set(Renderer.time);\r\n\t}\r\n\r\n\tprivate gTime = Shader.uniform(\"float\", \"gTime\");\r\n}\r\n\r\nexport {\r\n\tPerlinWave\r\n}\r\n","import { PostProcess } from \"./postProcess\";\r\nimport { Shader } from \"../gl/shader\";\r\n\r\nclass Phillips extends PostProcess {\r\n\tconstructor() {\r\n\t\tsuper(Shader.create(\"phillips\", false));\r\n\t}\r\n}\r\n\r\nexport {\r\n\tPhillips\r\n}","import { VAO, VertexAttrs } from \"../gl/vertexAttrs\";\r\nimport { Shader } from \"../gl/shader\";\r\nimport { gl } from \"../renderer/renderer\";\r\n\r\nclass PostProcess {\r\n\tprotected vao: VAO;\r\n\r\n\tconstructor(protected shader: Shader) {\r\n\t\tlet vertices = new VertexAttrs([\"pos2\"]);\r\n\t\tvertices.set(\"pos2\", [\r\n\t\t\t-1, 1, 1, 1, 1, -1, -1, -1\r\n\t\t]);\r\n\t\tthis.vao = new VAO(vertices, [\r\n\t\t\t0, 1, 2, 0, 2, 3\r\n\t\t]);\r\n\t}\r\n\trender() {\r\n\t\tthis.shader.use();\r\n\t\t\tthis.beforeRender();\r\n\t\t\tthis.vao.bind();\r\n\t\t\t\tthis.vao.draw();\r\n\t\t\tthis.vao.unbind();\r\n\t\t\tthis.afterRender();\r\n\t\tthis.shader.unuse();\r\n\t}\r\n\tbeforeRender() {}\r\n\tafterRender() {}\r\n}\r\n\r\nexport {\r\n\tPostProcess\r\n}\r\n","import { glm } from \"../util/glm\"\r\nimport { VAO, VertexAttrs } from \"../gl/vertexAttrs\";\r\nimport { Renderer } from \"../renderer/renderer\";\r\nimport { Shader } from \"../gl/shader\";\r\n\r\nclass Rect {\r\n\tprivate vao: VAO;\r\n\tprivate static shader: Shader;\r\n\r\n\tpublic displacement = glm.vec2(0);\r\n\r\n\tconstructor(opts: { [key: string]: any }) {\r\n\t\tlet attrs = new VertexAttrs([\"pos2\", \"tex2\"]);\r\n\t\tlet w = Renderer.instance.canvas.width;\r\n\t\tlet h = Renderer.instance.canvas.height;\r\n\t\tRect.shader = Rect.shader || Shader.create(\"rect\", false);\r\n\t\tattrs.set(\"pos2\", [\r\n\t\t\topts.left / w * 2 - 1, 1 - opts.top / h * 2,\r\n\t\t\t(opts.left + opts.width) / w * 2 - 1, 1 - opts.top / h * 2,\r\n\t\t\t(opts.left + opts.width) / w * 2 - 1, 1 - (opts.top + opts.height) / h * 2,\r\n\t\t\topts.left / w * 2 - 1, 1 - (opts.top + opts.height) / h * 2,\r\n\t\t]);\r\n\t\tattrs.set(\"tex2\", [\r\n\t\t\topts.tex[0], opts.tex[1], \r\n\t\t\topts.tex[2], opts.tex[3], \r\n\t\t\topts.tex[4], opts.tex[5], \r\n\t\t\topts.tex[6], opts.tex[7]\r\n\t\t]);\r\n\t\tthis.vao = new VAO(attrs, [\r\n\t\t\t0, 1, 2, 0, 2, 3\r\n\t\t]);\r\n\t}\r\n\r\n\trender() {\r\n\t\tthis.gDisplacement.set(this.displacement);\r\n\t\tthis.vao.bind();\r\n\t\t\tthis.vao.draw();\r\n\t\tthis.vao.unbind();\r\n\t}\r\n\r\n\tstatic bindShader() {\r\n\t\t!Rect.shader || Rect.shader.use();\r\n\t}\r\n\r\n\tstatic unbindShader() {\r\n\t\t!Rect.shader || Rect.shader.unuse();\r\n\t}\r\n\r\n\tprivate gDisplacement = Shader.uniform(\"vec2\", \"gDisplacement\");\r\n}\r\n\r\nexport {\r\n\tRect\r\n}","import { PostProcess } from \"./postProcess\";\r\nimport { Shader } from \"../gl/shader\";\r\n\r\nclass UV extends PostProcess {\r\n\tconstructor() {\r\n\t\tsuper(Shader.create(\"uv\", false));\r\n\t}\r\n}\r\n\r\nexport {\r\n\tUV\r\n}\r\n","import xhr from \"../util/xhr\"\r\n\r\nexport default class assets {\r\n\tstatic importObj(filename: string): any {\r\n\r\n\t}\r\n\tstatic importJson(filename: string): any {\r\n\t\ttry {\r\n\t\t\tlet src = xhr.getSync(filename);\r\n\t\t\treturn JSON.parse(src);\r\n\t\t} catch (e) {\r\n\t\t\tthrow \"failed to import asset due to previous errors: \" + e;\r\n\t\t}\r\n\t}\r\n\tstatic importObjAsync(filename: string, callback: (e: any) => void): any {\r\n\r\n\t}\r\n\tstatic importJsonAsync(filename: string, callback: (e: any) => void): any {\r\n\t\txhr.getAsync(filename, \"text\", (err: any, data: any) => {\r\n\t\t\tif (err) {\r\n\t\t\t\tthrow \"failed to import asset due to previous errors: \" + err;\r\n\t\t\t}\r\n\t\t\tcallback(JSON.parse(data));\r\n\t\t});\r\n\t}\r\n\tstatic import(filename: string): any {\r\n\t\tlet format = filename.substring(filename.lastIndexOf('.') + 1);\r\n\t\tformat = format.toLowerCase();\r\n\t\tswitch (format) {\r\n\t\t\tcase \"json\": return assets.importJson(filename);\r\n\t\t\tcase \"obj\": return assets.importObj(filename);\r\n\t\t\tdefault: throw \"unknown model format: \" + format;\r\n\t\t}\r\n\t}\r\n\tstatic importAsync(filename: string, callback: (e: any) => void) {\r\n\t\tlet format = filename.substring(filename.lastIndexOf('.') + 1);\r\n\t\tformat = format.toLowerCase();\r\n\t\tswitch (format) {\r\n\t\t\tcase \"json\": return assets.importJsonAsync(filename, callback);\r\n\t\t\tcase \"obj\": return assets.importObjAsync(filename, callback);\r\n\t\t\tdefault: throw \"unknown model format: \" + format;\r\n\t\t}\r\n\t}\r\n}\r\n","export default class asyncutil {\r\n\tstatic retrieve(N: number, get: (\r\n\t\t\tindex: number, \r\n\t\t\tcollect: (data: any) => void\r\n\t\t) => void,\r\n\t\tfinish: (\r\n\t\t\tdata: any[]\r\n\t\t) => void\r\n\t) {\r\n\t\tlet data = [];\r\n\t\tfor (let i = 0; i != N; ++i) {\r\n\t\t\tget(i, (x: any) => {\r\n\t\t\t\tdata[i] = x; --N > 0 || finish(data);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n}","/*! glm-js built 2017-04-02 11:34:38-04:00 | (c) humbletim | http://humbletim.github.io/glm-js */\r\nlet glm = (function declare_glmjs_glmatrix(globals, $GLM_log, $GLM_console_log) { var GLM, GLMAT, GLMAT_VERSION, GLMJS_PREFIX, $GLM_console_factory, glm; ArrayBuffer.exists;\r\n\t/*\r\n\t\r\n\t --------------------------------------------------------------------------\r\n\t glm-js | (c) humbletim | http://humbletim.github.io/glm-js\r\n\t --------------------------------------------------------------------------\r\n\t\r\n\t The MIT License (MIT)\r\n\t\r\n\t Copyright (c) 2015-2016 humbletim\r\n\t\r\n\t Permission is hereby granted, free of charge, to any person obtaining a copy\r\n\t of this software and associated documentation files (the \"Software\"), to deal\r\n\t in the Software without restriction, including without limitation the rights\r\n\t to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n\t copies of the Software, and to permit persons to whom the Software is\r\n\t furnished to do so, subject to the following conditions:\r\n\t\r\n\t The above copyright notice and this permission notice shall be included in all\r\n\t copies or substantial portions of the Software.\r\n\t\r\n\t THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n\t IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n\t FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n\t AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n\t LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n\t OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\r\n\t SOFTWARE.\r\n\t\r\n\t --------------------------------------------------------------------------\r\n\t gl-matrix | (c) Brandon Jones, Colin MacKenzie IV | http://glmatrix.net/\r\n\t --------------------------------------------------------------------------\r\n\t\r\n\t Copyright (c) 2013 Brandon Jones, Colin MacKenzie IV\r\n\t\r\n\t This software is provided 'as-is', without any express or implied\r\n\t warranty. In no event will the authors be held liable for any damages\r\n\t arising from the use of this software.\r\n\t\r\n\t Permission is granted to anyone to use this software for any purpose,\r\n\t including commercial applications, and to alter it and redistribute it\r\n\t freely, subject to the following restrictions:\r\n\t\r\n\t  1. The origin of this software must not be misrepresented; you must not\r\n\t\t claim that you wrote the original software. If you use this software\r\n\t\t in a product, an acknowledgment in the product documentation would be\r\n\t\t appreciated but is not required.\r\n\t\r\n\t  2. Altered source versions must be plainly marked as such, and must not\r\n\t\t be misrepresented as being the original software.\r\n\t\r\n\t  3. This notice may not be removed or altered from any source distribution.\r\n\t*/\r\n\tGLMAT={};GLMAT_VERSION=\"2.2.2\";\r\n\t(function(a){a.VERSION=GLMAT_VERSION;if(!b)var b=1E-6;if(!c)var c=\"undefined\"!==typeof Float32Array?Float32Array:Array;if(!e)var e=Math.random;var d={setMatrixArrayType:function(y){c=y}};\"undefined\"!==typeof a&&(a.glMatrix=d);var h=Math.PI/180;d.toRadian=function(y){return y*h};d={create:function(){var y=new c(2);y[0]=0;y[1]=0;return y},clone:function(y){var a=new c(2);a[0]=y[0];a[1]=y[1];return a},fromValues:function(y,a){var v=new c(2);v[0]=y;v[1]=a;return v},copy:function(y,a){y[0]=a[0];y[1]=a[1];\r\n\treturn y},set:function(y,a,v){y[0]=a;y[1]=v;return y},add:function(y,a,v){y[0]=a[0]+v[0];y[1]=a[1]+v[1];return y},subtract:function(y,a,v){y[0]=a[0]-v[0];y[1]=a[1]-v[1];return y}};d.sub=d.subtract;d.multiply=function(y,a,v){y[0]=a[0]*v[0];y[1]=a[1]*v[1];return y};d.mul=d.multiply;d.divide=function(y,a,v){y[0]=a[0]/v[0];y[1]=a[1]/v[1];return y};d.div=d.divide;d.min=function(y,a,v){y[0]=Math.min(a[0],v[0]);y[1]=Math.min(a[1],v[1]);return y};d.max=function(y,a,v){y[0]=Math.max(a[0],v[0]);y[1]=Math.max(a[1],\r\n\tv[1]);return y};d.scale=function(y,a,v){y[0]=a[0]*v;y[1]=a[1]*v;return y};d.scaleAndAdd=function(y,a,v,b){y[0]=a[0]+v[0]*b;y[1]=a[1]+v[1]*b;return y};d.distance=function(a,f){var v=f[0]-a[0],b=f[1]-a[1];return Math.sqrt(v*v+b*b)};d.dist=d.distance;d.squaredDistance=function(a,f){var v=f[0]-a[0],b=f[1]-a[1];return v*v+b*b};d.sqrDist=d.squaredDistance;d.length=function(a){var f=a[0];a=a[1];return Math.sqrt(f*f+a*a)};d.len=d.length;d.squaredLength=function(a){var f=a[0];a=a[1];return f*f+a*a};d.sqrLen=\r\n\td.squaredLength;d.negate=function(a,f){a[0]=-f[0];a[1]=-f[1];return a};d.inverse=function(a,f){a[0]=1/f[0];a[1]=1/f[1];return a};d.normalize=function(a,f){var v=f[0],b=f[1],v=v*v+b*b;0<v&&(v=1/Math.sqrt(v),a[0]=f[0]*v,a[1]=f[1]*v);return a};d.dot=function(a,f){return a[0]*f[0]+a[1]*f[1]};d.cross=function(a,f,v){f=f[0]*v[1]-f[1]*v[0];a[0]=a[1]=0;a[2]=f;return a};d.lerp=function(a,f,v,b){var c=f[0];f=f[1];a[0]=c+b*(v[0]-c);a[1]=f+b*(v[1]-f);return a};d.random=function(a,f){f=f||1;var v=2*e()*Math.PI;\r\n\ta[0]=Math.cos(v)*f;a[1]=Math.sin(v)*f;return a};d.transformMat2=function(a,f,v){var b=f[0];f=f[1];a[0]=v[0]*b+v[2]*f;a[1]=v[1]*b+v[3]*f;return a};d.transformMat2d=function(a,f,v){var b=f[0];f=f[1];a[0]=v[0]*b+v[2]*f+v[4];a[1]=v[1]*b+v[3]*f+v[5];return a};d.transformMat3=function(a,f,b){var c=f[0];f=f[1];a[0]=b[0]*c+b[3]*f+b[6];a[1]=b[1]*c+b[4]*f+b[7];return a};d.transformMat4=function(a,f,b){var c=f[0];f=f[1];a[0]=b[0]*c+b[4]*f+b[12];a[1]=b[1]*c+b[5]*f+b[13];return a};var j=d.create();d.forEach=function(a,\r\n\tf,b,c,d,e){f||(f=2);b||(b=0);for(c=c?Math.min(c*f+b,a.length):a.length;b<c;b+=f)j[0]=a[b],j[1]=a[b+1],d(j,j,e),a[b]=j[0],a[b+1]=j[1];return a};d.str=function(a){return\"vec2(\"+a[0]+\", \"+a[1]+\")\"};\"undefined\"!==typeof a&&(a.vec2=d);var g={create:function(){var a=new c(3);a[0]=0;a[1]=0;a[2]=0;return a},clone:function(a){var f=new c(3);f[0]=a[0];f[1]=a[1];f[2]=a[2];return f},fromValues:function(a,f,b){var P=new c(3);P[0]=a;P[1]=f;P[2]=b;return P},copy:function(a,f){a[0]=f[0];a[1]=f[1];a[2]=f[2];return a},\r\n\tset:function(a,f,b,c){a[0]=f;a[1]=b;a[2]=c;return a},add:function(a,f,b){a[0]=f[0]+b[0];a[1]=f[1]+b[1];a[2]=f[2]+b[2];return a},subtract:function(a,f,b){a[0]=f[0]-b[0];a[1]=f[1]-b[1];a[2]=f[2]-b[2];return a}};g.sub=g.subtract;g.multiply=function(a,f,b){a[0]=f[0]*b[0];a[1]=f[1]*b[1];a[2]=f[2]*b[2];return a};g.mul=g.multiply;g.divide=function(a,f,b){a[0]=f[0]/b[0];a[1]=f[1]/b[1];a[2]=f[2]/b[2];return a};g.div=g.divide;g.min=function(a,f,b){a[0]=Math.min(f[0],b[0]);a[1]=Math.min(f[1],b[1]);a[2]=Math.min(f[2],\r\n\tb[2]);return a};g.max=function(a,f,b){a[0]=Math.max(f[0],b[0]);a[1]=Math.max(f[1],b[1]);a[2]=Math.max(f[2],b[2]);return a};g.scale=function(a,f,b){a[0]=f[0]*b;a[1]=f[1]*b;a[2]=f[2]*b;return a};g.scaleAndAdd=function(a,f,b,c){a[0]=f[0]+b[0]*c;a[1]=f[1]+b[1]*c;a[2]=f[2]+b[2]*c;return a};g.distance=function(a,f){var b=f[0]-a[0],c=f[1]-a[1],d=f[2]-a[2];return Math.sqrt(b*b+c*c+d*d)};g.dist=g.distance;g.squaredDistance=function(a,f){var b=f[0]-a[0],c=f[1]-a[1],d=f[2]-a[2];return b*b+c*c+d*d};g.sqrDist=\r\n\tg.squaredDistance;g.length=function(a){var f=a[0],b=a[1];a=a[2];return Math.sqrt(f*f+b*b+a*a)};g.len=g.length;g.squaredLength=function(a){var f=a[0],b=a[1];a=a[2];return f*f+b*b+a*a};g.sqrLen=g.squaredLength;g.negate=function(a,f){a[0]=-f[0];a[1]=-f[1];a[2]=-f[2];return a};g.inverse=function(a,f){a[0]=1/f[0];a[1]=1/f[1];a[2]=1/f[2];return a};g.normalize=function(a,f){var b=f[0],c=f[1],d=f[2],b=b*b+c*c+d*d;0<b&&(b=1/Math.sqrt(b),a[0]=f[0]*b,a[1]=f[1]*b,a[2]=f[2]*b);return a};g.dot=function(a,f){return a[0]*\r\n\tf[0]+a[1]*f[1]+a[2]*f[2]};g.cross=function(a,f,b){var c=f[0],d=f[1];f=f[2];var e=b[0],l=b[1];b=b[2];a[0]=d*b-f*l;a[1]=f*e-c*b;a[2]=c*l-d*e;return a};g.lerp=function(a,f,b,c){var d=f[0],e=f[1];f=f[2];a[0]=d+c*(b[0]-d);a[1]=e+c*(b[1]-e);a[2]=f+c*(b[2]-f);return a};g.random=function(a,f){f=f||1;var b=2*e()*Math.PI,c=2*e()-1,d=Math.sqrt(1-c*c)*f;a[0]=Math.cos(b)*d;a[1]=Math.sin(b)*d;a[2]=c*f;return a};g.transformMat4=function(a,f,b){var c=f[0],d=f[1];f=f[2];var e=b[3]*c+b[7]*d+b[11]*f+b[15],e=e||1;a[0]=\r\n\t(b[0]*c+b[4]*d+b[8]*f+b[12])/e;a[1]=(b[1]*c+b[5]*d+b[9]*f+b[13])/e;a[2]=(b[2]*c+b[6]*d+b[10]*f+b[14])/e;return a};g.transformMat3=function(a,f,b){var c=f[0],d=f[1];f=f[2];a[0]=c*b[0]+d*b[3]+f*b[6];a[1]=c*b[1]+d*b[4]+f*b[7];a[2]=c*b[2]+d*b[5]+f*b[8];return a};g.transformQuat=function(a,f,b){var c=f[0],d=f[1],e=f[2];f=b[0];var l=b[1],x=b[2];b=b[3];var u=b*c+l*e-x*d,J=b*d+x*c-f*e,g=b*e+f*d-l*c,c=-f*c-l*d-x*e;a[0]=u*b+c*-f+J*-x-g*-l;a[1]=J*b+c*-l+g*-f-u*-x;a[2]=g*b+c*-x+u*-l-J*-f;return a};g.rotateX=\r\n\tfunction(a,f,b,c){var d=[],e=[];d[0]=f[0]-b[0];d[1]=f[1]-b[1];d[2]=f[2]-b[2];e[0]=d[0];e[1]=d[1]*Math.cos(c)-d[2]*Math.sin(c);e[2]=d[1]*Math.sin(c)+d[2]*Math.cos(c);a[0]=e[0]+b[0];a[1]=e[1]+b[1];a[2]=e[2]+b[2];return a};g.rotateY=function(a,f,b,c){var d=[],e=[];d[0]=f[0]-b[0];d[1]=f[1]-b[1];d[2]=f[2]-b[2];e[0]=d[2]*Math.sin(c)+d[0]*Math.cos(c);e[1]=d[1];e[2]=d[2]*Math.cos(c)-d[0]*Math.sin(c);a[0]=e[0]+b[0];a[1]=e[1]+b[1];a[2]=e[2]+b[2];return a};g.rotateZ=function(a,f,b,c){var d=[],e=[];d[0]=f[0]-\r\n\tb[0];d[1]=f[1]-b[1];d[2]=f[2]-b[2];e[0]=d[0]*Math.cos(c)-d[1]*Math.sin(c);e[1]=d[0]*Math.sin(c)+d[1]*Math.cos(c);e[2]=d[2];a[0]=e[0]+b[0];a[1]=e[1]+b[1];a[2]=e[2]+b[2];return a};var k=g.create();g.forEach=function(a,f,b,c,d,e){f||(f=3);b||(b=0);for(c=c?Math.min(c*f+b,a.length):a.length;b<c;b+=f)k[0]=a[b],k[1]=a[b+1],k[2]=a[b+2],d(k,k,e),a[b]=k[0],a[b+1]=k[1],a[b+2]=k[2];return a};g.str=function(a){return\"vec3(\"+a[0]+\", \"+a[1]+\", \"+a[2]+\")\"};\"undefined\"!==typeof a&&(a.vec3=g);var i={create:function(){var a=\r\n\tnew c(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a},clone:function(a){var f=new c(4);f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=a[3];return f},fromValues:function(a,f,b,d){var e=new c(4);e[0]=a;e[1]=f;e[2]=b;e[3]=d;return e},copy:function(a,f){a[0]=f[0];a[1]=f[1];a[2]=f[2];a[3]=f[3];return a},set:function(a,f,b,c,d){a[0]=f;a[1]=b;a[2]=c;a[3]=d;return a},add:function(a,f,b){a[0]=f[0]+b[0];a[1]=f[1]+b[1];a[2]=f[2]+b[2];a[3]=f[3]+b[3];return a},subtract:function(a,f,b){a[0]=f[0]-b[0];a[1]=f[1]-b[1];a[2]=f[2]-b[2];\r\n\ta[3]=f[3]-b[3];return a}};i.sub=i.subtract;i.multiply=function(a,f,b){a[0]=f[0]*b[0];a[1]=f[1]*b[1];a[2]=f[2]*b[2];a[3]=f[3]*b[3];return a};i.mul=i.multiply;i.divide=function(a,f,b){a[0]=f[0]/b[0];a[1]=f[1]/b[1];a[2]=f[2]/b[2];a[3]=f[3]/b[3];return a};i.div=i.divide;i.min=function(a,f,b){a[0]=Math.min(f[0],b[0]);a[1]=Math.min(f[1],b[1]);a[2]=Math.min(f[2],b[2]);a[3]=Math.min(f[3],b[3]);return a};i.max=function(a,f,b){a[0]=Math.max(f[0],b[0]);a[1]=Math.max(f[1],b[1]);a[2]=Math.max(f[2],b[2]);a[3]=\r\n\tMath.max(f[3],b[3]);return a};i.scale=function(a,f,b){a[0]=f[0]*b;a[1]=f[1]*b;a[2]=f[2]*b;a[3]=f[3]*b;return a};i.scaleAndAdd=function(a,f,b,c){a[0]=f[0]+b[0]*c;a[1]=f[1]+b[1]*c;a[2]=f[2]+b[2]*c;a[3]=f[3]+b[3]*c;return a};i.distance=function(a,f){var b=f[0]-a[0],c=f[1]-a[1],d=f[2]-a[2],e=f[3]-a[3];return Math.sqrt(b*b+c*c+d*d+e*e)};i.dist=i.distance;i.squaredDistance=function(a,f){var b=f[0]-a[0],c=f[1]-a[1],d=f[2]-a[2],e=f[3]-a[3];return b*b+c*c+d*d+e*e};i.sqrDist=i.squaredDistance;i.length=function(a){var f=\r\n\ta[0],b=a[1],c=a[2];a=a[3];return Math.sqrt(f*f+b*b+c*c+a*a)};i.len=i.length;i.squaredLength=function(a){var f=a[0],b=a[1],c=a[2];a=a[3];return f*f+b*b+c*c+a*a};i.sqrLen=i.squaredLength;i.negate=function(a,f){a[0]=-f[0];a[1]=-f[1];a[2]=-f[2];a[3]=-f[3];return a};i.inverse=function(a,f){a[0]=1/f[0];a[1]=1/f[1];a[2]=1/f[2];a[3]=1/f[3];return a};i.normalize=function(a,f){var b=f[0],c=f[1],d=f[2],e=f[3],b=b*b+c*c+d*d+e*e;0<b&&(b=1/Math.sqrt(b),a[0]=f[0]*b,a[1]=f[1]*b,a[2]=f[2]*b,a[3]=f[3]*b);return a};\r\n\ti.dot=function(a,f){return a[0]*f[0]+a[1]*f[1]+a[2]*f[2]+a[3]*f[3]};i.lerp=function(a,f,b,c){var d=f[0],e=f[1],l=f[2];f=f[3];a[0]=d+c*(b[0]-d);a[1]=e+c*(b[1]-e);a[2]=l+c*(b[2]-l);a[3]=f+c*(b[3]-f);return a};i.random=function(a,f){f=f||1;a[0]=e();a[1]=e();a[2]=e();a[3]=e();i.normalize(a,a);i.scale(a,a,f);return a};i.transformMat4=function(a,f,b){var c=f[0],d=f[1],e=f[2];f=f[3];a[0]=b[0]*c+b[4]*d+b[8]*e+b[12]*f;a[1]=b[1]*c+b[5]*d+b[9]*e+b[13]*f;a[2]=b[2]*c+b[6]*d+b[10]*e+b[14]*f;a[3]=b[3]*c+b[7]*d+\r\n\tb[11]*e+b[15]*f;return a};i.transformQuat=function(a,b,c){var d=b[0],e=b[1],n=b[2];b=c[0];var l=c[1],x=c[2];c=c[3];var u=c*d+l*n-x*e,J=c*e+x*d-b*n,g=c*n+b*e-l*d,d=-b*d-l*e-x*n;a[0]=u*c+d*-b+J*-x-g*-l;a[1]=J*c+d*-l+g*-b-u*-x;a[2]=g*c+d*-x+u*-l-J*-b;return a};var w=i.create();i.forEach=function(a,b,c,d,e,n){b||(b=4);c||(c=0);for(d=d?Math.min(d*b+c,a.length):a.length;c<d;c+=b)w[0]=a[c],w[1]=a[c+1],w[2]=a[c+2],w[3]=a[c+3],e(w,w,n),a[c]=w[0],a[c+1]=w[1],a[c+2]=w[2],a[c+3]=w[3];return a};i.str=function(a){return\"vec4(\"+\r\n\ta[0]+\", \"+a[1]+\", \"+a[2]+\", \"+a[3]+\")\"};\"undefined\"!==typeof a&&(a.vec4=i);d={create:function(){var a=new c(4);a[0]=1;a[1]=0;a[2]=0;a[3]=1;return a},clone:function(a){var b=new c(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;return a},transpose:function(a,b){if(a===b){var c=b[1];a[1]=b[2];a[2]=c}else a[0]=b[0],a[1]=b[2],a[2]=b[1],a[3]=b[3];return a},invert:function(a,b){var c=\r\n\tb[0],d=b[1],e=b[2],n=b[3],l=c*n-e*d;if(!l)return null;l=1/l;a[0]=n*l;a[1]=-d*l;a[2]=-e*l;a[3]=c*l;return a},adjoint:function(a,b){var c=b[0];a[0]=b[3];a[1]=-b[1];a[2]=-b[2];a[3]=c;return a},determinant:function(a){return a[0]*a[3]-a[2]*a[1]},multiply:function(a,b,c){var d=b[0],e=b[1],n=b[2];b=b[3];var l=c[0],x=c[1],u=c[2];c=c[3];a[0]=d*l+n*x;a[1]=e*l+b*x;a[2]=d*u+n*c;a[3]=e*u+b*c;return a}};d.mul=d.multiply;d.rotate=function(a,b,c){var d=b[0],e=b[1],n=b[2];b=b[3];var l=Math.sin(c);c=Math.cos(c);a[0]=\r\n\td*c+n*l;a[1]=e*c+b*l;a[2]=d*-l+n*c;a[3]=e*-l+b*c;return a};d.scale=function(a,b,c){var d=b[1],e=b[2],n=b[3],l=c[0];c=c[1];a[0]=b[0]*l;a[1]=d*l;a[2]=e*c;a[3]=n*c;return a};d.str=function(a){return\"mat2(\"+a[0]+\", \"+a[1]+\", \"+a[2]+\", \"+a[3]+\")\"};d.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2))};d.LDU=function(a,b,c,d){a[2]=d[2]/d[0];c[0]=d[0];c[1]=d[1];c[3]=d[3]-a[2]*c[1];return[a,b,c]};\"undefined\"!==typeof a&&(a.mat2=d);d={create:function(){var a=\r\n\tnew c(6);a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a},clone:function(a){var b=new c(6);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a},invert:function(a,b){var c=b[0],d=b[1],e=b[2],n=b[3],l=b[4],x=b[5],u=c*n-d*e;if(!u)return null;u=1/u;a[0]=n*u;a[1]=-d*u;a[2]=-e*u;a[3]=c*u;a[4]=(e*x-n*l)*u;a[5]=(d*l-c*x)*u;return a},\r\n\tdeterminant:function(a){return a[0]*a[3]-a[1]*a[2]},multiply:function(a,b,c){var d=b[0],e=b[1],n=b[2],l=b[3],x=b[4];b=b[5];var u=c[0],g=c[1],h=c[2],K=c[3],j=c[4];c=c[5];a[0]=d*u+n*g;a[1]=e*u+l*g;a[2]=d*h+n*K;a[3]=e*h+l*K;a[4]=d*j+n*c+x;a[5]=e*j+l*c+b;return a}};d.mul=d.multiply;d.rotate=function(a,b,c){var d=b[0],e=b[1],n=b[2],l=b[3],x=b[4];b=b[5];var u=Math.sin(c);c=Math.cos(c);a[0]=d*c+n*u;a[1]=e*c+l*u;a[2]=d*-u+n*c;a[3]=e*-u+l*c;a[4]=x;a[5]=b;return a};d.scale=function(a,b,c){var d=b[1],e=b[2],\r\n\tn=b[3],l=b[4],x=b[5],u=c[0];c=c[1];a[0]=b[0]*u;a[1]=d*u;a[2]=e*c;a[3]=n*c;a[4]=l;a[5]=x;return a};d.translate=function(a,b,c){var d=b[0],e=b[1],n=b[2],l=b[3],x=b[4];b=b[5];var u=c[0];c=c[1];a[0]=d;a[1]=e;a[2]=n;a[3]=l;a[4]=d*u+n*c+x;a[5]=e*u+l*c+b;return a};d.str=function(a){return\"mat2d(\"+a[0]+\", \"+a[1]+\", \"+a[2]+\", \"+a[3]+\", \"+a[4]+\", \"+a[5]+\")\"};d.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)};\"undefined\"!==\r\n\ttypeof a&&(a.mat2d=d);d={create:function(){var a=new c(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},fromMat4:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[4];a[4]=b[5];a[5]=b[6];a[6]=b[8];a[7]=b[9];a[8]=b[10];return a},clone:function(a){var b=new c(9);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];return a},\r\n\tidentity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},transpose:function(a,b){if(a===b){var c=b[1],d=b[2],e=b[5];a[1]=b[3];a[2]=b[6];a[3]=c;a[5]=b[7];a[6]=d;a[7]=e}else a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8];return a},invert:function(a,b){var c=b[0],d=b[1],e=b[2],n=b[3],l=b[4],x=b[5],u=b[6],g=b[7],h=b[8],K=h*l-x*g,j=-h*n+x*u,m=g*n-l*u,i=c*K+d*j+e*m;if(!i)return null;i=1/i;a[0]=K*i;a[1]=(-h*d+e*g)*i;a[2]=(x*\r\n\td-e*l)*i;a[3]=j*i;a[4]=(h*c-e*u)*i;a[5]=(-x*c+e*n)*i;a[6]=m*i;a[7]=(-g*c+d*u)*i;a[8]=(l*c-d*n)*i;return a},adjoint:function(a,b){var c=b[0],d=b[1],e=b[2],n=b[3],l=b[4],x=b[5],u=b[6],g=b[7],h=b[8];a[0]=l*h-x*g;a[1]=e*g-d*h;a[2]=d*x-e*l;a[3]=x*u-n*h;a[4]=c*h-e*u;a[5]=e*n-c*x;a[6]=n*g-l*u;a[7]=d*u-c*g;a[8]=c*l-d*n;return a},determinant:function(a){var b=a[3],c=a[4],d=a[5],e=a[6],n=a[7],l=a[8];return a[0]*(l*c-d*n)+a[1]*(-l*b+d*e)+a[2]*(n*b-c*e)},multiply:function(a,b,c){var d=b[0],e=b[1],n=b[2],l=b[3],\r\n\tx=b[4],u=b[5],g=b[6],h=b[7];b=b[8];var j=c[0],m=c[1],i=c[2],k=c[3],q=c[4],t=c[5],s=c[6],r=c[7];c=c[8];a[0]=j*d+m*l+i*g;a[1]=j*e+m*x+i*h;a[2]=j*n+m*u+i*b;a[3]=k*d+q*l+t*g;a[4]=k*e+q*x+t*h;a[5]=k*n+q*u+t*b;a[6]=s*d+r*l+c*g;a[7]=s*e+r*x+c*h;a[8]=s*n+r*u+c*b;return a}};d.mul=d.multiply;d.translate=function(a,b,c){var d=b[0],e=b[1],n=b[2],l=b[3],x=b[4],u=b[5],g=b[6],h=b[7];b=b[8];var j=c[0];c=c[1];a[0]=d;a[1]=e;a[2]=n;a[3]=l;a[4]=x;a[5]=u;a[6]=j*d+c*l+g;a[7]=j*e+c*x+h;a[8]=j*n+c*u+b;return a};d.rotate=\r\n\tfunction(a,b,c){var d=b[0],e=b[1],n=b[2],l=b[3],x=b[4],u=b[5],g=b[6],h=b[7];b=b[8];var j=Math.sin(c);c=Math.cos(c);a[0]=c*d+j*l;a[1]=c*e+j*x;a[2]=c*n+j*u;a[3]=c*l-j*d;a[4]=c*x-j*e;a[5]=c*u-j*n;a[6]=g;a[7]=h;a[8]=b;return a};d.scale=function(a,b,c){var d=c[0];c=c[1];a[0]=d*b[0];a[1]=d*b[1];a[2]=d*b[2];a[3]=c*b[3];a[4]=c*b[4];a[5]=c*b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];return a};d.fromMat2d=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=0;a[3]=b[2];a[4]=b[3];a[5]=0;a[6]=b[4];a[7]=b[5];a[8]=1;return a};d.fromQuat=\r\n\tfunction(a,b){var c=b[0],d=b[1],e=b[2],n=b[3],l=c+c,x=d+d,u=e+e,c=c*l,g=d*l,d=d*x,h=e*l,j=e*x,e=e*u,l=n*l,x=n*x,n=n*u;a[0]=1-d-e;a[3]=g-n;a[6]=h+x;a[1]=g+n;a[4]=1-c-e;a[7]=j-l;a[2]=h-x;a[5]=j+l;a[8]=1-c-d;return a};d.normalFromMat4=function(a,b){var c=b[0],d=b[1],e=b[2],n=b[3],l=b[4],x=b[5],u=b[6],g=b[7],h=b[8],j=b[9],m=b[10],i=b[11],k=b[12],q=b[13],t=b[14],s=b[15],r=c*x-d*l,z=c*u-e*l,w=c*g-n*l,A=d*u-e*x,E=d*g-n*x,F=e*g-n*u,G=h*q-j*k,H=h*t-m*k,h=h*s-i*k,I=j*t-m*q,j=j*s-i*q,m=m*s-i*t,i=r*m-z*j+w*I+\r\n\tA*h-E*H+F*G;if(!i)return null;i=1/i;a[0]=(x*m-u*j+g*I)*i;a[1]=(u*h-l*m-g*H)*i;a[2]=(l*j-x*h+g*G)*i;a[3]=(e*j-d*m-n*I)*i;a[4]=(c*m-e*h+n*H)*i;a[5]=(d*h-c*j-n*G)*i;a[6]=(q*F-t*E+s*A)*i;a[7]=(t*w-k*F-s*z)*i;a[8]=(k*E-q*w+s*r)*i;return a};d.str=function(a){return\"mat3(\"+a[0]+\", \"+a[1]+\", \"+a[2]+\", \"+a[3]+\", \"+a[4]+\", \"+a[5]+\", \"+a[6]+\", \"+a[7]+\", \"+a[8]+\")\"};d.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],\r\n\t2)+Math.pow(a[7],2)+Math.pow(a[8],2))};\"undefined\"!==typeof a&&(a.mat3=d);var r={create:function(){var a=new c(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},clone:function(a){var b=new c(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=\r\n\tb[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},transpose:function(a,b){if(a===b){var c=b[1],d=b[2],e=b[3],n=b[6],l=b[7],g=b[11];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=c;a[6]=b[9];a[7]=b[13];a[8]=d;a[9]=n;a[11]=b[14];a[12]=e;a[13]=l;a[14]=g}else a[0]=\r\n\tb[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a},invert:function(a,b){var c=b[0],d=b[1],e=b[2],n=b[3],l=b[4],g=b[5],u=b[6],h=b[7],j=b[8],m=b[9],i=b[10],k=b[11],q=b[12],t=b[13],s=b[14],r=b[15],z=c*g-d*l,w=c*u-e*l,B=c*h-n*l,A=d*u-e*g,E=d*h-n*g,F=e*h-n*u,G=j*t-m*q,H=j*s-i*q,I=j*r-k*q,L=m*s-i*t,M=m*r-k*t,O=i*r-k*s,D=z*O-w*M+B*L+A*I-E*H+F*G;if(!D)return null;D=1/D;a[0]=(g*O-u*\r\n\tM+h*L)*D;a[1]=(e*M-d*O-n*L)*D;a[2]=(t*F-s*E+r*A)*D;a[3]=(i*E-m*F-k*A)*D;a[4]=(u*I-l*O-h*H)*D;a[5]=(c*O-e*I+n*H)*D;a[6]=(s*B-q*F-r*w)*D;a[7]=(j*F-i*B+k*w)*D;a[8]=(l*M-g*I+h*G)*D;a[9]=(d*I-c*M-n*G)*D;a[10]=(q*E-t*B+r*z)*D;a[11]=(m*B-j*E-k*z)*D;a[12]=(g*H-l*L-u*G)*D;a[13]=(c*L-d*H+e*G)*D;a[14]=(t*w-q*A-s*z)*D;a[15]=(j*A-m*w+i*z)*D;return a},adjoint:function(a,b){var c=b[0],d=b[1],e=b[2],n=b[3],l=b[4],g=b[5],h=b[6],j=b[7],m=b[8],i=b[9],k=b[10],q=b[11],t=b[12],s=b[13],r=b[14],z=b[15];a[0]=g*(k*z-q*r)-\r\n\ti*(h*z-j*r)+s*(h*q-j*k);a[1]=-(d*(k*z-q*r)-i*(e*z-n*r)+s*(e*q-n*k));a[2]=d*(h*z-j*r)-g*(e*z-n*r)+s*(e*j-n*h);a[3]=-(d*(h*q-j*k)-g*(e*q-n*k)+i*(e*j-n*h));a[4]=-(l*(k*z-q*r)-m*(h*z-j*r)+t*(h*q-j*k));a[5]=c*(k*z-q*r)-m*(e*z-n*r)+t*(e*q-n*k);a[6]=-(c*(h*z-j*r)-l*(e*z-n*r)+t*(e*j-n*h));a[7]=c*(h*q-j*k)-l*(e*q-n*k)+m*(e*j-n*h);a[8]=l*(i*z-q*s)-m*(g*z-j*s)+t*(g*q-j*i);a[9]=-(c*(i*z-q*s)-m*(d*z-n*s)+t*(d*q-n*i));a[10]=c*(g*z-j*s)-l*(d*z-n*s)+t*(d*j-n*g);a[11]=-(c*(g*q-j*i)-l*(d*q-n*i)+m*(d*j-n*g));a[12]=\r\n\t-(l*(i*r-k*s)-m*(g*r-h*s)+t*(g*k-h*i));a[13]=c*(i*r-k*s)-m*(d*r-e*s)+t*(d*k-e*i);a[14]=-(c*(g*r-h*s)-l*(d*r-e*s)+t*(d*h-e*g));a[15]=c*(g*k-h*i)-l*(d*k-e*i)+m*(d*h-e*g);return a},determinant:function(a){var b=a[0],c=a[1],d=a[2],e=a[3],n=a[4],l=a[5],g=a[6],h=a[7],j=a[8],i=a[9],m=a[10],k=a[11],q=a[12],s=a[13],t=a[14];a=a[15];return(b*l-c*n)*(m*a-k*t)-(b*g-d*n)*(i*a-k*s)+(b*h-e*n)*(i*t-m*s)+(c*g-d*l)*(j*a-k*q)-(c*h-e*l)*(j*t-m*q)+(d*h-e*g)*(j*s-i*q)},multiply:function(a,b,c){var d=b[0],e=b[1],n=b[2],\r\n\tl=b[3],g=b[4],h=b[5],j=b[6],i=b[7],m=b[8],k=b[9],q=b[10],s=b[11],t=b[12],r=b[13],z=b[14];b=b[15];var w=c[0],C=c[1],B=c[2],A=c[3];a[0]=w*d+C*g+B*m+A*t;a[1]=w*e+C*h+B*k+A*r;a[2]=w*n+C*j+B*q+A*z;a[3]=w*l+C*i+B*s+A*b;w=c[4];C=c[5];B=c[6];A=c[7];a[4]=w*d+C*g+B*m+A*t;a[5]=w*e+C*h+B*k+A*r;a[6]=w*n+C*j+B*q+A*z;a[7]=w*l+C*i+B*s+A*b;w=c[8];C=c[9];B=c[10];A=c[11];a[8]=w*d+C*g+B*m+A*t;a[9]=w*e+C*h+B*k+A*r;a[10]=w*n+C*j+B*q+A*z;a[11]=w*l+C*i+B*s+A*b;w=c[12];C=c[13];B=c[14];A=c[15];a[12]=w*d+C*g+B*m+A*t;a[13]=\r\n\tw*e+C*h+B*k+A*r;a[14]=w*n+C*j+B*q+A*z;a[15]=w*l+C*i+B*s+A*b;return a}};r.mul=r.multiply;r.translate=function(a,b,c){var d=c[0],e=c[1];c=c[2];var n,l,g,h,j,i,m,k,q,s,t,r;b===a?(a[12]=b[0]*d+b[4]*e+b[8]*c+b[12],a[13]=b[1]*d+b[5]*e+b[9]*c+b[13],a[14]=b[2]*d+b[6]*e+b[10]*c+b[14],a[15]=b[3]*d+b[7]*e+b[11]*c+b[15]):(n=b[0],l=b[1],g=b[2],h=b[3],j=b[4],i=b[5],m=b[6],k=b[7],q=b[8],s=b[9],t=b[10],r=b[11],a[0]=n,a[1]=l,a[2]=g,a[3]=h,a[4]=j,a[5]=i,a[6]=m,a[7]=k,a[8]=q,a[9]=s,a[10]=t,a[11]=r,a[12]=n*d+j*e+q*c+\r\n\tb[12],a[13]=l*d+i*e+s*c+b[13],a[14]=g*d+m*e+t*c+b[14],a[15]=h*d+k*e+r*c+b[15]);return a};r.scale=function(a,b,c){var d=c[0],e=c[1];c=c[2];a[0]=b[0]*d;a[1]=b[1]*d;a[2]=b[2]*d;a[3]=b[3]*d;a[4]=b[4]*e;a[5]=b[5]*e;a[6]=b[6]*e;a[7]=b[7]*e;a[8]=b[8]*c;a[9]=b[9]*c;a[10]=b[10]*c;a[11]=b[11]*c;a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};r.rotate=function(a,c,d,e){var g=e[0],n=e[1];e=e[2];var l=Math.sqrt(g*g+n*n+e*e),h,j,i,m,k,q,s,t,r,z,w,Q,C,B,A,E,F,G,H,I;if(Math.abs(l)<b)return null;l=1/l;g*=\r\n\tl;n*=l;e*=l;h=Math.sin(d);j=Math.cos(d);i=1-j;d=c[0];l=c[1];m=c[2];k=c[3];q=c[4];s=c[5];t=c[6];r=c[7];z=c[8];w=c[9];Q=c[10];C=c[11];B=g*g*i+j;A=n*g*i+e*h;E=e*g*i-n*h;F=g*n*i-e*h;G=n*n*i+j;H=e*n*i+g*h;I=g*e*i+n*h;g=n*e*i-g*h;n=e*e*i+j;a[0]=d*B+q*A+z*E;a[1]=l*B+s*A+w*E;a[2]=m*B+t*A+Q*E;a[3]=k*B+r*A+C*E;a[4]=d*F+q*G+z*H;a[5]=l*F+s*G+w*H;a[6]=m*F+t*G+Q*H;a[7]=k*F+r*G+C*H;a[8]=d*I+q*g+z*n;a[9]=l*I+s*g+w*n;a[10]=m*I+t*g+Q*n;a[11]=k*I+r*g+C*n;c!==a&&(a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);return a};\r\n\tr.rotateX=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[4],g=b[5],l=b[6],h=b[7],j=b[8],i=b[9],m=b[10],k=b[11];b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[4]=e*c+j*d;a[5]=g*c+i*d;a[6]=l*c+m*d;a[7]=h*c+k*d;a[8]=j*c-e*d;a[9]=i*c-g*d;a[10]=m*c-l*d;a[11]=k*c-h*d;return a};r.rotateY=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[0],g=b[1],l=b[2],h=b[3],j=b[8],i=b[9],m=b[10],k=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],\r\n\ta[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*c-j*d;a[1]=g*c-i*d;a[2]=l*c-m*d;a[3]=h*c-k*d;a[8]=e*d+j*c;a[9]=g*d+i*c;a[10]=l*d+m*c;a[11]=h*d+k*c;return a};r.rotateZ=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[0],g=b[1],l=b[2],h=b[3],j=b[4],i=b[5],m=b[6],k=b[7];b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*c+j*d;a[1]=g*c+i*d;a[2]=l*c+m*d;a[3]=h*c+k*d;a[4]=j*c-e*d;a[5]=i*c-g*d;a[6]=m*c-l*d;a[7]=k*c-h*d;return a};r.fromRotationTranslation=\r\n\tfunction(a,b,c){var d=b[0],e=b[1],g=b[2],h=b[3],j=d+d,i=e+e,m=g+g;b=d*j;var k=d*i,d=d*m,q=e*i,e=e*m,g=g*m,j=h*j,i=h*i,h=h*m;a[0]=1-(q+g);a[1]=k+h;a[2]=d-i;a[3]=0;a[4]=k-h;a[5]=1-(b+g);a[6]=e+j;a[7]=0;a[8]=d+i;a[9]=e-j;a[10]=1-(b+q);a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a};r.fromQuat=function(a,b){var c=b[0],d=b[1],e=b[2],g=b[3],h=c+c,j=d+d,i=e+e,c=c*h,m=d*h,d=d*j,k=e*h,q=e*j,e=e*i,h=g*h,j=g*j,g=g*i;a[0]=1-d-e;a[1]=m+g;a[2]=k-j;a[3]=0;a[4]=m-g;a[5]=1-c-e;a[6]=q+h;a[7]=0;a[8]=k+j;\r\n\ta[9]=q-h;a[10]=1-c-d;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};r.frustum=function(a,b,c,d,e,g,h){var j=1/(c-b),i=1/(e-d),m=1/(g-h);a[0]=2*g*j;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*g*i;a[6]=0;a[7]=0;a[8]=(c+b)*j;a[9]=(e+d)*i;a[10]=(h+g)*m;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*(h*g)*m;a[15]=0;return a};r.perspective=function(a,b,c,d,e){b=1/Math.tan(b/2);var g=1/(d-e);a[0]=b/c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=(e+d)*g;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*e*d*g;a[15]=0;\r\n\treturn a};r.ortho=function(a,b,c,d,e,g,h){var j=1/(b-c),i=1/(d-e),m=1/(g-h);a[0]=-2*j;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*i;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*m;a[11]=0;a[12]=(b+c)*j;a[13]=(e+d)*i;a[14]=(h+g)*m;a[15]=1;return a};r.lookAt=function(a,c,d,e){var g,h,j,i,m,k,q,s,t=c[0],z=c[1];c=c[2];j=e[0];i=e[1];h=e[2];q=d[0];e=d[1];g=d[2];if(Math.abs(t-q)<b&&Math.abs(z-e)<b&&Math.abs(c-g)<b)return r.identity(a);d=t-q;e=z-e;q=c-g;s=1/Math.sqrt(d*d+e*e+q*q);d*=s;e*=s;q*=s;g=i*q-h*e;h=h*d-j*q;j=j*e-i*\r\n\td;(s=Math.sqrt(g*g+h*h+j*j))?(s=1/s,g*=s,h*=s,j*=s):j=h=g=0;i=e*j-q*h;m=q*g-d*j;k=d*h-e*g;(s=Math.sqrt(i*i+m*m+k*k))?(s=1/s,i*=s,m*=s,k*=s):k=m=i=0;a[0]=g;a[1]=i;a[2]=d;a[3]=0;a[4]=h;a[5]=m;a[6]=e;a[7]=0;a[8]=j;a[9]=k;a[10]=q;a[11]=0;a[12]=-(g*t+h*z+j*c);a[13]=-(i*t+m*z+k*c);a[14]=-(d*t+e*z+q*c);a[15]=1;return a};r.str=function(a){return\"mat4(\"+a[0]+\", \"+a[1]+\", \"+a[2]+\", \"+a[3]+\", \"+a[4]+\", \"+a[5]+\", \"+a[6]+\", \"+a[7]+\", \"+a[8]+\", \"+a[9]+\", \"+a[10]+\", \"+a[11]+\", \"+a[12]+\", \"+a[13]+\", \"+a[14]+\", \"+\r\n\ta[15]+\")\"};r.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};\"undefined\"!==typeof a&&(a.mat4=r);var m={create:function(){var a=new c(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a}},q=g.create(),s=g.fromValues(1,0,0),t=g.fromValues(0,1,0);m.rotationTo=\r\n\tfunction(a,b,c){var d=g.dot(b,c);if(-0.999999>d)return g.cross(q,s,b),1E-6>g.length(q)&&g.cross(q,t,b),g.normalize(q,q),m.setAxisAngle(a,q,Math.PI),a;if(0.999999<d)return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a;g.cross(q,b,c);a[0]=q[0];a[1]=q[1];a[2]=q[2];a[3]=1+d;return m.normalize(a,a)};var z=d.create();m.setAxes=function(a,b,c,d){z[0]=c[0];z[3]=c[1];z[6]=c[2];z[1]=d[0];z[4]=d[1];z[7]=d[2];z[2]=-b[0];z[5]=-b[1];z[8]=-b[2];return m.normalize(a,m.fromMat3(a,z))};m.clone=i.clone;m.fromValues=i.fromValues;m.copy=\r\n\ti.copy;m.set=i.set;m.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};m.setAxisAngle=function(a,b,c){c*=0.5;var d=Math.sin(c);a[0]=d*b[0];a[1]=d*b[1];a[2]=d*b[2];a[3]=Math.cos(c);return a};m.add=i.add;m.multiply=function(a,b,c){var d=b[0],e=b[1],g=b[2];b=b[3];var h=c[0],j=c[1],i=c[2];c=c[3];a[0]=d*c+b*h+e*i-g*j;a[1]=e*c+b*j+g*h-d*i;a[2]=g*c+b*i+d*j-e*h;a[3]=b*c-d*h-e*j-g*i;return a};m.mul=m.multiply;m.scale=i.scale;m.rotateX=function(a,b,c){c*=0.5;var d=b[0],e=b[1],g=b[2];b=b[3];var h=Math.sin(c);\r\n\tc=Math.cos(c);a[0]=d*c+b*h;a[1]=e*c+g*h;a[2]=g*c-e*h;a[3]=b*c-d*h;return a};m.rotateY=function(a,b,c){c*=0.5;var d=b[0],e=b[1],g=b[2];b=b[3];var h=Math.sin(c);c=Math.cos(c);a[0]=d*c-g*h;a[1]=e*c+b*h;a[2]=g*c+d*h;a[3]=b*c-e*h;return a};m.rotateZ=function(a,b,c){c*=0.5;var d=b[0],e=b[1],g=b[2];b=b[3];var h=Math.sin(c);c=Math.cos(c);a[0]=d*c+e*h;a[1]=e*c-d*h;a[2]=g*c+b*h;a[3]=b*c-g*h;return a};m.calculateW=function(a,b){var c=b[0],d=b[1],e=b[2];a[0]=c;a[1]=d;a[2]=e;a[3]=Math.sqrt(Math.abs(1-c*c-d*d-\r\n\te*e));return a};m.dot=i.dot;m.lerp=i.lerp;m.slerp=function(a,b,c,d){var e=b[0],g=b[1],h=b[2];b=b[3];var j=c[0],i=c[1],m=c[2];c=c[3];var k,q,s;q=e*j+g*i+h*m+b*c;0>q&&(q=-q,j=-j,i=-i,m=-m,c=-c);1E-6<1-q?(k=Math.acos(q),s=Math.sin(k),q=Math.sin((1-d)*k)/s,d=Math.sin(d*k)/s):q=1-d;a[0]=q*e+d*j;a[1]=q*g+d*i;a[2]=q*h+d*m;a[3]=q*b+d*c;return a};m.invert=function(a,b){var c=b[0],d=b[1],e=b[2],g=b[3],h=c*c+d*d+e*e+g*g,h=h?1/h:0;a[0]=-c*h;a[1]=-d*h;a[2]=-e*h;a[3]=g*h;return a};m.conjugate=function(a,b){a[0]=\r\n\t-b[0];a[1]=-b[1];a[2]=-b[2];a[3]=b[3];return a};m.length=i.length;m.len=m.length;m.squaredLength=i.squaredLength;m.sqrLen=m.squaredLength;m.normalize=i.normalize;m.fromMat3=function(a,b){var c=b[0]+b[4]+b[8];if(0<c)c=Math.sqrt(c+1),a[3]=0.5*c,c=0.5/c,a[0]=(b[5]-b[7])*c,a[1]=(b[6]-b[2])*c,a[2]=(b[1]-b[3])*c;else{var d=0;b[4]>b[0]&&(d=1);b[8]>b[3*d+d]&&(d=2);var e=(d+1)%3,g=(d+2)%3,c=Math.sqrt(b[3*d+d]-b[3*e+e]-b[3*g+g]+1);a[d]=0.5*c;c=0.5/c;a[3]=(b[3*e+g]-b[3*g+e])*c;a[e]=(b[3*e+d]+b[3*d+e])*c;a[g]=\r\n\t(b[3*g+d]+b[3*d+g])*c}return a};m.str=function(a){return\"quat(\"+a[0]+\", \"+a[1]+\", \"+a[2]+\", \"+a[3]+\")\"};\"undefined\"!==typeof a&&(a.quat=m)})(GLMAT);try{module.exports=GLMAT}catch(e$$10){}try{glm.exists&&alert(\"glm.common.js loaded over exist glm instance: \"+glm)}catch(e$$11){}glm=null;GLMJS_PREFIX=\"glm-js: \";\r\n\tGLM={$DEBUG:\"undefined\"!==typeof $GLM_DEBUG&&$GLM_DEBUG,version:\"0.0.6c\",GLM_VERSION:96,$outer:{polyfills:GLM_polyfills(),functions:{},intern:function(a,b){if(a)if(void 0===b&&\"object\"===typeof a)for(var c in a)GLM.$outer.intern(c,a[c]);else return GLM.$DEBUG&&GLM.$outer.console.debug(\"intern \"+a,b&&(b.name||typeof b)),GLM.$outer[a]=b},$import:function(a){GLM.$outer.$import=function(){throw Error(\"glm.$outer.$import already called...\");};GLM.$outer.intern(a.statics);GLM.$template.extend(GLM,GLM.$template[\"declare<T,V,number>\"](a[\"declare<T,V,number>\"]),\r\n\tGLM.$template[\"declare<T,V,...>\"](a[\"declare<T,V,...>\"]),GLM.$template[\"declare<T,...>\"](a[\"declare<T,...>\"]),GLM.$template[\"declare<T>\"](a[\"declare<T>\"]));GLM.$init(a)},console:$GLM_reset_logging(),quat_array_from_xyz:function(a){var b=glm.quat(),c=glm.mat3(1);b[\"*=\"](glm.angleAxis(a.x,c[0]));b[\"*=\"](glm.angleAxis(a.y,c[1]));b[\"*=\"](glm.angleAxis(a.z,c[2]));return b.elements},Array:Array,ArrayBuffer:ArrayBuffer,Float32Array:Float32Array,Float64Array:Float64Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array,\r\n\tUint32Array:Uint32Array,Int8Array:Int8Array,Int16Array:Int16Array,Int32Array:Int32Array,DataView:\"undefined\"!==typeof DataView&&DataView,$rebindTypedArrays:function(a){var b=Object.keys(GLM.$outer).filter(RegExp.prototype.test.bind(/.Array$|^ArrayBuffer$|^DataView$/)).map(function(b){var e=a.call(this,b,GLM.$outer[b]);e!==GLM.$outer[b]&&(GLM.$outer.console.warn(\"$rebindTypedArrays(\"+b+\")... replacing\"),GLM.$outer[b]=e);return e});GLM.$subarray=GLM.patch_subarray();return b}},$extern:$GLM_extern,$log:$GLM_log,\r\n\tGLMJSError:$GLM_GLMJSError(\"GLMJSError\"),_radians:function(a){return a*this.PI/180}.bind(Math),_degrees:function(a){return 180*a/this.PI}.bind(Math),normalize:$GLM_extern(\"normalize\"),inverse:$GLM_extern(\"inverse\"),distance:$GLM_extern(\"distance\"),length:$GLM_extern(\"length\"),length2:$GLM_extern(\"length2\"),transpose:$GLM_extern(\"transpose\"),slerp:$GLM_extern(\"slerp\"),mix:$GLM_extern(\"mix\"),clamp:$GLM_extern(\"clamp\"),angleAxis:$GLM_extern(\"angleAxis\"),rotate:$GLM_extern(\"rotate\"),scale:$GLM_extern(\"scale\"),\r\n\ttranslate:$GLM_extern(\"translate\"),lookAt:$GLM_extern(\"lookAt\"),cross:$GLM_extern(\"cross\"),dot:$GLM_extern(\"dot\"),perspective:function(a,b,c,e){return GLM.$outer.mat4_perspective(a,b,c,e)},ortho:function(a,b,c,e,d,h){return GLM.$outer.mat4_ortho(a,b,c,e,d,h)},_eulerAngles:function(a){return GLM.$outer.vec3_eulerAngles(a)},angle:function(a){return 2*Math.acos(a.w)},axis:function(a){var b=1-a.w*a.w;if(0>=b)return glm.vec3(0,0,1);b=1/Math.sqrt(b);return glm.vec3(a.x*b,a.y*b,a.z*b)},$from_ptr:function(a,\r\n\tb,c){if(this!==GLM)throw new GLM.GLMJSError(\"... use glm.make_<type>() (not new glm.make<type>())\");b=new GLM.$outer.Float32Array(b.buffer||b,c||0,a.componentLength);b=new GLM.$outer.Float32Array(b);return new a(b)},make_vec2:function(a,b){return GLM.$from_ptr.call(this,GLM.vec2,a,2===arguments.length?b:a.byteOffset)},make_vec3:function(a,b){return GLM.$from_ptr.call(this,GLM.vec3,a,2===arguments.length?b:a.byteOffset)},make_vec4:function(a,b){return GLM.$from_ptr.call(this,GLM.vec4,a,2===arguments.length?\r\n\tb:a.byteOffset)},make_quat:function(a,b){return GLM.$from_ptr.call(this,GLM.quat,a,2===arguments.length?b:a.byteOffset)},make_mat3:function(a,b){return GLM.$from_ptr.call(this,GLM.mat3,a,2===arguments.length?b:a.byteOffset)},make_mat4:function(a,b){return GLM.$from_ptr.call(this,GLM.mat4,a,2===arguments.length?b:a.byteOffset)},diagonal4x4:function(a){if(\"vec4\"!==GLM.$typeof(a))throw new GLM.GLMJSError(\"unsupported argtype to GLM.diagonal4x4: \"+[\"type:\"+GLM.$typeof(a)]);a=a.elements;return new GLM.mat4([a[0],\r\n\t0,0,0,0,a[1],0,0,0,0,a[2],0,0,0,0,a[3]])},diagonal3x3:function(a){if(\"vec3\"!==GLM.$typeof(a))throw new GLM.GLMJSError(\"unsupported argtype to GLM.diagonal3x3: \"+[\"type:\"+GLM.$typeof(a)]);a=a.elements;return new GLM.mat3([a[0],0,0,0,a[1],0,0,0,a[2]])},_toMat4:function(a){return new GLM.mat4(GLM.$outer.mat4_array_from_quat(a))},FAITHFUL:!0,to_string:function(a,b){try{var c=a.$type||typeof a;if(!GLM[c])throw new GLM.GLMJSError(\"unsupported argtype to GLM.to_string: \"+[\"type:\"+c,a]);return GLM.FAITHFUL?\r\n\tGLM.$to_string(a,b).replace(/[\\t\\n]/g,\"\"):GLM.$to_string(a,b)}catch(e){return GLM.$DEBUG&&GLM.$outer.console.error(\"to_string error: \",c,a+\"\",e),e+\"\"}},$sizeof:function(a){return a.BYTES_PER_ELEMENT},$types:[],$isGLMConstructor:function(a){return!!(a&&a.prototype instanceof GLM.$GLMBaseType)},$getGLMType:function(a){return a instanceof GLM.$GLMBaseType&&a.constructor||\"string\"===typeof a&&GLM[a]},$isGLMObject:function(a){return!!(a instanceof GLM.$GLMBaseType&&a.$type)},$typeof:function(a){return a instanceof\r\n\tGLM.$GLMBaseType?a.$type:\"undefined\"},$to_array:function(a){return[].slice.call(a.elements)},$to_json:function(a,b,c){this instanceof GLM.$GLMBaseType&&(c=b,b=a,a=this);return JSON.stringify(GLM.$to_object(a),b,c)},$inspect:function(a){this instanceof GLM.$GLMBaseType&&(a=this);return GLM.$to_json(a,null,2)},_clamp:function(a,b,c){return a<b?b:a>c?c:a},_abs:function(a){return Math.abs(a)},_equal:function(a,b){return a===b},_epsilonEqual:function(a,b,c){return Math.abs(a-b)<c},_fract:function(a){return a-\r\n\tMath.floor(a)},_frexp:function(){function a(b,c){var e=GLM.$outer.DataView||a._DataView;if(0==b)return c&&Array.isArray(c)?c[0]=c[1]=0:[0,0];e=new e(new GLM.$outer.ArrayBuffer(8));e.setFloat64(0,b);var d=e.getUint32(0)>>>20&2047;0===d&&(e.setFloat64(0,b*Math.pow(2,64)),d=(e.getUint32(0)>>>20&2047)-64);e=d-1022;d=GLM.ldexp(b,-e);return c&&Array.isArray(c)?(c[0]=e,c[1]=d):[d,e]}a._DataView=function(a){this.buffer=a;this.setFloat64=function(a,b){if(0!==a)throw Error(\"...this is a very limited DataView emulator\");\r\n\t(new Uint8Array(this.buffer)).set([].reverse.call(new Uint8Array((new Float64Array([b])).buffer)),a)};this.getUint32=function(a){if(0!==a)throw Error(\"...this is a very limited DataView emulator\");return(new Uint32Array((new Uint8Array([].slice.call(new Uint8Array(this.buffer)).reverse())).buffer))[1]}};return a}(),_ldexp:function(a,b){return 1023<b?a*Math.pow(2,1023)*Math.pow(2,b-1023):-1074>b?a*Math.pow(2,-1074)*Math.pow(2,b+1074):a*Math.pow(2,b)},_max:Math.max,_min:Math.min,sqrt:Math.sqrt,__sign:function(a){return 0<\r\n\ta?1:0>a?-1:+a},$constants:{epsilon:1E-6,euler:0.5772156649015329,e:Math.E,ln_ten:Math.LN10,ln_two:Math.LN2,pi:Math.PI,half_pi:Math.PI/2,quarter_pi:Math.PI/4,one_over_pi:1/Math.PI,two_over_pi:2/Math.PI,root_pi:Math.sqrt(Math.PI),root_two:Math.sqrt(2),root_three:Math.sqrt(3),two_over_root_pi:2/Math.sqrt(Math.PI),one_over_root_two:Math.SQRT1_2,root_two:Math.SQRT2},FIXEDPRECISION:6,$toFixedString:function(a,b,c,e){void 0===e&&(e=GLM.FIXEDPRECISION);if(!c||!c.map)throw Error(\"unsupported argtype to $toFixedString(..,..,props=\"+\r\n\ttypeof c+\")\");try{var d=\"\";c.map(function(c){c=b[d=c];if(!c.toFixed)throw Error(\"!toFixed in w\"+[c,a,JSON.stringify(b)]);return c.toFixed(0)})}catch(h){throw GLM.$DEBUG&&GLM.$outer.console.error(\"$toFixedString error\",a,typeof b,Object.prototype.toString.call(b),d),GLM.$DEBUG&&glm.$log(\"$toFixedString error\",a,typeof b,Object.prototype.toString.call(b),d),new GLM.GLMJSError(h);}c=c.map(function(a){return b[a].toFixed(e)});return a+\"(\"+c.join(\", \")+\")\"}};GLM._sign=Math.sign||GLM.__sign;\r\n\tfor(var p in GLM.$constants)(function(a,b){GLM[b]=function(){return a};GLM[b].valueOf=GLM[b]})(GLM.$constants[p],p);\r\n\tGLM.$GLMBaseType=function(){function a(a,c){var e=a.$||{};this.$type=c;this.$type_name=e.name||\"<\"+c+\">\";e.components&&(this.$components=e.components[0]);this.$len=this.components=a.componentLength;this.constructor=a;this.byteLength=a.BYTES_PER_ELEMENT;GLM.$types.push(c)}a.prototype={clone:function(){return new this.constructor(new this.elements.constructor(this.elements))},toString:function(){return GLM.$to_string(this)},inspect:function(){return GLM.$inspect(this)},toJSON:function(){return GLM.$to_object(this)}};\r\n\tObject.defineProperty(a.prototype,\"address\",{get:function(){var a=this.elements.byteOffset.toString(16);return\"0x00000000\".substr(0,10-a.length)+a}});return a}();\r\n\t(function(){function a(a,b,c){return a.subarray(b,c||a.length)}function b(a,b,c){var e=a.constructor;c=c||a.length;return new e(a.buffer,a.byteOffset+b*e.BYTES_PER_ELEMENT,c-b)}function c(){var a=new GLM.$outer.Float32Array([0,0]);a.subarray(1).subarray(0)[0]=1;var b=c.result=[a[1],(new GLM.$outer.Float32Array(16)).subarray(12,16).length];return!(a[1]!==b[0]||4!==b[1])}function e(a){var b=new GLM.$outer.Float32Array([0,0]);a(a(b,1),0)[0]=1;a=e.result=[b[1],a(new GLM.$outer.Float32Array(16),12,16).length];\r\n\treturn!(b[1]!==a[0]||4!==a[1])}Object.defineProperty(GLM,\"patch_subarray\",{configurable:!0,value:function(){var d=!c()?b:a;d.workaround_broken_spidermonkey_subarray=b;d.native_subarray=a;if(!e(d))throw Error(\"failed to resolve working TypedArray.subarray implementation... \"+e.result);return d}})})();GLM.$subarray=GLM.patch_subarray();\r\n\tvar GLM_template=GLM.$template={_genArgError:function(a,b,c,e){~e.indexOf(void 0)&&(e=e.slice(0,e.indexOf(void 0)));var d=RegExp.prototype.test.bind(/^[^$_]/);return new GLM.GLMJSError(\"unsupported argtype to \"+b+\" \"+a.$sig+\": [typ=\"+c+\"] :: got arg types: \"+e.map(GLM.$template.jstypes.get)+\" // supported types: \"+Object.keys(a).filter(d).join(\"||\"))},jstypes:{get:function(a){return null===a?\"null\":void 0===a?\"undefined\":a.$type||GLM.$template.jstypes[typeof a]||GLM.$template.jstypes[a+\"\"]||function(a){if(\"object\"===\r\n\ttypeof a){if(a instanceof GLM.$outer.Float32Array)return\"Float32Array\";if(a instanceof GLM.$outer.ArrayBuffer)return\"ArrayBuffer\";if(Array.isArray(a))return\"array\"}return\"<unknown \"+[typeof a,a]+\">\"}(a)},\"0\":\"float\",\"boolean\":\"bool\",number:\"float\",string:\"string\",\"[object Float32Array]\":\"Float32Array\",\"[object ArrayBuffer]\":\"ArrayBuffer\",\"function\":\"function\"},_add_overrides:function(a,b){for(var c in b)b[c]&&GLM[c].override(a,b[c])},_add_inline_override:function(a,b,c){this[b]=eval(GLM.$template._traceable(\"glm_\"+\r\n\ta+\"_\"+b,c))();return this},_inline_helpers:function(a,b){Object.defineProperty(a,\"GLM\",{value:GLM});return{$type:\"built-in\",$type_name:b,$template:a,F:a,dbg:b,override:this._add_inline_override.bind(a,b),link:function(c){var e=a[c];e||(e=a[[c,\"undefined\"]]);if(!e)throw new GLM.GLMJSError(\"error linking direct function for \"+b+\"<\"+c+\"> or \"+b+\"<\"+[c,void 0]+\">\");return/\\bthis[\\[.]/.test(e+\"\")?e.bind(a):e}}},\"template<T>\":function(a,b){a.$sig=\"template<T>\";var c=GLM.$template.jstypes,e=GLM.$template._genArgError,\r\n\td=GLM.$GLMBaseType;return this.slingshot(this._inline_helpers(a,b),eval(this._traceable(\"Tglm_\"+b,function(b){this instanceof d&&(b=this);var j=[b&&b.$type||c[typeof b]||c.get(b)||\"null\"];if(!a[j])throw e(a,arguments.callee.dbg,j,[b]);return a[j](b)}))())},\"template<T,...>\":function(a,b){a.$sig=\"template<T,...>\";var c=GLM.$template.jstypes,e=GLM.$template._genArgError,d=GLM.$GLMBaseType;return this.slingshot(this._inline_helpers(a,b),eval(this._traceable(\"Tdotglm_\"+b,function(b){for(var j=Array(arguments.length),\r\n\tg=0;g<j.length;g++)j[g]=arguments[g];this instanceof d&&j.unshift(b=this);g=[b&&b.$type||c[typeof b]||c.get(b)||\"null\"];if(!a[g])throw e(a,arguments.callee.dbg,g,j);return a[g].apply(a,j)}))())},\"template<T,V,number>\":function(a,b){a.$sig=\"template<T,V,number>\";var c=GLM.$template.jstypes,e=GLM.$template._genArgError,d=GLM.GLMJSError,h=GLM.$GLMBaseType;return this.slingshot(this._inline_helpers(a,b),eval(this._traceable(\"TVnglm_\"+b,function(){for(var b=Array(arguments.length),g=0;g<b.length;g++)b[g]=\r\n\targuments[g];this instanceof h&&b.unshift(this);var g=b[0],k=b[1],b=b[2],i=[g&&g.$type||c[typeof g]||c[g+\"\"]||\"<unknown \"+g+\">\",k&&k.$type||c[typeof k]||c[k+\"\"]||\"<unknown \"+k+\">\"];if(!a[i])throw e(a,arguments.callee.dbg,i,[g,k,b]);if(\"number\"!==typeof b)throw new d(arguments.callee.dbg+a.$sig+\": unsupported n type: \"+[typeof b,b]);return a[i](g,k,b)}))())},\"template<T,V,...>\":function(a,b){a.$sig=\"template<T,V,...>\";var c=GLM.$template.jstypes,e=GLM.$GLMBaseType,d=GLM.$template._genArgError,h=GLM.$outer.Array;\r\n\treturn this.slingshot(this._inline_helpers(a,b),eval(this._traceable(\"TVglm_\"+b,function(){for(var b=new h(arguments.length),g=0;g<b.length;g++)b[g]=arguments[g];this instanceof e&&b.unshift(this);var g=b[0],k=b[1],g=[g&&g.$type||c[typeof g],k&&k.$type||c[typeof k]||c[k+\"\"]||h.isArray(k)&&\"array\"+k.length+\"\"||\"\"+k+\"\"];if(!a[g])throw d(a,arguments.callee.dbg,g,b);return a[g].apply(a,b)}))())},override:function(a,b,c,e,d){function h(a,c){GLM.$outer.console.debug(\"glm.$template.override: \"+b+\" ... \"+\r\n\tObject.keys(a.$template).filter(function(a){return!~a.indexOf(\"$\")}).map(function(a){return!~c.indexOf(a)?\"*\"+a+\"*\":a}).join(\" | \"))}GLM.$DEBUG&&GLM.$outer.console.debug(\"glm.$template.override: \",a,b,c.$op?'$op: [\"'+c.$op+'\"]':\"\");if(!e)throw Error(\"unspecified target group \"+e+' (expected override(<TV>, \"p\", {TSP}, ret={GROUP}))');var j=e[b];if(j&&j.$op!==c.$op)throw Error('glm.$template.override: mismatch merging existing override: .$op \"'+[j.$op,\"!=\",c.$op].join(\" \")+'\"  p='+[b,j.$op,c.$op,\"||\"+\r\n\tObject.keys(j.$template).join(\"||\")]);var g=GLM.$template[a](GLM.$template.deNify(c,b),b);if(j&&j.F.$sig!==g.F.$sig)throw Error('glm.$template.override: mismatch merging existing override: .$sig \"'+[j&&j.F.$sig,\"!=\",g.F.$sig].join(\" \")+'\"  p='+[b,j&&j.F.$sig,g.F.$sig,\"||\"+Object.keys(j&&j.$template||{}).join(\"||\")]);g.$op=c.$op;if(j){for(var k in g.$template)\"$op\"===k||\"$sig\"===k||(a=k in j.$template,!a||!0===d?(GLM.$DEBUG&&GLM.$outer.console.debug(\"glm.$template.override: \"+b+\" ... \"+k+\" merged\"),\r\n\tj.$template[k]=g.$template[k]):a&&GLM.$DEBUG&&GLM.$outer.console.debug(\"glm.$template.override: \"+b+\" ... \"+k+\" skipped\"));if(GLM.$DEBUG){var i=[];Object.keys(j.$template).forEach(function(a){a in g.$template||(GLM.$DEBUG&&GLM.$outer.console.debug(\"glm.$template.override: \"+b+\" ... \"+a+\" carried-forward\"),i.push(a))});h(e[b],i)}}else e[b]=g,GLM.$DEBUG&&h(e[b],[]);return e},_override:function(a,b,c){for(var e in b){if(\"mat4_scale\"!==e&&\"object\"!==typeof b[e])throw new GLM.GLMJSError(\"expect object property overrides\"+\r\n\t[e,b[e],Object.keys(c)]);\"object\"===typeof b[e]?this.override(a,e,b[e],c,!0):ret_scale=5}return c},slingshot:function(){return this.extend.apply(this,[].reverse.call(arguments))},extend:function(a,b){[].slice.call(arguments,1).forEach(function(b){if(b)for(var e in b)b.hasOwnProperty(e)&&(a[e]=b[e])});return a},\"declare<T,V,...>\":function(a){return!a?{}:this._override(\"template<T,V,...>\",a,GLM.$outer.functions)},\"declare<T>\":function(a){return!a?{}:this._override(\"template<T>\",a,GLM.$outer.functions)},\r\n\t\"declare<T,...>\":function(a){return!a?{}:this._override(\"template<T,...>\",a,GLM.$outer.functions)},\"declare<T,V,number>\":function(a){return!a?{}:this._override(\"template<T,V,number>\",a,GLM.$outer.functions)},_tojsname:function(a){return(a||\"_\").replace(/[^$a-zA-Z0-9_]/g,\"_\")},_traceable:function(a,b){var c=b;if(\"function\"!==typeof c)throw new GLM.GLMJSError(\"_traceable expects tidy function as second arg \"+c);if(!a)throw new GLM.GLMJSError(\"_traceable expects hint or what's the point\"+[c,a]);a=this._tojsname(a||\r\n\t\"_traceable\");c=c.toString().replace(/^(\\s*var\\s*(\\w+)\\s*=\\s*)__VA_ARGS__;/mg,function(a,b,c){return b+\"new Array(arguments.length);for(var I=0;I<varname.length;I++)varname[I]=arguments[I];\".replace(/I/g,\"__VA_ARGS__I\").replace(/varname/g,c)}).replace(/\\barguments[.]callee\\b/g,a);if(/^function _traceable/.test(c))throw new GLM.GLMJSError(\"already wrapped in a _traceable: \"+[c,a]);c='function _traceable(){ \"use strict\"; SRC; return HINT; }'.replace(\"HINT\",a.replace(/[$]/g,\"$$$$\")).replace(\"SRC\",c.replace(/[$]/g,\r\n\t\"$$$$\").replace(/^function\\s*\\(/,\"function \"+a+\"(\"));c=\"1,\"+c;if(GLM.$DEBUG)try{eval(c)}catch(e){throw console.error(\"_traceable error\",a,c,b,e),e;}return c},deNify:function(a,b){var c={vec:[2,3,4],mat:[3,4]},e=this._tojsname.bind(this),d;for(d in a){var h=!1;d.replace(/([vV]ec|[mM]at)(?:\\w*)<N>/,function(j,g){h=!0;var k=a[d];delete a[d];c[g.toLowerCase()].forEach(function(c){var g=d.replace(/<N[*]N>/g,c*c).replace(/<N>/g,c);if(!(g in a)){var h=e(\"glm_\"+b+\"_\"+g);a[g]=eval(\"'use strict'; 1,\"+(k+\"\").replace(/^function\\s*\\(/,\r\n\t\"function \"+h+\"(\").replace(/N[*]N/g,c*c).replace(/N/g,c))}})}.bind(this));/^[$]/.test(d)?GLM.$DEBUG&&GLM.$outer.console.debug(\"@ NOT naming \"+d):!h&&(\"function\"===typeof a[d]&&!a[d].name)&&(GLM.$DEBUG&&GLM.$outer.console.debug(\"naming \"+e(b+\"_\"+d)),a[d]=eval(this._traceable(\"glm_\"+b+\"_\"+d,a[d]))())}return a},$_module_stamp:+new Date,_iso:\"/[*][^/*]*[*]/\",_get_argnames:function(a){return(a+\"\").replace(/\\s+/g,\"\").replace(RegExp(this._iso,\"g\"),\"\").split(\"){\",1)[0].replace(/^[^(]*[(]/,\"\").replace(/=[^,]+/g,\r\n\t\"\").split(\",\").filter(Boolean)},_fix_$_names:function(a,b){Object.keys(b).filter(function(a){return\"function\"===typeof b[a]&&!b[a].name}).map(function(c){var e=a+\"_\"+c;GLM.$DEBUG&&GLM.$outer.console.debug(\"naming $.\"+c+\" == \"+e,this._traceable(e,b[c]));b[c]=eval(this._traceable(\"glm_\"+e,b[c]))()}.bind(this));return b},_typedArrayMaker:function(a,b){return function(c){if(c.length===a)return new b(c);var e=new b(a);e.set(c);return e}},GLMType:function(a,b){var c=this._fix_$_names(a,b),e=c.identity.length,\r\n\td,h=Object,j=GLM.$template._get_argnames.bind(GLM.$template),g=GLM.GLMJSError,k={},i;for(i in c)\"function\"===typeof c[i]&&function(a){k[i]=function(b){return a.apply(c,b)}}(c[i]);d=function(b){var d=k[typeof b[0]+b.length];if(!d){var e=\"glm.\"+a;b=e+\"(\"+b.map(function(a){return typeof a})+\")\";d=h.keys(c).filter(function(a){return\"function\"===typeof c[a]&&/^\\w+\\d+$/.test(a)}).map(function(a){return e+\"(\"+j(c[a])+\")\"});throw new g(\"no constructor found for: \"+b+\"\\nsupported signatures:\\n\\t\"+d.join(\"\\n\\t\"));\r\n\t}return d};var w,r=GLM;GLM.$template._get_argnames.bind(GLM.$template);w=function(b,c){2<r.$DEBUG&&r.$outer.console.info(\"adopting elements...\",typeof b);if(b.length!=e){if(!1===c)return c;r.$outer.console.error(a+\" elements size mismatch: \"+[\"wanted:\"+e,\"handed:\"+b.length]);var d=r.$subarray(b,0,e);throw new r.GLMJSError(a+\" elements size mismatch: \"+[\"wanted:\"+e,\"handed:\"+b.length,\"theoreticaly-correctable?:\"+(d.length===e)]);}return b};var m=this._typedArrayMaker(e,GLM.$outer.Float32Array),q,s=\r\n\tGLM.$outer;q=function(a){return a instanceof s.Float32Array};var t=function(a,b,c,g,h,i,j,k){return eval(k(\"glm_\"+h+\"$class\",function(c){for(var f=new a(arguments.length),g=0;g<f.length;g++)f[g]=arguments[g];var h=d(f),g=t;if(this instanceof g)f=q(c)?w(c):m(h(f)),b.defineProperty(this,\"elements\",{enumerable:!1,configurable:!0,value:f});else return f=q(c)&&c.length===e?m(c):h(f),new g(f)}))()}(Array,Object,GLM,c,a,GLM.$template._get_argnames.bind(GLM.$template),GLM.GLMJSError,GLM.$template._traceable.bind(GLM.$template));\r\n\tc.components=c.components?c.components.map(function(a){return\"string\"===typeof a?a.split(\"\"):a}):[];t.$=c;t.componentLength=e;t.BYTES_PER_ELEMENT=e*GLM.$outer.Float32Array.BYTES_PER_ELEMENT;t.prototype=new GLM.$GLMBaseType(t,a);t.toJSON=function(){var b={glm$type:a,glm$class:t.prototype.$type_name,glm$eg:(new t).object},c;for(c in t)/function |^[$]/.test(c+t[c])||(b[c]=t[c]);return b};return t}};\r\n\tGLM.$template[\"declare<T,V,...>\"]({cross:{\"vec2,vec2\":function(a,b){return this.GLM.vec3(0,0,a.x*b.y-a.y*b.x)}},distance:{\"vec<N>,vec<N>\":function(a,b){return this.GLM.length(b.sub(a))}}});\r\n\tGLM.$template[\"declare<T,V,number>\"]({mix:{\"float,float\":function(a,b,c){return b*c+a*(1-c)},\"vec<N>,vec<N>\":function(a,b,c){var e=1-c,d=new this.GLM.vecN(new a.elements.constructor(N)),h=d.elements;a=a.elements;b=b.elements;for(var j=0;j<N;j++)h[j]=b[j]*c+a[j]*e;return d}},clamp:{\"float,float\":function(a,b,c){return GLM._clamp(a,b,c)},\"vec<N>,float\":function(a,b,c){return new GLM.vecN(GLM.$to_array(a).map(function(a){return GLM._clamp(a,b,c)}))}},epsilonEqual:{\"float,float\":GLM._epsilonEqual,\"vec<N>,vec<N>\":function(a,\r\n\tb,c){for(var e=this[\"float,float\"],d=glm.bvecN(),h=0;h<N;h++)d[h]=e(a[h],b[h],c);return d},\"ivec<N>,ivec<N>\":function(a,b,c){return this[\"vecN,vecN\"](a,b,c)},\"uvec<N>,uvec<N>\":function(a,b,c){return this[\"vecN,vecN\"](a,b,c)},\"quat,quat\":function(a,b,c){for(var e=this[\"float,float\"],d=glm.bvec4(),h=0;4>h;h++)d[h]=e(a[h],b[h],c);return d},\"mat<N>,mat<N>\":function(){throw new GLM.GLMJSError(\"error: 'epsilonEqual' only accept floating-point and integer scalar or vector inputs\");}}});\r\n\tGLM.$template.extend(GLM,GLM.$template[\"declare<T>\"]({degrees:{\"float\":function(a){return this.GLM._degrees(a)},\"vec<N>\":function(a){return new this.GLM.vecN(this.GLM.$to_array(a).map(this.GLM._degrees))}},radians:{\"float\":function(a){return this.GLM._radians(a)},\"vec<N>\":function(a){return new this.GLM.vecN(this.GLM.$to_array(a).map(this.GLM._radians))}},sign:{\"null\":function(){return 0},undefined:function(){return NaN},string:function(){return NaN},\"float\":function(a){return GLM._sign(a)},\"vec<N>\":function(a){return new GLM.vecN(GLM.$to_array(a).map(GLM._sign))},\r\n\t\"ivec<N>\":function(a){return new GLM.ivecN(GLM.$to_array(a).map(GLM._sign))}},abs:{\"float\":function(a){return GLM._abs(a)},\"vec<N>\":function(a){return new GLM.vecN(GLM.$to_array(a).map(GLM._abs))}},fract:{\"float\":function(a){return GLM._fract(a)},\"vec<N>\":function(a){return new GLM.vecN(GLM.$to_array(a).map(GLM._fract))}},all:{\"vec<N>\":function(a){return N===GLM.$to_array(a).filter(Boolean).length},\"bvec<N>\":function(a){return N===GLM.$to_array(a).filter(Boolean).length},\"ivec<N>\":function(a){return N===\r\n\tGLM.$to_array(a).filter(Boolean).length},\"uvec<N>\":function(a){return N===GLM.$to_array(a).filter(Boolean).length},quat:function(a){return 4===GLM.$to_array(a).filter(Boolean).length}},$to_object:{vec2:function(a){return{x:a.x,y:a.y}},vec3:function(a){return{x:a.x,y:a.y,z:a.z}},vec4:function(a){return{x:a.x,y:a.y,z:a.z,w:a.w}},uvec2:function(a){return{x:a.x,y:a.y}},uvec3:function(a){return{x:a.x,y:a.y,z:a.z}},uvec4:function(a){return{x:a.x,y:a.y,z:a.z,w:a.w}},ivec2:function(a){return{x:a.x,y:a.y}},\r\n\tivec3:function(a){return{x:a.x,y:a.y,z:a.z}},ivec4:function(a){return{x:a.x,y:a.y,z:a.z,w:a.w}},bvec2:function(a){return{x:!!a.x,y:!!a.y}},bvec3:function(a){return{x:!!a.x,y:!!a.y,z:!!a.z}},bvec4:function(a){return{x:!!a.x,y:!!a.y,z:!!a.z,w:!!a.w}},quat:function(a){return{w:a.w,x:a.x,y:a.y,z:a.z}},mat3:function(a){return{\"0\":this.vec3(a[0]),1:this.vec3(a[1]),2:this.vec3(a[2])}},mat4:function(a){return{\"0\":this.vec4(a[0]),1:this.vec4(a[1]),2:this.vec4(a[2]),3:this.vec4(a[3])}}},roll:{$atan2:Math.atan2,\r\n\tquat:function(a){return this.$atan2(2*(a.x*a.y+a.w*a.z),a.w*a.w+a.x*a.x-a.y*a.y-a.z*a.z)}},pitch:{$atan2:Math.atan2,quat:function(a){return this.$atan2(2*(a.y*a.z+a.w*a.x),a.w*a.w-a.x*a.x-a.y*a.y+a.z*a.z)}},yaw:{$asin:Math.asin,quat:function(a){return this.$asin(this.GLM.clamp(-2*(a.x*a.z-a.w*a.y),-1,1))}},eulerAngles:{quat:function(a){return this.GLM.vec3(this.GLM.pitch(a),this.GLM.yaw(a),this.GLM.roll(a))}}}),GLM.$template[\"declare<T,...>\"]({$from_glsl:{string:function(a,b){var c;a.replace(/^([$\\w]+)\\(([-.0-9ef, ]+)\\)$/,\r\n\tfunction(a,d,h){a=glm[d]||glm[\"$\"+d];if(!a)throw new GLM.GLMJSError(\"glsl decoding issue: unknown type '\"+d+\"'\");c=h.split(\",\").map(parseFloat);if(!b||b===a)c=a.apply(glm,c);else{if(!0===b||b===Array){for(;c.length<a.componentLength;)c.push(c[c.length-1]);return c}throw new GLM.GLMJSError(\"glsl decoding issue: second argument expected to be undefined|true|Array\");}});return c}},$to_glsl:{\"vec<N>\":function(a,b){var c=GLM.$to_array(a);b&&(\"object\"===typeof b&&\"precision\"in b)&&(c=c.map(function(a){return a.toFixed(b.precision)}));\r\n\tfor(;c.length&&c[c.length-2]===c[c.length-1];)c.pop();return a.$type+\"(\"+c+\")\"},\"uvec<N>\":function(a,b){return this.vecN(a,b)},\"ivec<N>\":function(a,b){return this.vecN(a,b)},\"bvec<N>\":function(a,b){return this.vecN(a,b)},quat:function(a,b){var c;b&&(\"object\"===typeof b&&\"precision\"in b)&&(c=b.precision);return 0===a.x+a.y+a.z?\"quat(\"+(void 0===c?a.w:a.w.toFixed(c))+\")\":this.vec4(a,b)},\"mat<N>\":function(a,b){var c;b&&(\"object\"===typeof b&&\"precision\"in b)&&(c=b.precision);var e=GLM.$to_array(a);void 0!==\r\n\tc&&(e=e.map(function(a){return a.toFixed(c)}));return e.reduce(function(a,b){return a+1*b},0)===e[0]*N?\"matN(\"+e[0]+\")\":\"matN(\"+e+\")\"}},frexp:{\"float\":function(a,b){return 1===arguments.length?this[\"float,undefined\"](a):this[\"float,array\"](a,b)},\"vec<N>\":function(a,b){if(2>arguments.length)throw new GLM.GLMJSError(\"frexp(vecN, ivecN) expected ivecN as second parameter\");return GLM.vecN(GLM.$to_array(a).map(function(a,e){var d=GLM._frexp(a);b[e]=d[1];return d[0]}))},\"float,undefined\":function(a){return GLM._frexp(a)},\r\n\t\"float,array\":function(a,b){return GLM._frexp(a,b)}},ldexp:{\"float\":GLM._ldexp,\"vec<N>\":function(a,b){return GLM.vecN(GLM.$to_array(a).map(function(a,e){return GLM._ldexp(a,b[e])}))}}}));\r\n\tGLM.$template[\"declare<T,V,...>\"]({rotate:{\"float,vec3\":function(a,b){return this.GLM.$outer.mat4_angleAxis(a,b)},\"mat4,float\":function(a,b,c){return a.mul(this.GLM.$outer.mat4_angleAxis(b,c))}},scale:{$outer:GLM.$outer,\"mat4,vec3\":function(a,b){return a.mul(this.$outer.mat4_scale(b))},\"vec3,undefined\":function(a){return this.$outer.mat4_scale(a)}},translate:{\"mat4,vec3\":function(a,b){return a.mul(this.GLM.$outer.mat4_translation(b))},\"vec3,undefined\":function(a){return this.GLM.$outer.mat4_translation(a)}},\r\n\tangleAxis:{\"float,vec3\":function(a,b){return this.GLM.$outer.quat_angleAxis(a,b)}},min:{\"float,float\":function(a,b){return this.GLM._min(a,b)},\"vec<N>,float\":function(a,b){return new this.GLM.vecN(this.GLM.$to_array(a).map(function(a){return this.GLM._min(a,b)}.bind(this)))}},max:{\"float,float\":function(a,b){return this.GLM._max(a,b)},\"vec<N>,float\":function(a,b){return new this.GLM.vecN(this.GLM.$to_array(a).map(function(a){return this.GLM._max(a,b)}.bind(this)))}},equal:{\"float,float\":GLM._equal,\r\n\t\"vec<N>,vec<N>\":function(a,b){for(var c=this[\"float,float\"],e=glm.bvecN(),d=0;d<N;d++)e[d]=c(a[d],b[d]);return e},\"bvec<N>,bvec<N>\":function(a,b){return this[\"vecN,vecN\"](a,b)},\"ivec<N>,ivec<N>\":function(a,b){return this[\"vecN,vecN\"](a,b)},\"uvec<N>,uvec<N>\":function(a,b){return this[\"vecN,vecN\"](a,b)},\"quat,quat\":function(a,b){for(var c=this[\"float,float\"],e=glm.bvec4(),d=0;4>d;d++)e[d]=c(a[d],b[d]);return e}},_slerp:{\"quat,quat\":function(a,b,c){var e=b,d=glm.dot(glm.vec4(a),glm.vec4(b));0>d&&(e=\r\n\tb.mul(-1),d=-d);if(d>1-glm.epsilon())return glm.quat(glm.mix(a.w,e.w,c),glm.mix(a.x,e.x,c),glm.mix(a.y,e.y,c),glm.mix(a.z,e.z,c));b=Math.acos(d);return(a.mul(Math.sin((1-c)*b))+e.mul(Math.sin(c*b)))/Math.sin(b)}},rotation:{\"vec3,vec3\":function(a,b){var c=this.$dot(a,b),e=new a.constructor(new a.elements.constructor(3));if(c>=1-this.$epsilon)return this.$quat();if(c<-1+this.$epsilon)return e=this.$cross(this.$m[2],a),this.$length2(e)<this.$epsilon&&(e=this.$cross(this.$m[0],a)),e=this.$normalize(e),\r\n\tthis.$angleAxis(this.$pi,e);var e=this.$cross(a,b),c=this.$sqrt(2*(1+c)),d=1/c;return this.$quat(0.5*c,e.x*d,e.y*d,e.z*d)}},project:{\"vec3,mat4\":function(a,b,c,e){a=glm.vec4(a,1);a=b[\"*\"](a);a=c[\"*\"](a);a[\"/=\"](a.w);a=a[\"*\"](0.5)[\"+\"](0.5);a[0]=a[0]*e[2]+e[0];a[1]=a[1]*e[3]+e[1];return glm.vec3(a)}},unProject:{\"vec3,mat4\":function(a,b,c,e){b=glm.inverse(c[\"*\"](b));a=glm.vec4(a,1);a.x=(a.x-e[0])/e[2];a.y=(a.y-e[1])/e[3];a=a[\"*\"](2)[\"-\"](glm.vec4(1));e=b[\"*\"](a);e[\"/=\"](e.w);return glm.vec3(e)}},orientedAngle:{\"vec3,vec3\":function(a,\r\n\tb,c){var e=Math.acos(glm.clamp(glm.dot(a,b),0,1));return glm.mix(e,-e,0>glm.dot(c,glm.cross(a,b))?1:0)}}});\r\n\tGLM.$to_string=GLM.$template[\"declare<T,...>\"]({$to_string:{\"function\":function(a){return\"[function \"+(a.name||\"anonymous\")+\"]\"},ArrayBuffer:function(a){return\"[object ArrayBuffer \"+JSON.stringify({byteLength:a.byteLength})+\"]\"},Float32Array:function(a){return\"[object Float32Array \"+JSON.stringify({length:a.length,byteOffset:a.byteOffset,byteLength:a.byteLength,BPE:a.BYTES_PER_ELEMENT})+\"]\"},\"float\":function(a,b){return GLM.$toFixedString(\"float\",{value:a},[\"value\"],b&&b.precision)},string:function(a){return a},\r\n\tbool:function(a){return\"bool(\"+a+\")\"},\"vec<N>\":function(a,b){return GLM.$toFixedString(a.$type_name,a,a.$components,b&&b.precision)},\"uvec<N>\":function(a,b){return GLM.$toFixedString(a.$type_name,a,a.$components,b&&\"object\"===typeof b&&b.precision||0)},\"ivec<N>\":function(a,b){return GLM.$toFixedString(a.$type_name,a,a.$components,b&&\"object\"===typeof b&&b.precision||0)},\"bvec<N>\":function(a){return a.$type_name+\"(\"+GLM.$to_array(a).map(Boolean).join(\", \")+\")\"},\"mat<N>\":function(a,b){var c=[0,1,2,\r\n\t3].slice(0,N).map(function(b){return a[b]}).map(function(a){return GLM.$toFixedString(\"\\t\",a,a.$components,b&&b.precision)});return a.$type_name+\"(\\n\"+c.join(\", \\n\")+\"\\n)\"},quat:function(a,b){a=GLM.degrees(GLM.eulerAngles(a));return GLM.$toFixedString(\"<quat>\"+a.$type_name,a,[\"x\",\"y\",\"z\"],b&&b.precision)}}}).$to_string;\r\n\tGLM.$template[\"declare<T,V,...>\"]({copy:{$op:\"=\",\"vec<N>,vec<N>\":function(a,b){a.elements.set(b.elements);return a},\"vec<N>,array<N>\":function(a,b){a.elements.set(b);return a},\"vec<N>,uvec<N>\":function(a,b){a.elements.set(b.elements);return a},\"vec<N>,ivec<N>\":function(a,b){a.elements.set(b.elements);return a},\"vec<N>,bvec<N>\":function(a,b){a.elements.set(b.elements);return a},\"uvec<N>,uvec<N>\":function(a,b){a.elements.set(b.elements);return a},\"uvec<N>,array<N>\":function(a,b){a.elements.set(b);return a},\r\n\t\"uvec<N>,vec<N>\":function(a,b){a.elements.set(b.elements);return a},\"uvec<N>,ivec<N>\":function(a,b){a.elements.set(b.elements);return a},\"uvec<N>,bvec<N>\":function(a,b){a.elements.set(b.elements);return a},\"ivec<N>,ivec<N>\":function(a,b){a.elements.set(b.elements);return a},\"ivec<N>,array<N>\":function(a,b){a.elements.set(b);return a},\"ivec<N>,vec<N>\":function(a,b){a.elements.set(b.elements);return a},\"ivec<N>,uvec<N>\":function(a,b){a.elements.set(b.elements);return a},\"ivec<N>,bvec<N>\":function(a,\r\n\tb){a.elements.set(b.elements);return a},\"bvec<N>,ivec<N>\":function(a,b){a.elements.set(b.elements);return a},\"bvec<N>,array<N>\":function(a,b){a.elements.set(b);return a},\"bvec<N>,vec<N>\":function(a,b){a.elements.set(b.elements);return a},\"bvec<N>,uvec<N>\":function(a,b){a.elements.set(b.elements);return a},\"bvec<N>,bvec<N>\":function(a,b){a.elements.set(b.elements);return a},\"quat,quat\":function(a,b){a.elements.set(b.elements);return a},\"mat<N>,mat<N>\":function(a,b){a.elements.set(b.elements);return a},\r\n\t\"mat<N>,array<N>\":function(a,b){b=b.reduce(function(a,b){if(!a.concat)throw new GLM.GLMJSError(\"matN,arrayN -- [[.length===4] x 4] expected\");return a.concat(b)});if(b===N)throw new GLM.GLMJSError(\"matN,arrayN -- [[N],[N],[N],[N]] expected\");return a[\"=\"](b)},\"mat<N>,array<N*N>\":function(a,b){a.elements.set(b);return a},\"mat4,array9\":function(a,b){a.elements.set((new GLM.mat4(b)).elements);return a}},sub:{$op:\"-\",_sub:function(a,b){return this.GLM.$to_array(a).map(function(a,e){return a-b[e]})},\"vec<N>,vec<N>\":function(a,\r\n\tb){return new this.GLM.vecN(this._sub(a,b))},\"vec<N>,uvec<N>\":function(a,b){return new this.GLM.vecN(this._sub(a,b))},\"uvec<N>,uvec<N>\":function(a,b){return new this.GLM.uvecN(this._sub(a,b))},\"uvec<N>,ivec<N>\":function(a,b){return new this.GLM.uvecN(this._sub(a,b))},\"vec<N>,ivec<N>\":function(a,b){return new this.GLM.vecN(this._sub(a,b))},\"ivec<N>,uvec<N>\":function(a,b){return new this.GLM.ivecN(this._sub(a,b))},\"ivec<N>,ivec<N>\":function(a,b){return new this.GLM.ivecN(this._sub(a,b))}},sub_eq:{$op:\"-=\",\r\n\t\"vec<N>,vec<N>\":function(a,b){for(var c=a.elements,e=b.elements,d=0;d<N;d++)c[d]-=e[d];return a},\"vec<N>,uvec<N>\":function(a,b){return this[\"vecN,vecN\"](a,b)},\"uvec<N>,uvec<N>\":function(a,b){return this[\"vecN,vecN\"](a,b)},\"uvec<N>,ivec<N>\":function(a,b){return this[\"vecN,vecN\"](a,b)},\"vec<N>,ivec<N>\":function(a,b){return this[\"vecN,vecN\"](a,b)},\"ivec<N>,ivec<N>\":function(a,b){return this[\"vecN,vecN\"](a,b)},\"ivec<N>,uvec<N>\":function(a,b){return this[\"vecN,vecN\"](a,b)}},add:{$op:\"+\",_add:function(a,\r\n\tb){return this.GLM.$to_array(a).map(function(a,e){return a+b[e]})},\"vec<N>,float\":function(a,b){return new this.GLM.vecN(this._add(a,[b,b,b,b]))},\"vec<N>,vec<N>\":function(a,b){return new this.GLM.vecN(this._add(a,b))},\"vec<N>,uvec<N>\":function(a,b){return new this.GLM.vecN(this._add(a,b))},\"uvec<N>,uvec<N>\":function(a,b){return new this.GLM.uvecN(this._add(a,b))},\"uvec<N>,ivec<N>\":function(a,b){return new this.GLM.uvecN(this._add(a,b))},\"vec<N>,ivec<N>\":function(a,b){return new this.GLM.vecN(this._add(a,\r\n\tb))},\"ivec<N>,ivec<N>\":function(a,b){return new this.GLM.ivecN(this._add(a,b))},\"ivec<N>,uvec<N>\":function(a,b){return new this.GLM.ivecN(this._add(a,b))}},add_eq:{$op:\"+=\",\"vec<N>,vec<N>\":function(a,b){for(var c=a.elements,e=b.elements,d=0;d<N;d++)c[d]+=e[d];return a},\"vec<N>,uvec<N>\":function(a,b){return this[\"vecN,vecN\"](a,b)},\"uvec<N>,uvec<N>\":function(a,b){return this[\"vecN,vecN\"](a,b)},\"uvec<N>,ivec<N>\":function(a,b){return this[\"vecN,vecN\"](a,b)},\"vec<N>,ivec<N>\":function(a,b){return this[\"vecN,vecN\"](a,\r\n\tb)},\"ivec<N>,ivec<N>\":function(a,b){return this[\"vecN,vecN\"](a,b)},\"ivec<N>,uvec<N>\":function(a,b){return this[\"vecN,vecN\"](a,b)}},div:{$op:\"/\",\"vec<N>,float\":function(a,b){return new this.GLM.vecN(this.GLM.$to_array(a).map(function(a){return a/b}))}},div_eq:{$op:\"/=\",\"vec<N>,float\":function(a,b){for(var c=0;c<N;c++)a.elements[c]/=b;return a}},mul:{$op:\"*\",\"vec<N>,vec<N>\":function(a,b){return new this.GLM.vecN(this.GLM.$to_array(a).map(function(a,e){return a*b[e]}))}},eql_epsilon:function(a){return{$op:\"~=\",\r\n\t\"vec<N>,vec<N>\":a,\"mat<N>,mat<N>\":a,\"quat,quat\":a,\"uvec<N>,uvec<N>\":a,\"ivec<N>,ivec<N>\":a}}(function(a,b){return this.GLM.all(this.GLM.epsilonEqual(a,b,this.GLM.epsilon()))}),eql:function(a){return{$op:\"==\",\"mat<N>,mat<N>\":function(a,c){return c.elements.length===glm.$to_array(a).filter(function(a,b){return a===c.elements[b]}).length},\"vec<N>,vec<N>\":a,\"quat,quat\":a,\"uvec<N>,uvec<N>\":a,\"ivec<N>,ivec<N>\":a,\"bvec<N>,bvec<N>\":a}}(function(a,b){return GLM.all(GLM.equal(a,b))})});\r\n\tGLM.string={$type_name:\"string\",$:{}};GLM.number={$type_name:\"float\",$:{}};GLM[\"boolean\"]={$type:\"bool\",$type_name:\"bool\",$:{}};\r\n\tGLM.vec2=GLM.$template.GLMType(\"vec2\",{name:\"fvec2\",identity:[0,0],components:[\"xy\",\"01\"],undefined0:function(){return this.identity},number1:function(a){return[a,a]},number2:function(a,b){return[a,b]},object1:function(a){if(null!==a)switch(a.length){case 4:case 3:case 2:return[a[0],a[1]];default:if(\"y\"in a&&\"x\"in a){if(typeof a.x!==typeof a.y)throw new GLM.GLMJSError(\"unrecognized .x-ish object passed to GLM.vec2: \"+a);return\"string\"===typeof a.x?[1*a.x,1*a.y]:[a.x,a.y]}}throw new GLM.GLMJSError(\"unrecognized object passed to GLM.vec2: \"+\r\n\ta);}});\r\n\tGLM.uvec2=GLM.$template.GLMType(\"uvec2\",{name:\"uvec2\",identity:[0,0],components:[\"xy\",\"01\"],_clamp:function(a){return~~a},undefined0:function(){return this.identity},number1:function(a){a=this._clamp(a);return[a,a]},number2:function(a,b){a=this._clamp(a);b=this._clamp(b);return[a,b]},object1:function(a){switch(a.length){case 4:case 3:case 2:return[a[0],a[1]].map(this._clamp);default:if(\"y\"in a&&\"x\"in a){if(typeof a.x!==typeof a.y)throw new GLM.GLMJSError(\"unrecognized .x-ish object passed to GLM.\"+this.name+\r\n\t\": \"+a);return[a.x,a.y].map(this._clamp)}}throw new GLM.GLMJSError(\"unrecognized object passed to GLM.\"+this.name+\": \"+a);}});\r\n\tGLM.vec3=GLM.$template.GLMType(\"vec3\",{name:\"fvec3\",identity:[0,0,0],components:[\"xyz\",\"012\",\"rgb\"],undefined0:function(){return GLM.vec3.$.identity},number1:function(a){return[a,a,a]},number2:function(a,b){return[a,b,b]},number3:function(a,b,c){return[a,b,c]},Error:GLM.GLMJSError,object1:function(a){if(a)switch(a.length){case 4:case 3:return[a[0],a[1],a[2]];case 2:return[a[0],a[1],a[1]];default:if(\"z\"in a&&\"x\"in a){if(typeof a.x!==typeof a.y)throw new this.Error(\"unrecognized .x-ish object passed to GLM.vec3: \"+\r\n\ta);return\"string\"===typeof a.x?[1*a.x,1*a.y,1*a.z]:[a.x,a.y,a.z]}}throw new this.Error(\"unrecognized object passed to GLM.vec3: \"+a);},object2:function(a,b){if(a instanceof GLM.vec2||a instanceof GLM.uvec2||a instanceof GLM.ivec2||a instanceof GLM.bvec2)return[a.x,a.y,b];throw new GLM.GLMJSError(\"unrecognized object passed to GLM.vec3(o,z): \"+[a,b]);}});\r\n\tGLM.uvec3=GLM.$template.GLMType(\"uvec3\",{name:\"uvec3\",identity:[0,0,0],components:[\"xyz\",\"012\"],_clamp:GLM.uvec2.$._clamp,undefined0:function(){return this.identity},number1:function(a){a=this._clamp(a);return[a,a,a]},number2:function(a,b){a=this._clamp(a);b=this._clamp(b);return[a,b,b]},number3:function(a,b,c){a=this._clamp(a);b=this._clamp(b);c=this._clamp(c);return[a,b,c]},object1:function(a){if(a)switch(a.length){case 4:case 3:return[a[0],a[1],a[2]].map(this._clamp);case 2:return[a[0],a[1],a[1]].map(this._clamp);\r\n\tdefault:if(\"z\"in a&&\"x\"in a){if(typeof a.x!==typeof a.y)throw new GLM.GLMJSError(\"unrecognized .x-ish object passed to GLM.\"+this.name+\": \"+a);return[a.x,a.y,a.z].map(this._clamp)}}throw new GLM.GLMJSError(\"unrecognized object passed to GLM.\"+this.name+\": \"+a);},object2:function(a,b){if(a instanceof GLM.vec2)return[a.x,a.y,b].map(this._clamp);if(a instanceof GLM.uvec2||a instanceof GLM.ivec2||a instanceof GLM.bvec2)return[a.x,a.y,this._clamp(b)];throw new GLM.GLMJSError(\"unrecognized object passed to GLM.\"+\r\n\tthis.name+\"(o,z): \"+[a,b]);}});\r\n\tGLM.vec4=GLM.$template.GLMType(\"vec4\",{name:\"fvec4\",identity:[0,0,0,0],components:[\"xyzw\",\"0123\",\"rgba\"],undefined0:function(){return this.identity},number1:function(a){return[a,a,a,a]},number2:function(a,b){return[a,b,b,b]},number3:function(a,b,c){return[a,b,c,c]},number4:function(a,b,c,e){return[a,b,c,e]},Error:GLM.GLMJSError,object1:function(a){if(a)switch(a.length){case 4:return[a[0],a[1],a[2],a[3]];case 3:return[a[0],a[1],a[2],a[2]];case 2:return[a[0],a[1],a[1],a[1]];default:if(\"w\"in a&&\"x\"in\r\n\ta){if(typeof a.x!==typeof a.w)throw new this.Error(\"unrecognized .x-ish object passed to GLM.vec4: \"+a);return\"string\"===typeof a.x?[1*a.x,1*a.y,1*a.z,1*a.w]:[a.x,a.y,a.z,a.w]}}throw new this.Error(\"unrecognized object passed to GLM.vec4: \"+[a,a&&a.$type]);},$GLM:GLM,object2:function(a,b){if(a instanceof this.$GLM.vec3||a instanceof this.$GLM.uvec3||a instanceof this.$GLM.ivec3||a instanceof this.$GLM.bvec3)return[a.x,a.y,a.z,b];throw new this.$GLM.GLMJSError(\"unrecognized object passed to GLM.vec4(o,w): \"+\r\n\t[a,b]);},object3:function(a,b,c){if(a instanceof this.$GLM.vec2||a instanceof this.$GLM.uvec2||a instanceof this.$GLM.ivec2||a instanceof this.$GLM.bvec2)return[a.x,a.y,b,c];throw new this.$GLM.GLMJSError(\"unrecognized object passed to GLM.vec4(o,z,w): \"+[a,b,c]);}});\r\n\tGLM.uvec4=GLM.$template.GLMType(\"uvec4\",{name:\"uvec4\",identity:[0,0,0,0],components:[\"xyzw\",\"0123\"],_clamp:GLM.uvec2.$._clamp,undefined0:function(){return this.identity},number1:function(a){a=this._clamp(a);return[a,a,a,a]},number2:function(a,b){a=this._clamp(a);b=this._clamp(b);return[a,b,b,b]},number3:function(a,b,c){a=this._clamp(a);b=this._clamp(b);c=this._clamp(c);return[a,b,c,c]},number4:function(a,b,c,e){return[a,b,c,e].map(this._clamp)},Error:GLM.GLMJSError,object1:function(a){if(a)switch(a.length){case 4:return[a[0],\r\n\ta[1],a[2],a[3]].map(this._clamp);case 3:return[a[0],a[1],a[2],a[2]].map(this._clamp);case 2:return[a[0],a[1],a[1],a[1]].map(this._clamp);default:if(\"w\"in a&&\"x\"in a){if(typeof a.x!==typeof a.y)throw new this.Error(\"unrecognized .x-ish object passed to GLM.\"+this.name+\": \"+a);return[a.x,a.y,a.z,a.w].map(this._clamp)}}throw new GLM.GLMJSError(\"unrecognized object passed to GLM.\"+this.name+\": \"+[a,a&&a.$type]);},object2:function(a,b){if(a instanceof GLM.vec3)return[a.x,a.y,a.z,b].map(this._clamp);if(a instanceof\r\n\tGLM.uvec3||a instanceof GLM.ivec3||a instanceof GLM.bvec3)return[a.x,a.y,a.z,this._clamp(b)];throw new GLM.GLMJSError(\"unrecognized object passed to GLM.\"+this.name+\"(o,w): \"+[a,b]);},object3:function(a,b,c){if(a instanceof GLM.vec2)return[a.x,a.y,b,c].map(this._clamp);if(a instanceof GLM.uvec2||a instanceof GLM.ivec2||a instanceof GLM.bvec2)return[a.x,a.y,this._clamp(b),this._clamp(c)];throw new GLM.GLMJSError(\"unrecognized object passed to GLM.\"+this.name+\"(o,z,w): \"+[a,b,c]);}});\r\n\tGLM.ivec2=GLM.$template.GLMType(\"ivec2\",GLM.$template.extend({},GLM.uvec2.$,{name:\"ivec2\"}));GLM.ivec3=GLM.$template.GLMType(\"ivec3\",GLM.$template.extend({},GLM.uvec3.$,{name:\"ivec3\"}));GLM.ivec4=GLM.$template.GLMType(\"ivec4\",GLM.$template.extend({},GLM.uvec4.$,{name:\"ivec4\"}));GLM.bvec2=GLM.$template.GLMType(\"bvec2\",GLM.$template.extend({},GLM.uvec2.$,{name:\"bvec2\",boolean1:GLM.uvec2.$.number1,boolean2:GLM.uvec2.$.number2}));\r\n\tGLM.bvec3=GLM.$template.GLMType(\"bvec3\",GLM.$template.extend({},GLM.uvec3.$,{name:\"bvec3\",boolean1:GLM.uvec3.$.number1,boolean2:GLM.uvec3.$.number2,boolean3:GLM.uvec3.$.number3}));GLM.bvec4=GLM.$template.GLMType(\"bvec4\",GLM.$template.extend({},GLM.uvec4.$,{name:\"bvec4\",boolean1:GLM.uvec4.$.number1,boolean2:GLM.uvec4.$.number2,boolean3:GLM.uvec4.$.number3,boolean4:GLM.uvec4.$.number4}));GLM.bvec2.$._clamp=GLM.bvec3.$._clamp=GLM.bvec4.$._clamp=function(a){return!!a};\r\n\tGLM.mat3=GLM.$template.GLMType(\"mat3\",{name:\"mat3x3\",identity:[1,0,0,0,1,0,0,0,1],undefined0:function(){return this.identity},number1:function(a){return 1===a?this.identity:[a,0,0,0,a,0,0,0,a]},number9:function(a,b,c,e,d,h,j,g,k){return arguments},Error:GLM.GLMJSError,$vec3:GLM.vec3,object1:function(a){if(a){var b=a.elements||a;if(16===b.length)return[b[0],b[1],b[2],b[4],b[5],b[6],b[8],b[9],b[10]];if(9===b.length)return b;if(0 in b&&1 in b&&2 in b&&!(3 in b)&&\"object\"===typeof b[2])return[b[0],b[1],\r\n\tb[2]].map(this.$vec3.$.object1).reduce(function(a,b){return a.concat(b)})}throw new this.Error(\"unrecognized object passed to GLM.mat3: \"+a);},object3:function(a,b,c){return[a,b,c].map(glm.$to_array).reduce(function(a,b){return a.concat(b)})}});\r\n\tGLM.mat4=GLM.$template.GLMType(\"mat4\",{name:\"mat4x4\",identity:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],undefined0:function(){return this.identity},number16:function(a,b,c,e,d,h,j,g,k,i,w,r,m,q,s,t){return arguments},number1:function(a){return 1===a?this.identity:[a,0,0,0,0,a,0,0,0,0,a,0,0,0,0,a]},Error:GLM.GLMJSError,$vec4:GLM.vec4,object1:function(a){var b;if(a){b=a.elements||a;if(9===b.length)return[b[0],b[1],b[2],0,b[3],b[4],b[5],0,b[6],b[7],b[8],0,0,0,0,1];if(4===b.length&&b[0]&&4===b[0].length)return b[0].concat(b[1],\r\n\tb[2],b[3]);if(16===b.length)return b;if(0 in b&&1 in b&&2 in b&&3 in b&&!(4 in b)&&\"object\"===typeof b[3])return[b[0],b[1],b[2],b[3]].map(this.$vec4.$.object1).reduce(function(a,b){return a.concat(b)})}throw new this.Error(\"unrecognized object passed to GLM.mat4: \"+[a,b&&b.length]);},object4:function(a,b,c,e){return[a,b,c,e].map(glm.$to_array).reduce(function(a,b){return a.concat(b)})}});\r\n\tGLM.quat=GLM.$template.GLMType(\"quat\",{identity:[0,0,0,1],components:[\"xyzw\",\"0123\"],undefined0:function(){return this.identity},number1:function(a){if(1!==a)throw Error(\"only quat(1) syntax supported for quat(number1 args)...\");return this.identity},number4:function(a,b,c,e){return[b,c,e,a]},$GLM:GLM,$M3:GLM.mat3(),$quat_array_from_zyx:function(a){var b=this.$M3;return this.$GLM.$outer.quat_angleAxis(a.z,b[2]).mul(this.$GLM.$outer.quat_angleAxis(a.y,b[1])).mul(this.$GLM.$outer.quat_angleAxis(a.x,\r\n\tb[0])).elements},object1:function(a){if(a){if(a instanceof this.$GLM.mat4)return this.$GLM.$outer.quat_array_from_mat4(a);if(4===a.length)return[a[0],a[1],a[2],a[3]];if(a instanceof this.$GLM.quat)return[a.x,a.y,a.z,a.w];if(a instanceof this.$GLM.vec3)return this.$quat_array_from_zyx(a);if(\"w\"in a&&\"x\"in a)return\"string\"===typeof a.x?[1*a.x,1*a.y,1*a.z,1*a.w]:[a.x,a.y,a.z,a.w]}throw new this.$GLM.GLMJSError(\"unrecognized object passed to GLM.quat.object1: \"+[a,a&&a.$type,typeof a,a&&a.constructor]);\r\n\t}});\r\n\t(function(){var a=function(a,b,c,e){var k={def:function(b,c){this[b]=c;Object.defineProperty(a.prototype,b,c)}};a.$properties=a.$properties||k;var i=a.$properties.def.bind(a.$properties),w=[0,1,2,3].map(function(a){return{enumerable:c,get:function(){return this.elements[a]},set:function(b){this.elements[a]=b}}});b.forEach(function(a,b){i(a,w[b])});if(isNaN(b[0])&&!/^_/.test(b[0])){var k=b.slice(),r=GLM.$subarray;do(function(a,b,c){\"quat\"===b&&(b=\"vec\"+c);var d=GLM[b];i(a,{enumerable:!1,get:function(){return new d(r(this.elements,0*\r\n\tc,1*c))},set:function(a){return(new d(r(this.elements,0*c,1*c)))[\"=\"](a)}})})(k.join(\"\"),a.prototype.$type.replace(/[1-9]$/,k.length),k.length);while(k[1]!=k.pop());if(e)return a.$properties;k=b.slice();if(b={xyz:{yz:1},xyzw:{yzw:1,yz:1,zw:2}}[k.join(\"\")])for(var m in b)(function(a,b,c,d){i(a,{enumerable:!1,get:function(){return new GLM[b](GLM.$subarray(this.elements,0*c+d,1*c+d))},set:function(a){return(new GLM[b](GLM.$subarray(this.elements,0*c+d,1*c+d)))[\"=\"](a)}})})(m,a.prototype.$type.replace(/[1-9]$/,\r\n\tm.length),m.length,b[m])}return a.$properties};a(GLM.vec2,GLM.vec2.$.components[0],!0);a(GLM.vec2,GLM.vec2.$.components[1]);a(GLM.vec3,GLM.vec3.$.components[0],!0);a(GLM.vec3,GLM.vec3.$.components[1]);a(GLM.vec3,GLM.vec3.$.components[2]);a(GLM.vec4,GLM.vec4.$.components[0],!0);a(GLM.vec4,GLM.vec4.$.components[1]);a(GLM.vec4,GLM.vec4.$.components[2]);a(GLM.quat,GLM.quat.$.components[0],!0,\"noswizzles\");a(GLM.quat,GLM.quat.$.components[1]);GLM.quat.$properties.def(\"wxyz\",{enumerable:!1,get:function(){return new GLM.vec4(this.w,\r\n\tthis.x,this.y,this.z)},set:function(a){a=GLM.vec4(a);return this[\"=\"](GLM.quat(a.x,a.y,a.z,a.w))}});\"uvec2 uvec3 uvec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4\".split(\" \").forEach(function(b){a(GLM[b],GLM[b].$.components[0],!0);a(GLM[b],GLM[b].$.components[1])});Object.defineProperty(GLM.quat.prototype,\"_x\",{get:function(){throw Error(\"erroneous quat._x access\");}});var b={2:{yx:{enumerable:!1,get:function(){return new GLM.vec2(this.y,this.x)},set:function(a){a=GLM.vec2(a);this.y=a[0];this.x=a[1]}}},3:{xz:{enumerable:!1,\r\n\tget:function(){return new GLM.vec2(this.x,this.z)},set:function(a){a=GLM.vec2(a);this.x=a[0];this.z=a[1]}},zx:{enumerable:!1,get:function(){return new GLM.vec2(this.z,this.x)},set:function(a){a=GLM.vec2(a);this.z=a[0];this.x=a[1]}},xzy:{enumerable:!1,get:function(){return new GLM.vec3(this.x,this.z,this.y)},set:function(a){a=GLM.vec3(a);this.x=a[0];this.z=a[1];this.y=a[2]}}},4:{xw:{enumerable:!1,get:function(){return new GLM.vec2(this.x,this.w)},set:function(a){a=GLM.vec2(a);this.x=a[0];this.w=a[1]}},\r\n\twz:{enumerable:!1,get:function(){return new GLM.vec2(this.w,this.z)},set:function(a){a=GLM.vec2(a);this.w=a[0];this.z=a[1]}},wxz:{enumerable:!1,get:function(){return new GLM.vec3(this.w,this.x,this.z)},set:function(a){a=GLM.vec3(a);this.w=a[0];this.x=a[1];this.z=a[2];return this}},xyw:{enumerable:!1,get:function(){return new GLM.vec3(this.x,this.y,this.w)},set:function(a){a=GLM.vec3(a);this.x=a[0];this.y=a[1];this.w=a[2];return this}},xzw:{enumerable:!1,get:function(){return new GLM.vec3(this.x,this.z,\r\n\tthis.w)},set:function(a){a=GLM.vec3(a);this.x=a[0];this.z=a[1];this.w=a[2]}},wxyz:{enumerable:!1,get:function(){return new GLM.vec4(this.w,this.x,this.y,this.z)},set:function(a){a=GLM.vec4(a);this.w=a[0];this.x=a[1];this.y=a[2];this.z=a[3];return this}}}},c;for(c in b)for(var e in b[c])2>=c&&GLM.vec2.$properties.def(e,b[c][e]),3>=c&&GLM.vec3.$properties.def(e,b[c][e]),4>=c&&GLM.vec4.$properties.def(e,b[c][e]);GLM.$partition=function(a,b,c,e){if(void 0===c)throw new GLM.GLMJSError(\"nrows is undefined\");\r\n\tvar k=b.$.identity.length;c=c||k;for(var i=function(a){3<GLM.$DEBUG&&GLM.$outer.console.debug(\"CACHEDBG: \"+a)},w=0;w<c;w++)(function(c){var j=e&&e+c,q=c*k;Object.defineProperty(a,c,{configurable:!0,enumerable:!0,set:function(e){if(e instanceof b)this.elements.set(e.elements,q);else if(e&&e.length===k)this.elements.set(e,q);else throw new GLM.GLMJSError(\"unsupported argtype to \"+(a&&a.$type)+\"[\"+c+\"] setter: \"+[typeof e,e]);},get:function(){if(e){if(this[j])return c||i(\"cache hit \"+j),this[j];c||i(\"cache miss \"+\r\n\tj)}var a,d=new b(a=GLM.$subarray(this.elements,q,q+k));if(d.elements!==a)throw new GLM.GLMJSError(\"v.elements !== t \"+[GLM.$subarray,d.elements.constructor===a.constructor,d.elements.buffer===a.buffer]);e&&Object.defineProperty(this,j,{configurable:!0,enumerable:!1,value:d});return d}})})(w)};GLM.$partition(GLM.mat4.prototype,GLM.vec4,4,\"_cache_\");GLM.$partition(GLM.mat3.prototype,GLM.vec3,3,\"_cache_\")})();\r\n\tGLM.$dumpTypes=function(a){GLM.$types.forEach(function(b){GLM[b].componentLength&&a(\"GLM.\"+b,JSON.stringify({\"#type\":GLM[b].prototype.$type_name,\"#floats\":GLM[b].componentLength,\"#bytes\":GLM[b].BYTES_PER_ELEMENT}))})};\r\n\tGLM.$init=function(a){a.prefix&&(GLMJS_PREFIX=a.prefix);GLM.$prefix=GLMJS_PREFIX;var b=a.log||function(){};try{b(\"GLM-js: ENV: \"+_ENV._VERSION)}catch(c){}b(\"GLM-JS: initializing: \"+JSON.stringify(a,0,2));b(JSON.stringify({functions:Object.keys(GLM.$outer.functions)}));var e=GLM.mat4,d=GLM.$outer;GLM.toMat4=function(a){return new e(d.mat4_array_from_quat(a))};GLM.$template.extend(GLM.rotation.$template,{$quat:GLM.quat,$dot:GLM.dot.link(\"vec3,vec3\"),$epsilon:GLM.epsilon(),$m:GLM.mat3(),$pi:GLM.pi(),\r\n\t$length2:GLM.length2.link(\"vec3\"),$cross:GLM.cross.link(\"vec3,vec3\"),$normalize:GLM.normalize.link(\"vec3\"),$angleAxis:GLM.angleAxis.link(\"float,vec3\"),$sqrt:GLM.sqrt});GLM.$symbols=[];for(var h in GLM)\"function\"===typeof GLM[h]&&/^[a-z]/.test(h)&&GLM.$symbols.push(h);GLM.$types.forEach(function(a){var b=GLM[a].prototype.$type,c;for(c in GLM.$outer.functions){var d=GLM.$outer.functions[c];d.$op&&(GLM.$DEBUG&&GLM.$outer.console.debug(\"mapping operator<\"+b+\"> \"+c+\" / \"+d.$op),GLM[a].prototype[c]=d,GLM[a].prototype[d.$op]=\r\n\td)}});b(\"GLM-JS: \"+GLM.version+\" emulating GLM_VERSION=\"+GLM.GLM_VERSION+\" vendor_name=\"+a.vendor_name+\" vendor_version=\"+a.vendor_version);glm.vendor=a};\r\n\tGLM.using_namespace=function(a){GLM.$DEBUG&&GLM.$outer.console.debug(\"GLM.using_namespace munges globals; it should probably not be used!\");GLM.using_namespace.$tmp={ret:void 0,tpl:a,names:GLM.$symbols,saved:{},evals:[],restore:[],before:[],after:[]};eval(GLM.using_namespace.$tmp.names.map(function(a,c){return\"GLM.using_namespace.$tmp.saved['\"+a+\"'] = GLM.using_namespace.$tmp.before[\"+c+\"] = 'undefined' !== typeof \"+a+\";\"}).join(\"\\n\"));GLM.$DEBUG&&console.warn(\"GLM.using_namespace before #globals: \"+\r\n\tGLM.using_namespace.$tmp.before.length);GLM.using_namespace.$tmp.names.map(function(a){GLM.using_namespace.$tmp.restore.push(a+\"=GLM.using_namespace.$tmp.saved['\"+a+\"'];\"+(\"GLM.using_namespace.$tmp.saved['\"+a+\"']=undefined;delete GLM.using_namespace.$tmp.saved['\"+a+\"'];\"));GLM.using_namespace.$tmp.evals.push(a+\"=GLM.\"+a+\";\")});eval(GLM.using_namespace.$tmp.evals.join(\"\\n\"));GLM.using_namespace.$tmp.ret=a();eval(GLM.using_namespace.$tmp.restore.join(\"\\n\"));eval(GLM.using_namespace.$tmp.names.map(function(a,\r\n\tc){return\"GLM.using_namespace.$tmp.after[\"+c+\"] = 'undefined' !== typeof \"+a+\";\"}).join(\"\\n\"));GLM.$DEBUG&&console.warn(\"GLM.using_namespace after #globals: \"+GLM.using_namespace.$tmp.after.length);a=GLM.using_namespace.$tmp.ret;delete GLM.using_namespace.$tmp;return a};\r\n\tfunction $GLM_extern(a,b){b=b||a;return function(){GLM[b]=GLM.$outer.functions[a]||GLM.$outer[a];if(!GLM[b])throw new GLM.GLMJSError(\"$GLM_extern: unresolved external symbol: \"+a);GLM.$DEBUG&&GLM.$outer.console.debug(\"$GLM_extern: resolved external symbol \"+a+\" \"+typeof GLM[b]);return GLM[b].apply(this,arguments)}}\r\n\tfunction GLM_polyfills(){var a={};\"bind\"in Function.prototype||(a.bind=Function.prototype.bind=function(a){function c(){}if(\"function\"!==typeof this)throw new TypeError(\"not callable\");var e=[].slice,d=e.call(arguments,1),h=this,j=function(){return h.apply(this instanceof c?this:a||global,d.concat(e.call(arguments)))};c.prototype=this.prototype||c.prototype;j.prototype=new c;return j});return a}\r\n\t$GLM_reset_logging.current=function(){return{$GLM_log:\"undefined\"!==typeof $GLM_log&&$GLM_log,$GLM_console_log:\"undefined\"!==typeof $GLM_console_log&&$GLM_console_log,$GLM_console_prefixed:\"undefined\"!==typeof $GLM_console_prefixed&&$GLM_console_prefixed,console:GLM.$outer.console}};\r\n\tfunction $GLM_reset_logging(a){a&&\"object\"===typeof a&&($GLM_log=a.$GLM_log,$GLM_console_log=a.$GLM_console_log,$GLM_console_factory=a.$GLM_console_factory,GLM.$outer.console=a.console,a=!1);if(a||\"undefined\"===typeof $GLM_log)$GLM_log=function(a,b){GLM.$outer.console.log.apply(GLM.$outer.console,[].slice.call(arguments).map(function(a){var b=typeof a;return\"xboolean\"===b||\"string\"===b?a+\"\":GLM.$isGLMObject(a)||!isNaN(a)?GLM.to_string(a):a+\"\"}))};if(a||\"undefined\"===typeof $GLM_console_log)$GLM_console_log=\r\n\tfunction(a,b){(console[a]||function(){}).apply(console,[].slice.call(arguments,1))};if(a||\"undefined\"===typeof $GLM_console_factory)$GLM_console_factory=function(a){return $GLM_console_log.bind($GLM_console_log,a)};var b=$GLM_console_factory,c={};\"debug,warn,info,error,log,write\".replace(/\\w+/g,function(a){c[a]=b(a)});\"object\"===typeof GLM&&(GLM.$outer&&(GLM.$outer.console=c),GLM.$log=$GLM_log);return c}try{window.$GLM_reset_logging=this.$GLM_reset_logging=$GLM_reset_logging}catch(e$$19){}\r\n\tGLM.$reset_logging=$GLM_reset_logging;GLM.$log=GLM.$log||$GLM_log;function $GLM_GLMJSError(a,b){function c(c){this.name=a;this.stack=Error().stack;Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor);this.message=c;b&&b.apply(this,arguments)}c.prototype=Error();c.prototype.name=a;return c.prototype.constructor=c}GLMAT.mat4.exists;glm=GLM;var DLL={_version:\"0.0.2\",_name:\"glm.gl-matrix.js\",_glm_version:glm.version,prefix:\"glm-js[glMatrix]: \",vendor_version:GLMAT.VERSION,vendor_name:\"glMatrix\"};\r\n\tDLL.statics={$outer:GLM.$outer,$typeArray:function(a){return new this.$outer.Float32Array(a)},$mat4:GLM.mat4,$quat:GLM.quat,$mat4$perspective:GLMAT.mat4.perspective,$mat4$ortho:GLMAT.mat4.ortho,mat4_perspective:function(a,b,c,e){return new this.$mat4(this.$mat4$perspective(this.$typeArray(16),a,b,c,e))},mat4_ortho:function(a,b,c,e,d,h){return new this.$mat4(this.$mat4$ortho(this.$typeArray(16),a,b,c,e,d||-1,h||1))},$quat$setAxisAngle:GLMAT.quat.setAxisAngle,$mat4$fromQuat:GLMAT.mat4.fromQuat,mat4_angleAxis:function(a,\r\n\tb){var c=this.$quat$setAxisAngle(this.$typeArray(4),b,a);return new this.$mat4(this.$mat4$fromQuat(this.$typeArray(16),c))},quat_angleAxis:function(a,b){return new this.$quat(this.$quat$setAxisAngle(this.$typeArray(4),b,a))},$mat4$translate:GLMAT.mat4.translate,mat4_translation:function(a){var b=new this.$mat4;this.$mat4$translate(b.elements,b.elements,a.elements);return b},$mat4$scale:GLMAT.mat4.scale,mat4_scale:function(a){var b=new this.$mat4;this.$mat4$scale(b.elements,b.elements,a.elements);\r\n\treturn b},toJSON:function(){var a={},b;for(b in this)0!==b.indexOf(\"$\")&&(a[b]=this[b]);return a},$vec3:GLM.vec3,$clamp:GLM.clamp,mat4_array_from_quat:function(a){return this.$mat4$fromQuat(this.$typeArray(16),a.elements)},$qtmp:new GLM.$outer.Float32Array(9),$quat$fromMat3:GLMAT.quat.fromMat3,$mat3$fromMat4:GLMAT.mat3.fromMat4,quat_array_from_mat4:function(a){return this.$quat$fromMat3(this.$typeArray(4),this.$mat3$fromMat4(this.$qtmp,a.elements))}};\r\n\tDLL[\"declare<T,V,...>\"]={mul:{$op:\"*\",$typeArray:function(a){return new this.GLM.$outer.Float32Array(a)},$vec3$transformQuat:GLMAT.vec3.transformQuat,\"quat,vec3\":function(a,b){return new this.GLM.vec3(this.$vec3$transformQuat(this.$typeArray(3),b.elements,a.elements))},\"vec3,quat\":function(a,b){return this[\"quat,vec3\"](this.GLM.inverse(b),a)},\"quat,vec4\":function(a,b){return this[\"mat4,vec4\"](this.GLM.toMat4(a),b)},\"vec4,quat\":function(a,b){return this[\"quat,vec4\"](this.GLM.inverse(b),a)},\"$vec<N>$scale\":\"GLMAT.vecN.scale\",\r\n\t\"vec<N>,float\":function(a,b){return new this.GLM.vecN(this.$vecN$scale(this.$typeArray(N),a.elements,b))},\"quat,float\":function(a,b){return new a.constructor(this[\"vec4,float\"](a,b).elements)},$vec4$transformMat4:GLMAT.vec4.transformMat4,\"mat4,vec4\":function(a,b){return new GLM.vec4(this.$vec4$transformMat4(this.$typeArray(4),b.elements,a.elements))},\"vec4,mat4\":function(a,b){return this[\"mat4,vec4\"](GLM.inverse(b),a)},\"$mat<N>mul\":\"GLMAT.matN.mul\",\"mat<N>,mat<N>\":function(a,b){return new a.constructor(this.$matNmul(this.$typeArray(N*\r\n\tN),a.elements,b.elements))},$quat$multiply:GLMAT.quat.multiply,\"quat,quat\":function(a,b){return new a.constructor(this.$quat$multiply(this.$typeArray(4),a.elements,b.elements))}},mul_eq:{$op:\"*=\",\"$mat<N>$multiply\":\"GLMAT.matN.multiply\",\"mat<N>,mat<N>\":function(a,b){this.$matN$multiply(a.elements,a.elements,b.elements);return a},\"$vec<N>$scale\":\"GLMAT.vecN.scale\",\"vec<N>,float\":function(a,b){this.$vecN$scale(a.elements,a.elements,b);return a},$quat$multiply:GLMAT.quat.multiply,\"quat,quat\":function(a,\r\n\tb){this.$quat$multiply(a.elements,a.elements,b.elements);return a},$quat$invert:GLMAT.quat.invert,$vec3$transformQuat:GLMAT.vec3.transformQuat,\"inplace:vec3,quat\":function(a,b){var c=this.$quat$invert(new this.GLM.$outer.Float32Array(4),b.elements);this.$vec3$transformQuat(a.elements,a.elements,c);return a},$mat4$invert:GLMAT.mat4.invert,$vec4$transformMat4:GLMAT.vec4.transformMat4,\"inplace:vec4,mat4\":function(a,b){var c=this.$mat4$invert(new this.GLM.$outer.Float32Array(16),b.elements);this.$vec4$transformMat4(a.elements,\r\n\ta.elements,c);return a}},cross:{$vec2$cross:GLMAT.vec2.cross,\"vec2,vec2\":function(a,b){return new this.GLM.vec3(this.$vec2$cross(new this.GLM.$outer.Float32Array(3),a,b))},$vec3$cross:GLMAT.vec3.cross,\"vec3,vec3\":function(a,b){return new this.GLM.vec3(this.$vec3$cross(new this.GLM.$outer.Float32Array(3),a,b))}},dot:{\"$vec<N>$dot\":\"GLMAT.vecN.dot\",\"vec<N>,vec<N>\":function(a,b){return this.$vecN$dot(a,b)}},lookAt:{$mat4$lookAt:GLMAT.mat4.lookAt,\"vec3,vec3\":function(a,b,c){return new this.GLM.mat4(this.$mat4$lookAt(new this.GLM.$outer.Float32Array(16),\r\n\ta.elements,b.elements,c.elements))}}};DLL[\"declare<T,V,number>\"]={mix:{$quat$slerp:GLMAT.quat.slerp,\"quat,quat\":function(a,b,c){return new GLM.quat(this.$quat$slerp(new GLM.$outer.Float32Array(4),a.elements,b.elements,c))}}};DLL[\"declare<T,V,number>\"].slerp=DLL[\"declare<T,V,number>\"].mix;\r\n\tDLL[\"declare<T>\"]={normalize:{\"$vec<N>normalize\":\"GLMAT.vecN.normalize\",$typeArray:function(a){return new this.GLM.$outer.Float32Array(a)},\"vec<N>\":function(a){return new this.GLM.vecN(this.$vecNnormalize(this.$typeArray(N),a))},$quat$normalize:GLMAT.quat.normalize,quat:function(a){return new this.GLM.quat(this.$quat$normalize(new this.GLM.$outer.Float32Array(4),a.elements))}},length:{$quat$length:GLMAT.quat.length,quat:function(a){return this.$quat$length(a.elements)},\"$vec<N>$length\":\"GLMAT.vecN.length\",\r\n\t\"vec<N>\":function(a){return this.$vecN$length(a.elements)}},length2:{$quat$squaredLength:GLMAT.quat.squaredLength,quat:function(a){return this.$quat$squaredLength(a.elements)},\"$vec<N>$squaredLength\":\"GLMAT.vecN.squaredLength\",\"vec<N>\":function(a){return this.$vecN$squaredLength(a.elements)}},inverse:{$quatinvert:GLMAT.quat.invert,quat:function(a){return this.GLM.quat(this.$quatinvert(new this.GLM.$outer.Float32Array(4),a.elements))},$mat4invert:GLMAT.mat4.invert,mat4:function(a){a=a.clone();return null===\r\n\tthis.$mat4invert(a.elements,a.elements)?a[\"=\"](this.GLM.mat4()):a}},transpose:{$mat4$transpose:GLMAT.mat4.transpose,mat4:function(a){a=a.clone();this.$mat4$transpose(a.elements,a.elements);return a}}};glm.$outer.$import(DLL);try{module.exports=glm}catch(e$$20){}\r\n\tfunction $GLMVector(a,b,c){this.typearray=c=c||GLM.$outer.Float32Array;if(!(this instanceof $GLMVector))throw new GLM.GLMJSError(\"use new\");if(\"function\"!==typeof a||!GLM.$isGLMConstructor(a))throw new GLM.GLMJSError(\"expecting typ to be GLM.$isGLMConstructor: \"+[typeof a,a?a.$type:a]+\" // \"+GLM.$isGLMConstructor(a));if(1===a.componentLength&&GLM[a.prototype.$type.replace(\"$\",\"$$v\")])throw new GLM.GLMJSError(\"unsupported argtype to glm.$vectorType - for single-value types use glm.\"+a.prototype.$type.replace(\"$\",\r\n\t\"$$v\")+\"...\"+a.prototype.$type);this.glmtype=a;if(!this.glmtype.componentLength)throw Error(\"need .componentLength \"+[a,b,c]);this.componentLength=this.glmtype.componentLength;this.BYTES_PER_ELEMENT=this.glmtype.BYTES_PER_ELEMENT;this._set_$elements=function(a){Object.defineProperty(this,\"$elements\",{enumerable:!1,configurable:!0,value:a});return this.$elements};Object.defineProperty(this,\"elements\",{enumerable:!0,configurable:!0,get:function(){return this.$elements},set:function(a){this._kv&&!this._kv.dynamic&&\r\n\tGLM.$DEBUG&&GLM.$outer.console.warn(\"WARNING: setting .elements on frozen (non-dynamic) GLMVector...\");if(a){var b=this.length;this.length=a.length/this.componentLength;this.byteLength=this.length*this.BYTES_PER_ELEMENT;if(this.length!==Math.round(this.length))throw new GLM.GLMJSError(\"$vectorType.length alignment mismatch \"+JSON.stringify({componentLength:this.componentLength,length:this.length,rounded_length:Math.round(this.length),elements_length:a.length,old_length:b}));}else this.length=this.byteLength=\r\n\t0;return this._set_$elements(a)}});this.elements=b&&new c(b*a.componentLength)}GLM.$vectorType=$GLMVector;GLM.$vectorType.version=\"0.0.2\";\r\n\t$GLMVector.prototype=GLM.$template.extend(new GLM.$GLMBaseType($GLMVector,\"$vectorType\"),{toString:function(){return\"[$GLMVector .elements=#\"+(this.elements&&this.elements.length)+\" .elements[0]=\"+(this.elements&&this.elements[0])+\" ->[0]\"+(this[\"->\"]&&this[\"->\"][0])+\"]\"},\"=\":function(a){if(a instanceof this.constructor||glm.$isGLMObject(a))a=a.elements;return this._set(new this.typearray(a))},_typed_concat:function(a,b,c){var e=a.length+b.length;c=c||new a.constructor(e);c.set(a);c.set(b,a.length);\r\n\treturn c},\"+\":function(a){if(a instanceof this.constructor||glm.$isGLMObject(a))a=a.elements;return new this.constructor(this._typed_concat(this.elements,a))},\"+=\":function(a){if(a instanceof this.constructor||glm.$isGLMObject(a))a=a.elements;return this._set(this._typed_concat(this.elements,a))},_set:function(a){a instanceof this.constructor&&(a=new this.typearray(a.elements));if(!(a instanceof this.typearray))throw new GLM.GLMJSError(\"unsupported argtype to $GLMVector._set \"+(a&&a.constructor));\r\n\tGLM.$DEBUG&&GLM.$outer.console.debug(\"$GLMVector.prototype.set...this.elements:\"+[this.elements&&this.elements.constructor.name,this.elements&&this.elements.length]+\"elements:\"+[a.constructor.name,a.length]);var b=this._kv;this._kv=void 0;this.elements=a;if(this.elements!==a)throw new GLM.GLMJSError(\"err with .elements: \"+[this.glmtype.prototype.$type,this.elements,a]);b&&this._setup(b);return this},arrayize:function(a,b){return this._setup({dynamic:b,setters:a},this.length)},$destroy:function(a){if(a){for(var b=\r\n\tArray.isArray(a),c=function(c){Object.defineProperty(a,c,{enumerable:!0,configurable:!0,value:void 0});delete a[c];b||(a[c]=void 0,delete a[c])},e=0;e<a.length;e++)e in a&&c(e);for(;e in a;)GLM.$DEBUG&&GLM.$outer.console.debug(\"$destroy\",this.name,e),c(e++);b&&(a.length=0)}},_arrlike_toJSON:function(){return this.slice(0)},_mixinArray:function(a){a.toJSON=this._arrlike_toJSON;\"forEach map slice filter join reduce\".split(\" \").forEach(function(b){a[b]=Array.prototype[b]});return a},_setup:function(a,\r\n\tb){var c=this.glmtype,e=this.typearray,d=this.length;this._kv=a;var h=a.stride||this.glmtype.BYTES_PER_ELEMENT,j=a.offset||this.elements.byteOffset,g=a.elements||this.elements,k=a.container||this.arr||[],i=a.setters||!1,w=a.dynamic||!1;\"self\"===k&&(k=this);if(!g)throw new GLMJSError(\"GLMVector._setup - neither kv.elements nor this.elements...\");this.$destroy(this.arr,b);var r=this.arr=this[\"->\"]=k;Array.isArray(r)||this._mixinArray(r);var m=this.componentLength;if(!m)throw new GLM.GLMJSError(\"no componentLength!?\"+\r\n\tObject.keys(this));for(var q=g.buffer.byteLength,s=this,t=0;t<d;t++){var k=j+t*h,z=k+this.glmtype.BYTES_PER_ELEMENT,y=function(){a.i=t;a.next=z;a.last=q;a.offset=a.offset||j;a.stride=a.stride||h;return JSON.stringify(a)};if(k>q)throw Error(\"[\"+t+\"] off \"+k+\" > last \"+q+\" \"+y());if(z>q)throw Error(\"[\"+t+\"] next \"+z+\" > last \"+q+\" \"+y());r[t]=null;var f=function(a,b){var d=new c(new e(a.buffer,b,m));w&&Object.defineProperty(d,\"$elements\",{value:a});return d},y=f(g,k);!i&&!w?r[t]=y:function(a,b,c){Object.defineProperty(r,\r\n\tb,{enumerable:!0,configurable:!0,get:w?function(){a.$elements!==s.elements&&(GLM.$log(\"dynoget rebinding ti\",b,c,a.$elements===s.elements),a=f(s.elements,c));return a}:function(){return a},set:i&&(w?function(d){GLM.$log(\"dynoset\",b,c,a.$elements===s.elements);a.$elements!==s.elements&&(GLM.$log(\"dynoset rebinding ti\",b,c,a.$elements===s.elements),a=f(s.elements,c));return a.copy(d)}:function(b){return a.copy(b)})||void 0})}(y,t,k)}return this},setFromBuffers:function(a){var b=this.elements,c=0;a.forEach(function(a){var d=\r\n\ta.length;if(c+d>b.length){d=Math.min(b.length-c,a.length);if(0>=d)return;a=glm.$subarray(a,0,d);d=a.length}if(c+d>b.length)throw new glm.GLMJSError(\"$vectorType.fromBuffers mismatch \"+[c,d,b.length]);b.set(a,c);c+=a.length});return c},setFromPointer:function(a){if(!(a instanceof GLM.$outer.ArrayBuffer))throw new glm.GLMJSError(\"unsupported argtype \"+[typeof a]+\" - $GLMVector.setFromPointer\");return this._set(new this.typearray(a))}});GLM.exists;GLM.$vectorType.exists;\r\n\tif(GLM.$toTypedArray)throw\"error: glm.experimental.js double-included\";\r\n\tGLM.$toTypedArray=function(a,b,c){var e=b||0,d=typeof e;if(\"number\"===d){if(\"number\"!==typeof c)throw new GLM.GLMJSError(\"GLM.$toTypedArray: unsupported argtype for componentLength (\"+typeof c+\")\");return new a(e*c)}if(\"object\"!==d)throw new GLM.GLMJSError(\"GLM.$toTypedArray: unsupported arrayType: \"+[typeof a,a]);if(e instanceof a)return e;if(e instanceof GLM.$outer.ArrayBuffer||Array.isArray(e))return new a(e);GLM.$isGLMObject(e)&&(d=e.elements,e=new a(d.length),e.set(d));if(!(e instanceof a)&&\r\n\t\"byteOffset\"in e&&\"buffer\"in e)return GLM.$DEBUG&&GLM.$outer.console.warn(\"coercing \"+e.constructor.name+\".buffer into \"+[a.name,e.byteOffset,e.byteLength+\" bytes\",\"~\"+e.byteLength/a.BYTES_PER_ELEMENT+\" coerced elements\"]+\"...\",{byteOffset:e.byteOffset,byteLength:e.byteLength,ecount:e.byteLength/a.BYTES_PER_ELEMENT}),new a(e.buffer,e.byteOffset,e.byteLength/a.BYTES_PER_ELEMENT);if(e instanceof a)return e;throw new GLM.GLMJSError(\"GLM.$toTypedArray: unsupported argtype initializers: \"+[a,b,c]);};\r\n\tGLM.$make_primitive=function(a,b){GLM[a]=function(c){if(!(this instanceof GLM[a]))return new GLM[a](c);\"object\"!==typeof c&&(c=[c]);this.elements=GLM.$toTypedArray(b,c,1)};GLM[a]=eval(GLM.$template._traceable(\"glm_\"+a+\"$class\",GLM[a]))();GLM.$template._add_overrides(a,{$to_string:function(a){return a.$type.replace(/[^a-z]/g,\"\")+\"(\"+a.elements[0]+\")\"},$to_object:function(a){return a.elements[0]},$to_glsl:function(a){return a.$type.replace(/[^a-z]/g,\"\")+\"(\"+a.elements[0]+\")\"}});GLM.$template._add_overrides(a.substr(1),\r\n\t{$to_string:!(a.substr(1)in GLM.$to_string.$template)&&function(a){return a.$type.replace(/[^a-z]/g,\"\")+\"(\"+a.elements[0]+\")\"},$to_object:function(a){return a},$to_glsl:function(a){return a.$type.replace(/[^a-z]/g,\"\")+\"(\"+a+\")\"}});GLM.$template.extend(GLM[a],{componentLength:1,BYTES_PER_ELEMENT:b.BYTES_PER_ELEMENT,prototype:GLM.$template.extend(new GLM.$GLMBaseType(GLM[a],a),{copy:function(a){this.elements.set(GLM.$isGLMObject(a)?a.elements:[a]);return this},valueOf:function(){return this.elements[0]}})});\r\n\tGLM[a].prototype[\"=\"]=GLM[a].prototype.copy;return GLM[a]};GLM.$make_primitive(\"$bool\",GLM.$outer.Int32Array);GLM.$template._add_overrides(\"$bool\",{$to_object:function(a){return!!a}});GLM.$make_primitive(\"$int32\",GLM.$outer.Int32Array);GLM.$make_primitive(\"$uint32\",GLM.$outer.Uint32Array);GLM.$make_primitive(\"$uint16\",GLM.$outer.Uint16Array);GLM.$make_primitive(\"$uint8\",GLM.$outer.Uint8Array);GLM.$float32=GLM.$make_primitive(\"$float\",GLM.$outer.Float32Array);\r\n\tGLM.$make_primitive_vector=function(a,b,c){c=c||(new b).elements.constructor;var e=function(d){if(!(this instanceof e))return new e(d);this.$type=a;this.$type_name=\"vector<\"+a+\">\";(d=GLM.$toTypedArray(c,d,b.componentLength))&&this._set(d)},e=eval(GLM.$template._traceable(\"glm_\"+a+\"$class\",e))();e.prototype=new GLM.$vectorType(b,0,c);GLM.$template._add_overrides(a,{$to_string:function(a){return\"[GLM.\"+a.$type+\" elements[0]=\"+(a.elements&&a.elements[0])+\"]\"},$to_object:function(a){return a.map(GLM.$to_object)},\r\n\t$to_glsl:function(a,b){var c=a.$type.substr(2).replace(/[^a-z]/g,\"\");b=\"string\"===typeof b?b:\"example\";var e=[];b&&e.push(c+\" \"+b+\"[\"+a.length+\"]\");return e.concat(a.map(function(a,c){return b+\"[\"+c+\"] = \"+a})).join(\";\")+\";\"}});GLM.$types.push(a);GLM.$template.extend(e.prototype,{$type:a,constructor:e,_setup:function(){throw new GLM.GLMJSError(\"._setup not available on primitive vectors yet...\");},_set:function(a){this.elements=a;this.length=!this.elements?0:this.elements.length/this.glmtype.componentLength;\r\n\tthis.arrayize();return this},arrayize:function(){for(var a=Object.defineProperty.bind(Object,this),b=0;b<this.length;b++)(function(b){a(b,{configurable:!0,enumerable:!0,get:function(){return this.elements[b]},set:function(a){return this.elements[b]=a}})})(b);return this._mixinArray(this)},toString:function(){return\"[vector<\"+a+\"> {\"+[].slice.call(this.elements,0,5)+(5<this.elements.length?\",...\":\"\")+\"}]\"}});return e};GLM.$vint32=GLM.$make_primitive_vector(\"$vint32\",GLM.$int32);\r\n\tGLM.$vfloat=GLM.$vfloat32=GLM.$make_primitive_vector(\"$vfloat32\",GLM.$float32);GLM.$vuint8=GLM.$make_primitive_vector(\"$vuint8\",GLM.$uint8);GLM.$vuint16=GLM.$make_primitive_vector(\"$vuint16\",GLM.$uint16);GLM.$vuint32=GLM.$make_primitive_vector(\"$vuint32\",GLM.$uint32);\r\n\tGLM.$make_componentized_vector=function(a,b,c){c=c||(new b).elements.constructor;var e=function(a,h){if(!(this instanceof e))return new e(a,h);this._set(GLM.$toTypedArray(c,a,b.componentLength));if(!this.elements)throw new GLM.GLMJSError(\"!this.elements: \"+[GLM.$toTypedArray(c,a,b.componentLength)]);this._setup({setters:!0,dynamic:h,container:\"self\"})},e=eval(GLM.$template._traceable(\"glm_\"+a+\"$class\",e))();e.prototype=new GLM.$vectorType(b,0,c);GLM.$template._add_overrides(a,{$to_string:function(a){return\"[GLM.\"+\r\n\ta.$type+\" elements[0]=\"+(a.elements&&a.elements[0])+\"]\"},$to_object:function(a){return a.map(GLM.$to_object)},$to_glsl:function(a,b){var c=a.$type.substr(2);b=\"string\"===typeof b?b:\"example\";var e=[];b&&e.push(c+\" \"+b+\"[\"+a.length+\"]\");return e.concat(a.map(GLM.$to_glsl).map(function(a,c){return b+\"[\"+c+\"] = \"+a})).join(\";\\n \")+\";\"}});GLM.$types.push(a);GLM.$template.extend(e.prototype,{$type:a,constructor:e});e.prototype.componentLength||alert(\"!cmop \"+p);return e};\r\n\t(function(){var a=GLM.$template.deNify({\"$vvec<N>\":function(){return GLM.$make_componentized_vector(\"$vvecN\",GLM.vecN)},\"$vuvec<N>\":function(){return GLM.$make_componentized_vector(\"$vuvecN\",GLM.uvecN)},\"$vmat<N>\":function(){return GLM.$make_componentized_vector(\"$vmatN\",GLM.matN)},$vquat:function(){return GLM.$make_componentized_vector(\"$vquat\",GLM.quat)}},\"$v\"),b;for(b in a)GLM[b]=a[b]()})();\r\n\t(GLM._redefine_base64_helpers=function define_base64_helpers(b,c){function e(b){return(b+\"\").replace(/\\s/g,\"\")}function d(b){return new k(b.split(\"\").map(function(b){return b.charCodeAt(0)}))}function h(b){b instanceof k||(b=new k(b));return[].map.call(b,function(b){return String.fromCharCode(b)}).join(\"\")}function j(b){b=b instanceof i?b:d(b).buffer;return GLM.$b64.encode(b,b.byteOffset,b.byteLength)}function g(b){b=new String(h(GLM.$b64.decode(b)));b.array=d(b);b.buffer=b.array.buffer;return b}\r\n\tb=define_base64_helpers.atob=b||define_base64_helpers.atob||g;c=define_base64_helpers.btoa=c||define_base64_helpers.btoa||j;var k=GLM.$outer.Uint8Array,i=GLM.$outer.ArrayBuffer,w,r=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\".indexOf.bind(\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\");w={encode:function(b,c,d){b=new k(b,c,d);d=b.length;var e=\"\";for(c=0;c<d;c+=3)e+=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"[b[c]>>2],e+=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"[(b[c]&\r\n\t3)<<4|b[c+1]>>4],e+=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"[(b[c+1]&15)<<2|b[c+2]>>6],e+=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"[b[c+2]&63];2===d%3?e=e.substring(0,e.length-1)+\"=\":1===d%3&&(e=e.substring(0,e.length-2)+\"==\");return e},decode:function(b){b=e(b);var c=b.length,d=0.75*c,g=0,h,j,f,v;\"=\"===b[c-1]&&(d--,\"=\"===b[c-2]&&d--);for(var w=new i(d),R=new k(w),d=0;d<c;d+=4)h=r(b[d]),j=r(b[d+1]),f=r(b[d+2]),v=r(b[d+3]),R[g++]=h<<2|j>>4,R[g++]=\r\n\t(j&15)<<4|f>>2,R[g++]=(f&3)<<6|v&63;return w}};GLM.$template.extend(w,{trim:e,atob:b,btoa:c,$atob:g,$btoa:j,toCharCodes:d,fromCharCodes:h,b64_to_utf8:function(c){return decodeURIComponent(escape(b(e(c))))},utf8_to_b64:function(b){return c(unescape(encodeURIComponent(b)))}});GLM.$template.extend(GLM,{$b64:w,$to_base64:function(b){return GLM.$b64.encode(b.elements.buffer,b.elements.byteOffset,b.elements.byteLength)},$from_base64:function(b,c){var d=GLM.$b64.decode(b);if(!0===c||c==GLM.$outer.ArrayBuffer)return d;\r\n\tvoid 0===c&&(c=GLM.$outer.Float32Array);return new c(d);throw new GLM.GLMJSError(\"TODO: $from_base64 not yet supported second argument type: (\"+[typeof c,c]+\")\");}})})(\"function\"===typeof atob&&atob.bind(this),\"function\"===typeof btoa&&btoa.bind(this));\r\n\t(function(){function a(a,c){return{get:function(){return a.call(this)},set:function(a){if(this.copy)return this.copy(new this.constructor(c.call(this,a)));this.elements.set(c.call(this,a))}}}\"$bool $float32 $vfloat32 $vuint8 $vuint16 $vuint32 $vvec2 $vvec3 $vvec4 $vmat3 $vmat4 $vquat vec2 vec3 vec4 mat3 mat4 uvec2 uvec3 uvec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 quat\".split(\" \").map(GLM.$getGLMType).forEach(function(b){Object.defineProperty(b.prototype,\"array\",a(function(){return GLM.$to_array(this)},\r\n\tfunction(a){return a}));Object.defineProperty(b.prototype,\"base64\",a(function(){return GLM.$to_base64(this)},function(a){return GLM.$from_base64(a,this.elements.constructor)}));Object.defineProperty(b.prototype,\"buffer\",a(function(){return this.elements.buffer},function(a){return new this.elements.constructor(a)}));Object.defineProperty(b.prototype,\"json\",a(function(){return GLM.$to_json(this)},function(a){return JSON.parse(a)}));Object.defineProperty(b.prototype,\"object\",a(function(){return GLM.$to_object(this)},\r\n\tfunction(a){return a}));Object.defineProperty(b.prototype,\"glsl\",a(function(){return GLM.$to_glsl(this)},function(a){return GLM.$from_glsl(a,Array)}))})})();\r\n\tglm.GLMAT = GLMAT; return glm; })(this, typeof $GLM_log !== \"undefined\" ? $GLM_log : undefined, typeof $GLM_console_log !== \"undefined\" ? $GLM_console_log : undefined);\r\n\r\n\texport { glm }","class ulist_elem<T> {\r\n\tconstructor(private elem: any, private list: ulist_base<any>, private idx: number)\r\n\t{\r\n\t}\r\n\tget(): T {\r\n\t\treturn this.list.data[this.idx].elem;\r\n\t}\r\n\tset(value: T) {\r\n\t\tthis.list.data[this.idx].elem = value;\r\n\t}\r\n\tremove() {\r\n\t\tthis.list.data[this.idx] = this.list.data[this.list.data.length - 1];\r\n\t\tthis.list.data[this.idx].idx = this.idx;\r\n\t\tthis.list.data.pop();\r\n\t}\r\n\ttranslate<U>(): ulist_elem<U> {\r\n\t\treturn new ulist_elem<U>(this.elem, this.list, this.idx);\r\n\t}\r\n\tget index(): number {\r\n\t\treturn this.idx;\r\n\t}\r\n}\r\n\r\nclass ulist_base<T> {\r\n\tpublic data: ulist_elem<T>[] = [];\r\n}\r\n\r\nclass ulist<T> {\r\n\tprivate data = new ulist_base<T>();\r\n\r\n\tpush(elem: T): ulist_elem<T> {\r\n\t\tlet object = new ulist_elem<T>(elem, this.data, this.data.data.length);\r\n\t\tthis.data.data.push(object);\r\n\t\treturn this.data.data[this.data.data.length - 1];\r\n\t}\r\n\tsize(): number { \r\n\t\treturn this.data.data.length;\r\n\t}\r\n\tvisit(callback: (e: ulist_elem<T>) => void) {\r\n\t\tfor (let elem of this.data.data) {\r\n\t\t\tcallback(elem);\r\n\t\t}\r\n\t}\r\n\tsubscribe(index: number): ulist_elem<T> {\r\n\t\treturn this.data.data[index];\r\n\t}\r\n\tclear() {\r\n\t\tthis.data.data = [];\r\n\t}\r\n}\r\n\r\nexport {\r\n\tulist_elem,\r\n\tulist\r\n}\r\n","type xhrType = XMLHttpRequestResponseType;\r\n\r\nexport default class xhr {\r\n\tstatic getAsync(filename: string, type: xhrType, callback: (err: any, data: any) => void);\r\n\tstatic getAsync(filename: string[], type: xhrType, callback: (err: any, data: any[]) => void);\r\n\tstatic getAsync(filename: any, type: xhrType, callback: any) {\r\n\t\tlet xhr = new XMLHttpRequest();\r\n\t\txhr.responseType = type;\r\n\t\tif (typeof filename == \"string\") {\r\n\t\t\txhr.onload = (event: Event) => {\r\n\t\t\t\tcallback(undefined, xhr.response);\r\n\t\t\t}\r\n\t\t\txhr.open(\"get\", filename);\r\n\t\t\txhr.send();\r\n\t\t} else {\r\n\t\t\tif (filename.length) {\r\n\t\t\t\tlet result: string[] = [];\r\n\t\t\t\txhr.onload = (event: Event) => {\r\n\t\t\t\t\tfilename = filename.slice(1);\r\n\t\t\t\t\tresult.push(xhr.response);\r\n\t\t\t\t\tif (filename.length) {\r\n\t\t\t\t\t\txhr.open(\"get\", filename[0]);\r\n\t\t\t\t\t\txhr.send();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcallback(undefined, result);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\txhr.open(\"get\", filename[0]);\r\n\t\t\t\txhr.send();\r\n\t\t\t} else {\r\n\t\t\t\tcallback(undefined, []);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tstatic getSync(filename: string): any {\r\n\t\tlet xhr = new XMLHttpRequest();\r\n\t\txhr.open(\"get\", filename, false);\r\n\t\txhr.send();\r\n\t\tif (xhr.status == 200) {\r\n\t\t\treturn xhr.response;\r\n\t\t} else {\r\n\t\t\tthrow \"failed to load resource: \" + filename + \" due to \" +\r\n\t\t\t\txhr.statusText;\r\n\t\t}\r\n\t}\r\n}\r\n"],"sourceRoot":""}